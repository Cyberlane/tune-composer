(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){(function(root,factory){if(typeof define==="function"&&define.amd){define(function(){return factory()})}else if(typeof module==="object"){module.exports=factory()}else{root.Tone=factory()}})(this,function(){"use strict";var Tone;function Main(func){Tone=func()}function Module(func){func(Tone)}Main(function(){function isUndef(val){return typeof val==="undefined"}function isFunction(val){return typeof val==="function"}var audioContext;if(isUndef(window.AudioContext)){window.AudioContext=window.webkitAudioContext}if(isUndef(window.OfflineAudioContext)){window.OfflineAudioContext=window.webkitOfflineAudioContext}if(!isUndef(AudioContext)){audioContext=new AudioContext}else{throw new Error("Web Audio is not supported in this browser")}if(!isFunction(AudioContext.prototype.createGain)){AudioContext.prototype.createGain=AudioContext.prototype.createGainNode}if(!isFunction(AudioContext.prototype.createDelay)){AudioContext.prototype.createDelay=AudioContext.prototype.createDelayNode}if(!isFunction(AudioContext.prototype.createPeriodicWave)){AudioContext.prototype.createPeriodicWave=AudioContext.prototype.createWaveTable}if(!isFunction(AudioBufferSourceNode.prototype.start)){AudioBufferSourceNode.prototype.start=AudioBufferSourceNode.prototype.noteGrainOn}if(!isFunction(AudioBufferSourceNode.prototype.stop)){AudioBufferSourceNode.prototype.stop=AudioBufferSourceNode.prototype.noteOff}if(!isFunction(OscillatorNode.prototype.start)){OscillatorNode.prototype.start=OscillatorNode.prototype.noteOn}if(!isFunction(OscillatorNode.prototype.stop)){OscillatorNode.prototype.stop=OscillatorNode.prototype.noteOff}if(!isFunction(OscillatorNode.prototype.setPeriodicWave)){OscillatorNode.prototype.setPeriodicWave=OscillatorNode.prototype.setWaveTable}if(isUndef(AudioNode.prototype._nativeConnect)){AudioNode.prototype._nativeConnect=AudioNode.prototype.connect;AudioNode.prototype.connect=function(B,outNum,inNum){if(B.input){if(Array.isArray(B.input)){if(isUndef(inNum)){inNum=0}this.connect(B.input[inNum])}else{this.connect(B.input,outNum,inNum)}}else{try{if(B instanceof AudioNode){this._nativeConnect(B,outNum,inNum)}else{this._nativeConnect(B,outNum)}}catch(e){throw new Error("error connecting to node: "+B)}}}}var Tone=function(inputs,outputs){if(isUndef(inputs)||inputs===1){this.input=this.context.createGain()}else if(inputs>1){this.input=new Array(inputs)}if(isUndef(outputs)||outputs===1){this.output=this.context.createGain()}else if(outputs>1){this.output=new Array(inputs)}};Tone.prototype.set=function(params,value,rampTime){if(this.isObject(params)){rampTime=value}else if(this.isString(params)){var tmpObj={};tmpObj[params]=value;params=tmpObj}paramLoop:for(var attr in params){value=params[attr];var parent=this;if(attr.indexOf(".")!==-1){var attrSplit=attr.split(".");for(var i=0;i<attrSplit.length-1;i++){parent=parent[attrSplit[i]];if(parent instanceof Tone){attrSplit.splice(0,i+1);var innerParam=attrSplit.join(".");parent.set(innerParam,value);continue paramLoop}}attr=attrSplit[attrSplit.length-1]}var param=parent[attr];if(isUndef(param)){continue}if(Tone.Signal&&param instanceof Tone.Signal||Tone.Param&&param instanceof Tone.Param){if(param.value!==value){if(isUndef(rampTime)){param.value=value}else{param.rampTo(value,rampTime)}}}else if(param instanceof AudioParam){if(param.value!==value){param.value=value}}else if(param instanceof Tone){param.set(value)}else if(param!==value){parent[attr]=value}}return this};Tone.prototype.get=function(params){if(isUndef(params)){params=this._collectDefaults(this.constructor)}else if(this.isString(params)){params=[params]}var ret={};for(var i=0;i<params.length;i++){var attr=params[i];var parent=this;var subRet=ret;if(attr.indexOf(".")!==-1){var attrSplit=attr.split(".");for(var j=0;j<attrSplit.length-1;j++){var subAttr=attrSplit[j];subRet[subAttr]=subRet[subAttr]||{};subRet=subRet[subAttr];parent=parent[subAttr]}attr=attrSplit[attrSplit.length-1]}var param=parent[attr];if(this.isObject(params[attr])){subRet[attr]=param.get()}else if(Tone.Signal&&param instanceof Tone.Signal){subRet[attr]=param.value}else if(Tone.Param&&param instanceof Tone.Param){subRet[attr]=param.value}else if(param instanceof AudioParam){subRet[attr]=param.value}else if(param instanceof Tone){subRet[attr]=param.get()}else if(!isFunction(param)&&!isUndef(param)){subRet[attr]=param}}return ret};Tone.prototype._collectDefaults=function(constr){var ret=[];if(!isUndef(constr.defaults)){ret=Object.keys(constr.defaults)}if(!isUndef(constr._super)){var superDefs=this._collectDefaults(constr._super);for(var i=0;i<superDefs.length;i++){if(ret.indexOf(superDefs[i])===-1){ret.push(superDefs[i])}}}return ret};Tone.prototype.toString=function(){for(var className in Tone){var isLetter=className[0].match(/^[A-Z]$/);var sameConstructor=Tone[className]===this.constructor;if(isFunction(Tone[className])&&isLetter&&sameConstructor){return className}}return"Tone"};Tone.context=audioContext;Tone.prototype.context=Tone.context;Tone.prototype.bufferSize=2048;Tone.prototype.blockTime=128/Tone.context.sampleRate;Tone.prototype.sampleTime=1/Tone.context.sampleRate;Object.defineProperty(Tone.prototype,"numberOfInputs",{get:function(){if(this.input){if(this.isArray(this.input)){return this.input.length}else{return 1}}else{return 0}}});Object.defineProperty(Tone.prototype,"numberOfOutputs",{get:function(){if(this.output){if(this.isArray(this.output)){return this.output.length}else{return 1}}else{return 0}}});Tone.prototype.dispose=function(){if(!this.isUndef(this.input)){if(this.input instanceof AudioNode){this.input.disconnect()}this.input=null}if(!this.isUndef(this.output)){if(this.output instanceof AudioNode){this.output.disconnect()}this.output=null}return this};var _silentNode=null;Tone.prototype.noGC=function(){this.output.connect(_silentNode);return this};AudioNode.prototype.noGC=function(){this.connect(_silentNode);return this};Tone.prototype.connect=function(unit,outputNum,inputNum){if(Array.isArray(this.output)){outputNum=this.defaultArg(outputNum,0);this.output[outputNum].connect(unit,0,inputNum)}else{this.output.connect(unit,outputNum,inputNum)}return this};Tone.prototype.disconnect=function(output){if(Array.isArray(this.output)){output=this.defaultArg(output,0);this.output[output].disconnect()}else if(!this.isUndef(output)){this.output.disconnect(output)}else{this.output.disconnect()}return this};Tone.prototype.connectSeries=function(){if(arguments.length>1){var currentUnit=arguments[0];for(var i=1;i<arguments.length;i++){var toUnit=arguments[i];currentUnit.connect(toUnit);currentUnit=toUnit}}return this};Tone.prototype.chain=function(){if(arguments.length>0){var currentUnit=this;for(var i=0;i<arguments.length;i++){var toUnit=arguments[i];currentUnit.connect(toUnit);currentUnit=toUnit}}return this};Tone.prototype.fan=function(){if(arguments.length>0){for(var i=0;i<arguments.length;i++){this.connect(arguments[i])}}return this};AudioNode.prototype.chain=Tone.prototype.chain;AudioNode.prototype.fan=Tone.prototype.fan;Tone.prototype.defaultArg=function(given,fallback){if(this.isObject(given)&&this.isObject(fallback)){var ret={};for(var givenProp in given){ret[givenProp]=this.defaultArg(fallback[givenProp],given[givenProp])}for(var fallbackProp in fallback){ret[fallbackProp]=this.defaultArg(given[fallbackProp],fallback[fallbackProp])}return ret}else{return isUndef(given)?fallback:given}};Tone.prototype.optionsObject=function(values,keys,defaults){var options={};if(values.length===1&&this.isObject(values[0])){options=values[0]}else{for(var i=0;i<keys.length;i++){options[keys[i]]=values[i]}}if(!this.isUndef(defaults)){return this.defaultArg(options,defaults)}else{return options}};Tone.prototype.isUndef=isUndef;Tone.prototype.isFunction=isFunction;Tone.prototype.isNumber=function(arg){return typeof arg==="number"};Tone.prototype.isObject=function(arg){return Object.prototype.toString.call(arg)==="[object Object]"&&arg.constructor===Object};Tone.prototype.isBoolean=function(arg){return typeof arg==="boolean"};Tone.prototype.isArray=function(arg){return Array.isArray(arg)};Tone.prototype.isString=function(arg){return typeof arg==="string"};Tone.noOp=function(){};Tone.prototype._readOnly=function(property){if(Array.isArray(property)){for(var i=0;i<property.length;i++){this._readOnly(property[i])}}else{Object.defineProperty(this,property,{writable:false,enumerable:true})}};Tone.prototype._writable=function(property){if(Array.isArray(property)){for(var i=0;i<property.length;i++){this._writable(property[i])}}else{Object.defineProperty(this,property,{writable:true})}};Tone.State={Started:"started",Stopped:"stopped",Paused:"paused"};Tone.prototype.equalPowerScale=function(percent){var piFactor=.5*Math.PI;return Math.sin(percent*piFactor)};Tone.prototype.dbToGain=function(db){return Math.pow(2,db/6)};Tone.prototype.gainToDb=function(gain){return 20*(Math.log(gain)/Math.LN10)};Tone.prototype.intervalToFrequencyRatio=function(interval){return Math.pow(2,interval/12)};Tone.prototype.now=function(){return this.context.currentTime};Tone.now=function(){return Tone.context.currentTime};Tone.extend=function(child,parent){if(isUndef(parent)){parent=Tone}function TempConstructor(){}TempConstructor.prototype=parent.prototype;child.prototype=new TempConstructor;child.prototype.constructor=child;child._super=parent};var newContextCallbacks=[];Tone._initAudioContext=function(callback){callback(Tone.context);newContextCallbacks.push(callback)};Tone.setContext=function(ctx){Tone.prototype.context=ctx;Tone.context=ctx;for(var i=0;i<newContextCallbacks.length;i++){newContextCallbacks[i](ctx)}};Tone._initAudioContext(function(audioContext){Tone.prototype.blockTime=128/audioContext.sampleRate;Tone.prototype.sampleTime=1/audioContext.sampleRate;_silentNode=audioContext.createGain();_silentNode.gain.value=0;_silentNode.connect(audioContext.destination)});Tone.version="r9";if(!window.TONE_SILENCE_VERSION_LOGGING){console.log("%c * Tone.js "+Tone.version+" * ","background: #000; color: #fff")}return Tone});Module(function(Tone){Tone.SignalBase=function(){};Tone.extend(Tone.SignalBase);Tone.SignalBase.prototype.connect=function(node,outputNumber,inputNumber){if(Tone.Signal&&Tone.Signal===node.constructor||Tone.Param&&Tone.Param===node.constructor||Tone.TimelineSignal&&Tone.TimelineSignal===node.constructor){node._param.cancelScheduledValues(0);node._param.value=0;node.overridden=true}else if(node instanceof AudioParam){node.cancelScheduledValues(0);node.value=0}Tone.prototype.connect.call(this,node,outputNumber,inputNumber);return this};return Tone.SignalBase});Module(function(Tone){Tone.WaveShaper=function(mapping,bufferLen){this._shaper=this.input=this.output=this.context.createWaveShaper();this._curve=null;if(Array.isArray(mapping)){this.curve=mapping}else if(isFinite(mapping)||this.isUndef(mapping)){this._curve=new Float32Array(this.defaultArg(mapping,1024))}else if(this.isFunction(mapping)){this._curve=new Float32Array(this.defaultArg(bufferLen,1024));this.setMap(mapping)}};Tone.extend(Tone.WaveShaper,Tone.SignalBase);Tone.WaveShaper.prototype.setMap=function(mapping){for(var i=0,len=this._curve.length;i<len;i++){var normalized=i/(len-1)*2-1;this._curve[i]=mapping(normalized,i)}this._shaper.curve=this._curve;return this};Object.defineProperty(Tone.WaveShaper.prototype,"curve",{get:function(){return this._shaper.curve},set:function(mapping){this._curve=new Float32Array(mapping);this._shaper.curve=this._curve}});Object.defineProperty(Tone.WaveShaper.prototype,"oversample",{get:function(){return this._shaper.oversample},set:function(oversampling){if(["none","2x","4x"].indexOf(oversampling)!==-1){this._shaper.oversample=oversampling}else{throw new RangeError("Tone.WaveShaper: oversampling must be either 'none', '2x', or '4x'")}}});Tone.WaveShaper.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._shaper.disconnect();this._shaper=null;this._curve=null;return this};return Tone.WaveShaper});Module(function(Tone){Tone.TimeBase=function(val,units){if(this instanceof Tone.TimeBase){this._expr=this._noOp;if(val instanceof Tone.TimeBase){this.copy(val)}else if(!this.isUndef(units)||this.isNumber(val)){units=this.defaultArg(units,this._defaultUnits);var method=this._primaryExpressions[units].method;this._expr=method.bind(this,val)}else if(this.isString(val)){this.set(val)}else if(this.isUndef(val)){this._expr=this._defaultExpr()}}else{return new Tone.TimeBase(val,units)}};Tone.extend(Tone.TimeBase);Tone.TimeBase.prototype.set=function(exprString){this._expr=this._parseExprString(exprString);return this};Tone.TimeBase.prototype.clone=function(){var instance=new this.constructor;instance.copy(this);return instance};Tone.TimeBase.prototype.copy=function(time){var val=time._expr();return this.set(val)};Tone.TimeBase.prototype._primaryExpressions={n:{regexp:/^(\d+)n/i,method:function(value){value=parseInt(value);if(value===1){return this._beatsToUnits(this._timeSignature())}else{return this._beatsToUnits(4/value)}}},t:{regexp:/^(\d+)t/i,method:function(value){value=parseInt(value);return this._beatsToUnits(8/(parseInt(value)*3))}},m:{regexp:/^(\d+)m/i,method:function(value){return this._beatsToUnits(parseInt(value)*this._timeSignature())}},i:{regexp:/^(\d+)i/i,method:function(value){return this._ticksToUnits(parseInt(value))}},hz:{regexp:/^(\d+(?:\.\d+)?)hz/i,method:function(value){return this._frequencyToUnits(parseFloat(value))}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method:function(m,q,s){var total=0;if(m&&m!=="0"){total+=this._beatsToUnits(this._timeSignature()*parseFloat(m))}if(q&&q!=="0"){total+=this._beatsToUnits(parseFloat(q))}if(s&&s!=="0"){total+=this._beatsToUnits(parseFloat(s)/4)}return total}},s:{regexp:/^(\d+(?:\.\d+)?s)/,method:function(value){return this._secondsToUnits(parseFloat(value))}},samples:{regexp:/^(\d+)samples/,method:function(value){return parseInt(value)/this.context.sampleRate}},default:{regexp:/^(\d+(?:\.\d+)?)/,method:function(value){return this._primaryExpressions[this._defaultUnits].method.call(this,value)}}};Tone.TimeBase.prototype._binaryExpressions={"+":{regexp:/^\+/,precedence:2,method:function(lh,rh){return lh()+rh()}},"-":{regexp:/^\-/,precedence:2,method:function(lh,rh){return lh()-rh()}},"*":{regexp:/^\*/,precedence:1,method:function(lh,rh){return lh()*rh()}},"/":{regexp:/^\//,precedence:1,method:function(lh,rh){return lh()/rh()}}};Tone.TimeBase.prototype._unaryExpressions={neg:{regexp:/^\-/,method:function(lh){return-lh()}}};Tone.TimeBase.prototype._syntaxGlue={"(":{regexp:/^\(/},")":{regexp:/^\)/}};Tone.TimeBase.prototype._tokenize=function(expr){var position=-1;var tokens=[];while(expr.length>0){expr=expr.trim();var token=getNextToken(expr,this);tokens.push(token);expr=expr.substr(token.value.length)}function getNextToken(expr,context){var expressions=["_binaryExpressions","_unaryExpressions","_primaryExpressions","_syntaxGlue"];for(var i=0;i<expressions.length;i++){var group=context[expressions[i]];for(var opName in group){var op=group[opName];var reg=op.regexp;var match=expr.match(reg);if(match!==null){return{method:op.method,precedence:op.precedence,regexp:op.regexp,value:match[0]}}}}throw new SyntaxError("Tone.TimeBase: Unexpected token "+expr)}return{next:function(){return tokens[++position]},peek:function(){return tokens[position+1]}}};Tone.TimeBase.prototype._matchGroup=function(token,group,prec){var ret=false;if(!this.isUndef(token)){for(var opName in group){var op=group[opName];if(op.regexp.test(token.value)){if(!this.isUndef(prec)){if(op.precedence===prec){return op}}else{return op}}}}return ret};Tone.TimeBase.prototype._parseBinary=function(lexer,precedence){if(this.isUndef(precedence)){precedence=2}var expr;if(precedence<0){expr=this._parseUnary(lexer)}else{expr=this._parseBinary(lexer,precedence-1)}var token=lexer.peek();while(token&&this._matchGroup(token,this._binaryExpressions,precedence)){token=lexer.next();expr=token.method.bind(this,expr,this._parseBinary(lexer,precedence-1));token=lexer.peek()}return expr};Tone.TimeBase.prototype._parseUnary=function(lexer){var token,expr;token=lexer.peek();var op=this._matchGroup(token,this._unaryExpressions);if(op){token=lexer.next();expr=this._parseUnary(lexer);return op.method.bind(this,expr)}return this._parsePrimary(lexer)};Tone.TimeBase.prototype._parsePrimary=function(lexer){var token,expr;token=lexer.peek();if(this.isUndef(token)){throw new SyntaxError("Tone.TimeBase: Unexpected end of expression")}if(this._matchGroup(token,this._primaryExpressions)){token=lexer.next();var matching=token.value.match(token.regexp);return token.method.bind(this,matching[1],matching[2],matching[3])}if(token&&token.value==="("){lexer.next();expr=this._parseBinary(lexer);token=lexer.next();if(!(token&&token.value===")")){throw new SyntaxError("Expected )")}return expr}throw new SyntaxError("Tone.TimeBase: Cannot process token "+token.value)};Tone.TimeBase.prototype._parseExprString=function(exprString){if(!this.isString(exprString)){exprString=exprString.toString()}var lexer=this._tokenize(exprString);var tree=this._parseBinary(lexer);return tree};Tone.TimeBase.prototype._noOp=function(){return 0};Tone.TimeBase.prototype._defaultExpr=function(){return this._noOp};Tone.TimeBase.prototype._defaultUnits="s";Tone.TimeBase.prototype._frequencyToUnits=function(freq){return 1/freq};Tone.TimeBase.prototype._beatsToUnits=function(beats){return 60/Tone.Transport.bpm.value*beats};Tone.TimeBase.prototype._secondsToUnits=function(seconds){return seconds};Tone.TimeBase.prototype._ticksToUnits=function(ticks){return ticks*(this._beatsToUnits(1)/Tone.Transport.PPQ)};Tone.TimeBase.prototype._timeSignature=function(){return Tone.Transport.timeSignature};Tone.TimeBase.prototype._pushExpr=function(val,name,units){if(!(val instanceof Tone.TimeBase)){val=new this.constructor(val,units)}this._expr=this._binaryExpressions[name].method.bind(this,this._expr,val._expr);return this};Tone.TimeBase.prototype.add=function(val,units){return this._pushExpr(val,"+",units)};Tone.TimeBase.prototype.sub=function(val,units){return this._pushExpr(val,"-",units)};Tone.TimeBase.prototype.mult=function(val,units){return this._pushExpr(val,"*",units)};Tone.TimeBase.prototype.div=function(val,units){return this._pushExpr(val,"/",units)};Tone.TimeBase.prototype.eval=function(){return this._expr()};Tone.TimeBase.prototype.dispose=function(){this._expr=null};return Tone.TimeBase});Module(function(Tone){Tone.Time=function(val,units){if(this instanceof Tone.Time){this._plusNow=false;Tone.TimeBase.call(this,val,units)}else{return new Tone.Time(val,units)}};Tone.extend(Tone.Time,Tone.TimeBase);Tone.Time.prototype._unaryExpressions=Object.create(Tone.TimeBase.prototype._unaryExpressions);Tone.Time.prototype._unaryExpressions.quantize={regexp:/^@/,method:function(rh){return Tone.Transport.nextSubdivision(rh())}};Tone.Time.prototype._unaryExpressions.now={regexp:/^\+/,method:function(lh){this._plusNow=true;return lh()}};Tone.Time.prototype.quantize=function(subdiv,percent){percent=this.defaultArg(percent,1);this._expr=function(expr,subdivision,percent){expr=expr();subdivision=subdivision.toSeconds();var multiple=Math.round(expr/subdivision);var ideal=multiple*subdivision;var diff=ideal-expr;return expr+diff*percent}.bind(this,this._expr,new this.constructor(subdiv),percent);return this};Tone.Time.prototype.addNow=function(){this._plusNow=true;return this};Tone.Time.prototype._defaultExpr=function(){this._plusNow=true;return this._noOp};Tone.Time.prototype.copy=function(time){Tone.TimeBase.prototype.copy.call(this,time);this._plusNow=time._plusNow;return this};Tone.Time.prototype.toNotation=function(){var time=this.toSeconds();var testNotations=["1m","2n","4n","8n","16n","32n","64n","128n"];var retNotation=this._toNotationHelper(time,testNotations);var testTripletNotations=["1m","2n","2t","4n","4t","8n","8t","16n","16t","32n","32t","64n","64t","128n"];var retTripletNotation=this._toNotationHelper(time,testTripletNotations);if(retTripletNotation.split("+").length<retNotation.split("+").length){return retTripletNotation}else{return retNotation}};Tone.Time.prototype._toNotationHelper=function(units,testNotations){var threshold=this._notationToUnits(testNotations[testNotations.length-1]);var retNotation="";for(var i=0;i<testNotations.length;i++){var notationTime=this._notationToUnits(testNotations[i]);var multiple=units/notationTime;var floatingPointError=1e-6;if(1-multiple%1<floatingPointError){multiple+=floatingPointError}multiple=Math.floor(multiple);if(multiple>0){if(multiple===1){retNotation+=testNotations[i]}else{retNotation+=multiple.toString()+"*"+testNotations[i]}units-=multiple*notationTime;if(units<threshold){break}else{retNotation+=" + "}}}if(retNotation===""){retNotation="0"}return retNotation};Tone.Time.prototype._notationToUnits=function(notation){var primaryExprs=this._primaryExpressions;var notationExprs=[primaryExprs.n,primaryExprs.t,primaryExprs.m];for(var i=0;i<notationExprs.length;i++){var expr=notationExprs[i];var match=notation.match(expr.regexp);if(match){return expr.method.call(this,match[1])}}};Tone.Time.prototype.toBarsBeatsSixteenths=function(){var quarterTime=this._beatsToUnits(1);var quarters=this.toSeconds()/quarterTime;var measures=Math.floor(quarters/this._timeSignature());var sixteenths=quarters%1*4;quarters=Math.floor(quarters)%this._timeSignature();sixteenths=sixteenths.toString();if(sixteenths.length>3){sixteenths=parseFloat(sixteenths).toFixed(3)}var progress=[measures,quarters,sixteenths];return progress.join(":")};Tone.Time.prototype.toTicks=function(){var quarterTime=this._beatsToUnits(1);var quarters=this.eval()/quarterTime;return Math.floor(quarters*Tone.Transport.PPQ)};Tone.Time.prototype.toSamples=function(){return this.toSeconds()*this.context.sampleRate};Tone.Time.prototype.toFrequency=function(){return 1/this.toSeconds()};Tone.Time.prototype.toSeconds=function(){return this.eval()};Tone.Time.prototype.toMilliseconds=function(){return this.toSeconds()*1e3};Tone.Time.prototype.eval=function(){var val=this._expr();return val+(this._plusNow?this.now():0)};return Tone.Time});Module(function(Tone){Tone.Frequency=function(val,units){if(this instanceof Tone.Frequency){Tone.TimeBase.call(this,val,units)}else{return new Tone.Frequency(val,units)}};Tone.extend(Tone.Frequency,Tone.TimeBase);Tone.Frequency.prototype._primaryExpressions=Object.create(Tone.TimeBase.prototype._primaryExpressions);Tone.Frequency.prototype._primaryExpressions.midi={regexp:/^(\d+(?:\.\d+)?midi)/,method:function(value){return this.midiToFrequency(value)}};Tone.Frequency.prototype._primaryExpressions.note={regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method:function(pitch,octave){var index=noteToScaleIndex[pitch.toLowerCase()];var noteNumber=index+(parseInt(octave)+1)*12;return this.midiToFrequency(noteNumber)}};Tone.Frequency.prototype._primaryExpressions.tr={regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method:function(m,q,s){var total=1;if(m&&m!=="0"){total*=this._beatsToUnits(this._timeSignature()*parseFloat(m))}if(q&&q!=="0"){total*=this._beatsToUnits(parseFloat(q))}if(s&&s!=="0"){total*=this._beatsToUnits(parseFloat(s)/4)}return total}};Tone.Frequency.prototype.transpose=function(interval){this._expr=function(expr,interval){var val=expr();return val*this.intervalToFrequencyRatio(interval)}.bind(this,this._expr,interval);return this};Tone.Frequency.prototype.harmonize=function(intervals){this._expr=function(expr,intervals){var val=expr();var ret=[];for(var i=0;i<intervals.length;i++){ret[i]=val*this.intervalToFrequencyRatio(intervals[i])}return ret}.bind(this,this._expr,intervals);return this};Tone.Frequency.prototype.toMidi=function(){return this.frequencyToMidi(this.eval())};Tone.Frequency.prototype.toNote=function(){var freq=this.eval();var log=Math.log(freq/Tone.Frequency.A4)/Math.LN2;var noteNumber=Math.round(12*log)+57;var octave=Math.floor(noteNumber/12);if(octave<0){noteNumber+=-12*octave}var noteName=scaleIndexToNote[noteNumber%12];return noteName+octave.toString()};Tone.Frequency.prototype.toSeconds=function(){return 1/this.eval()};Tone.Frequency.prototype.toFrequency=function(){return this.eval()};Tone.Frequency.prototype.toTicks=function(){var quarterTime=this._beatsToUnits(1);var quarters=this.eval()/quarterTime;return Math.floor(quarters*Tone.Transport.PPQ)};Tone.Frequency.prototype._frequencyToUnits=function(freq){return freq};Tone.Frequency.prototype._ticksToUnits=function(ticks){return 1/(ticks*60/(Tone.Transport.bpm.value*Tone.Transport.PPQ))};Tone.Frequency.prototype._beatsToUnits=function(beats){return 1/Tone.TimeBase.prototype._beatsToUnits.call(this,beats)};Tone.Frequency.prototype._secondsToUnits=function(seconds){return 1/seconds};Tone.Frequency.prototype._defaultUnits="hz";var noteToScaleIndex={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13};var scaleIndexToNote=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];Tone.Frequency.A4=440;Tone.Frequency.prototype.midiToFrequency=function(midi){return Tone.Frequency.A4*Math.pow(2,(midi-69)/12)};Tone.Frequency.prototype.frequencyToMidi=function(frequency){return 69+12*Math.log(frequency/Tone.Frequency.A4)/Math.LN2};return Tone.Frequency});Module(function(Tone){Tone.TransportTime=function(val,units){if(this instanceof Tone.TransportTime){Tone.Time.call(this,val,units)}else{return new Tone.TransportTime(val,units)}};Tone.extend(Tone.TransportTime,Tone.Time);Tone.TransportTime.prototype._unaryExpressions=Object.create(Tone.Time.prototype._unaryExpressions);Tone.TransportTime.prototype._unaryExpressions.quantize={regexp:/^@/,method:function(rh){var subdivision=this._secondsToTicks(rh());var multiple=Math.ceil(Tone.Transport.ticks/subdivision);return this._ticksToUnits(multiple*subdivision)}};Tone.TransportTime.prototype._secondsToTicks=function(seconds){var quarterTime=this._beatsToUnits(1);var quarters=seconds/quarterTime;return Math.round(quarters*Tone.Transport.PPQ)};Tone.TransportTime.prototype.eval=function(){var val=this._secondsToTicks(this._expr());return val+(this._plusNow?Tone.Transport.ticks:0)};Tone.TransportTime.prototype.toTicks=function(){return this.eval()};Tone.TransportTime.prototype.toSeconds=function(){var val=this._expr();return val+(this._plusNow?Tone.Transport.seconds:0)};Tone.TransportTime.prototype.toFrequency=function(){return 1/this.toSeconds()};return Tone.TransportTime});Module(function(Tone){Tone.Type={Default:"number",Time:"time",Frequency:"frequency",TransportTime:"transportTime",Ticks:"ticks",NormalRange:"normalRange",AudioRange:"audioRange",Decibels:"db",Interval:"interval",BPM:"bpm",Positive:"positive",Cents:"cents",Degrees:"degrees",MIDI:"midi",BarsBeatsSixteenths:"barsBeatsSixteenths",Samples:"samples",Hertz:"hertz",Note:"note",Milliseconds:"milliseconds",Seconds:"seconds",Notation:"notation"};Tone.prototype.toSeconds=function(time){if(this.isNumber(time)){return time}else if(this.isUndef(time)){return this.now()}else if(this.isString(time)){return new Tone.Time(time).toSeconds()}else if(time instanceof Tone.TimeBase){return time.toSeconds()}};Tone.prototype.toFrequency=function(freq){if(this.isNumber(freq)){return freq}else if(this.isString(freq)||this.isUndef(freq)){return new Tone.Frequency(freq).eval()}else if(freq instanceof Tone.TimeBase){return freq.toFrequency()}};Tone.prototype.toTicks=function(time){if(this.isNumber(time)||this.isString(time)){return new Tone.TransportTime(time).toTicks()}else if(this.isUndef(time)){return Tone.Transport.ticks}else if(time instanceof Tone.TimeBase){return time.toTicks()}};return Tone});Module(function(Tone){Tone.Param=function(){var options=this.optionsObject(arguments,["param","units","convert"],Tone.Param.defaults);this._param=this.input=options.param;this.units=options.units;this.convert=options.convert;this.overridden=false;this._lfo=null;if(this.isObject(options.lfo)){this.value=options.lfo}else if(!this.isUndef(options.value)){this.value=options.value}};Tone.extend(Tone.Param);Tone.Param.defaults={units:Tone.Type.Default,convert:true,param:undefined};Object.defineProperty(Tone.Param.prototype,"value",{get:function(){return this._toUnits(this._param.value)},set:function(value){if(this.isObject(value)){if(this.isUndef(Tone.LFO)){throw new Error("Include 'Tone.LFO' to use an LFO as a Param value.")}if(this._lfo){this._lfo.dispose()}this._lfo=new Tone.LFO(value).start();this._lfo.connect(this.input)}else{var convertedVal=this._fromUnits(value);this._param.cancelScheduledValues(0);this._param.value=convertedVal}}});Tone.Param.prototype._fromUnits=function(val){if(this.convert||this.isUndef(this.convert)){switch(this.units){case Tone.Type.Time:return this.toSeconds(val);case Tone.Type.Frequency:return this.toFrequency(val);case Tone.Type.Decibels:return this.dbToGain(val);case Tone.Type.NormalRange:return Math.min(Math.max(val,0),1);case Tone.Type.AudioRange:return Math.min(Math.max(val,-1),1);case Tone.Type.Positive:return Math.max(val,0);default:return val}}else{return val}};Tone.Param.prototype._toUnits=function(val){if(this.convert||this.isUndef(this.convert)){switch(this.units){case Tone.Type.Decibels:return this.gainToDb(val);default:return val}}else{return val}};Tone.Param.prototype._minOutput=1e-5;Tone.Param.prototype.setValueAtTime=function(value,time){value=this._fromUnits(value);time=this.toSeconds(time);if(time<=this.now()+this.blockTime){this._param.value=value}else{this._param.setValueAtTime(value,time)}return this};Tone.Param.prototype.setRampPoint=function(now){now=this.defaultArg(now,this.now());var currentVal=this._param.value;if(currentVal===0){currentVal=this._minOutput}this._param.setValueAtTime(currentVal,now);return this};Tone.Param.prototype.linearRampToValueAtTime=function(value,endTime){value=this._fromUnits(value);this._param.linearRampToValueAtTime(value,this.toSeconds(endTime));return this};Tone.Param.prototype.exponentialRampToValueAtTime=function(value,endTime){value=this._fromUnits(value);value=Math.max(this._minOutput,value);this._param.exponentialRampToValueAtTime(value,this.toSeconds(endTime));return this};Tone.Param.prototype.exponentialRampToValue=function(value,rampTime,startTime){startTime=this.toSeconds(startTime);this.setRampPoint(startTime);this.exponentialRampToValueAtTime(value,startTime+this.toSeconds(rampTime));return this};Tone.Param.prototype.linearRampToValue=function(value,rampTime,startTime){startTime=this.toSeconds(startTime);this.setRampPoint(startTime);this.linearRampToValueAtTime(value,startTime+this.toSeconds(rampTime));return this};Tone.Param.prototype.setTargetAtTime=function(value,startTime,timeConstant){value=this._fromUnits(value);value=Math.max(this._minOutput,value);timeConstant=Math.max(this._minOutput,timeConstant);this._param.setTargetAtTime(value,this.toSeconds(startTime),timeConstant);return this};Tone.Param.prototype.setValueCurveAtTime=function(values,startTime,duration){for(var i=0;i<values.length;i++){values[i]=this._fromUnits(values[i])}this._param.setValueCurveAtTime(values,this.toSeconds(startTime),this.toSeconds(duration));return this};Tone.Param.prototype.cancelScheduledValues=function(startTime){this._param.cancelScheduledValues(this.toSeconds(startTime));return this};Tone.Param.prototype.rampTo=function(value,rampTime,startTime){rampTime=this.defaultArg(rampTime,0);if(this.units===Tone.Type.Frequency||this.units===Tone.Type.BPM){
this.exponentialRampToValue(value,rampTime,startTime)}else{this.linearRampToValue(value,rampTime,startTime)}return this};Object.defineProperty(Tone.Param.prototype,"lfo",{get:function(){return this._lfo}});Tone.Param.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._param=null;if(this._lfo){this._lfo.dispose();this._lfo=null}return this};return Tone.Param});Module(function(Tone){Tone.Gain=function(){var options=this.optionsObject(arguments,["gain","units"],Tone.Gain.defaults);this.input=this.output=this._gainNode=this.context.createGain();this.gain=new Tone.Param({param:this._gainNode.gain,units:options.units,value:options.gain,convert:options.convert});this._readOnly("gain")};Tone.extend(Tone.Gain);Tone.Gain.defaults={gain:1,convert:true};Tone.Gain.prototype.dispose=function(){Tone.Param.prototype.dispose.call(this);this._gainNode.disconnect();this._gainNode=null;this._writable("gain");this.gain.dispose();this.gain=null};Tone.prototype.createInsOuts=function(inputs,outputs){if(inputs===1){this.input=new Tone.Gain}else if(inputs>1){this.input=new Array(inputs)}if(outputs===1){this.output=new Tone.Gain}else if(outputs>1){this.output=new Array(inputs)}};return Tone.Gain});Module(function(Tone){Tone.Signal=function(){var options=this.optionsObject(arguments,["value","units"],Tone.Signal.defaults);this.output=this._gain=this.context.createGain();options.param=this._gain.gain;Tone.Param.call(this,options);this.input=this._param=this._gain.gain;Tone.Signal._constant.chain(this._gain)};Tone.extend(Tone.Signal,Tone.Param);Tone.Signal.defaults={value:0,units:Tone.Type.Default,convert:true};Tone.Signal.prototype.connect=Tone.SignalBase.prototype.connect;Tone.Signal.prototype.dispose=function(){Tone.Param.prototype.dispose.call(this);this._param=null;this._gain.disconnect();this._gain=null;return this};Tone.Signal._constant=null;Tone._initAudioContext(function(audioContext){var buffer=audioContext.createBuffer(1,128,audioContext.sampleRate);var arr=buffer.getChannelData(0);for(var i=0;i<arr.length;i++){arr[i]=1}Tone.Signal._constant=audioContext.createBufferSource();Tone.Signal._constant.channelCount=1;Tone.Signal._constant.channelCountMode="explicit";Tone.Signal._constant.buffer=buffer;Tone.Signal._constant.loop=true;Tone.Signal._constant.start(0);Tone.Signal._constant.noGC()});return Tone.Signal});Module(function(Tone){Tone.Timeline=function(){var options=this.optionsObject(arguments,["memory"],Tone.Timeline.defaults);this._timeline=[];this._toRemove=[];this._iterating=false;this.memory=options.memory};Tone.extend(Tone.Timeline);Tone.Timeline.defaults={memory:Infinity};Object.defineProperty(Tone.Timeline.prototype,"length",{get:function(){return this._timeline.length}});Tone.Timeline.prototype.add=function(event){if(this.isUndef(event.time)){throw new Error("Tone.Timeline: events must have a time attribute")}if(this._timeline.length){var index=this._search(event.time);this._timeline.splice(index+1,0,event)}else{this._timeline.push(event)}if(this.length>this.memory){var diff=this.length-this.memory;this._timeline.splice(0,diff)}return this};Tone.Timeline.prototype.remove=function(event){if(this._iterating){this._toRemove.push(event)}else{var index=this._timeline.indexOf(event);if(index!==-1){this._timeline.splice(index,1)}}return this};Tone.Timeline.prototype.get=function(time){var index=this._search(time);if(index!==-1){return this._timeline[index]}else{return null}};Tone.Timeline.prototype.peek=function(){return this._timeline[0]};Tone.Timeline.prototype.shift=function(){return this._timeline.shift()};Tone.Timeline.prototype.getAfter=function(time){var index=this._search(time);if(index+1<this._timeline.length){return this._timeline[index+1]}else{return null}};Tone.Timeline.prototype.getBefore=function(time){var len=this._timeline.length;if(len>0&&this._timeline[len-1].time<time){return this._timeline[len-1]}var index=this._search(time);if(index-1>=0){return this._timeline[index-1]}else{return null}};Tone.Timeline.prototype.cancel=function(after){if(this._timeline.length>1){var index=this._search(after);if(index>=0){if(this._timeline[index].time===after){for(var i=index;i>=0;i--){if(this._timeline[i].time===after){index=i}else{break}}this._timeline=this._timeline.slice(0,index)}else{this._timeline=this._timeline.slice(0,index+1)}}else{this._timeline=[]}}else if(this._timeline.length===1){if(this._timeline[0].time>=after){this._timeline=[]}}return this};Tone.Timeline.prototype.cancelBefore=function(time){if(this._timeline.length){var index=this._search(time);if(index>=0){this._timeline=this._timeline.slice(index+1)}}return this};Tone.Timeline.prototype._search=function(time){var beginning=0;var len=this._timeline.length;var end=len;if(len>0&&this._timeline[len-1].time<=time){return len-1}while(beginning<end){var midPoint=Math.floor(beginning+(end-beginning)/2);var event=this._timeline[midPoint];var nextEvent=this._timeline[midPoint+1];if(event.time===time){for(var i=midPoint;i<this._timeline.length;i++){var testEvent=this._timeline[i];if(testEvent.time===time){midPoint=i}}return midPoint}else if(event.time<time&&nextEvent.time>time){return midPoint}else if(event.time>time){end=midPoint}else if(event.time<time){beginning=midPoint+1}}return-1};Tone.Timeline.prototype._iterate=function(callback,lowerBound,upperBound){this._iterating=true;lowerBound=this.defaultArg(lowerBound,0);upperBound=this.defaultArg(upperBound,this._timeline.length-1);for(var i=lowerBound;i<=upperBound;i++){callback(this._timeline[i])}this._iterating=false;if(this._toRemove.length>0){for(var j=0;j<this._toRemove.length;j++){var index=this._timeline.indexOf(this._toRemove[j]);if(index!==-1){this._timeline.splice(index,1)}}this._toRemove=[]}};Tone.Timeline.prototype.forEach=function(callback){this._iterate(callback);return this};Tone.Timeline.prototype.forEachBefore=function(time,callback){var upperBound=this._search(time);if(upperBound!==-1){this._iterate(callback,0,upperBound)}return this};Tone.Timeline.prototype.forEachAfter=function(time,callback){var lowerBound=this._search(time);this._iterate(callback,lowerBound+1);return this};Tone.Timeline.prototype.forEachFrom=function(time,callback){var lowerBound=this._search(time);while(lowerBound>=0&&this._timeline[lowerBound].time>=time){lowerBound--}this._iterate(callback,lowerBound+1);return this};Tone.Timeline.prototype.forEachAtTime=function(time,callback){var upperBound=this._search(time);if(upperBound!==-1){this._iterate(function(event){if(event.time===time){callback(event)}},0,upperBound)}return this};Tone.Timeline.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._timeline=null;this._toRemove=null};return Tone.Timeline});Module(function(Tone){Tone.TimelineSignal=function(){var options=this.optionsObject(arguments,["value","units"],Tone.Signal.defaults);this._events=new Tone.Timeline(10);Tone.Signal.apply(this,options);options.param=this._param;Tone.Param.call(this,options);this._initial=this._fromUnits(this._param.value)};Tone.extend(Tone.TimelineSignal,Tone.Param);Tone.TimelineSignal.Type={Linear:"linear",Exponential:"exponential",Target:"target",Curve:"curve",Set:"set"};Object.defineProperty(Tone.TimelineSignal.prototype,"value",{get:function(){var now=this.now();var val=this.getValueAtTime(now);return this._toUnits(val)},set:function(value){var convertedVal=this._fromUnits(value);this._initial=convertedVal;this.cancelScheduledValues();this._param.value=convertedVal}});Tone.TimelineSignal.prototype.setValueAtTime=function(value,startTime){value=this._fromUnits(value);startTime=this.toSeconds(startTime);this._events.add({type:Tone.TimelineSignal.Type.Set,value:value,time:startTime});this._param.setValueAtTime(value,startTime);return this};Tone.TimelineSignal.prototype.linearRampToValueAtTime=function(value,endTime){value=this._fromUnits(value);endTime=this.toSeconds(endTime);this._events.add({type:Tone.TimelineSignal.Type.Linear,value:value,time:endTime});this._param.linearRampToValueAtTime(value,endTime);return this};Tone.TimelineSignal.prototype.exponentialRampToValueAtTime=function(value,endTime){endTime=this.toSeconds(endTime);var beforeEvent=this._searchBefore(endTime);if(beforeEvent&&beforeEvent.value===0){this.setValueAtTime(this._minOutput,beforeEvent.time)}value=this._fromUnits(value);var setValue=Math.max(value,this._minOutput);this._events.add({type:Tone.TimelineSignal.Type.Exponential,value:setValue,time:endTime});if(value<this._minOutput){this._param.exponentialRampToValueAtTime(this._minOutput,endTime-this.sampleTime);this.setValueAtTime(0,endTime)}else{this._param.exponentialRampToValueAtTime(value,endTime)}return this};Tone.TimelineSignal.prototype.setTargetAtTime=function(value,startTime,timeConstant){value=this._fromUnits(value);value=Math.max(this._minOutput,value);timeConstant=Math.max(this._minOutput,timeConstant);startTime=this.toSeconds(startTime);this._events.add({type:Tone.TimelineSignal.Type.Target,value:value,time:startTime,constant:timeConstant});this._param.setTargetAtTime(value,startTime,timeConstant);return this};Tone.TimelineSignal.prototype.setValueCurveAtTime=function(values,startTime,duration,scaling){scaling=this.defaultArg(scaling,1);var floats=new Array(values.length);for(var i=0;i<floats.length;i++){floats[i]=this._fromUnits(values[i])*scaling}startTime=this.toSeconds(startTime);duration=this.toSeconds(duration);this._events.add({type:Tone.TimelineSignal.Type.Curve,value:floats,time:startTime,duration:duration});this._param.setValueAtTime(floats[0],startTime);for(var j=1;j<floats.length;j++){var segmentTime=startTime+j/(floats.length-1)*duration;this._param.linearRampToValueAtTime(floats[j],segmentTime)}return this};Tone.TimelineSignal.prototype.cancelScheduledValues=function(after){after=this.toSeconds(after);this._events.cancel(after);this._param.cancelScheduledValues(after);return this};Tone.TimelineSignal.prototype.setRampPoint=function(time){time=this.toSeconds(time);var val=this._toUnits(this.getValueAtTime(time));var before=this._searchBefore(time);if(before&&before.time===time){this.cancelScheduledValues(time+this.sampleTime)}else if(before&&before.type===Tone.TimelineSignal.Type.Curve&&before.time+before.duration>time){this.cancelScheduledValues(time);this.linearRampToValueAtTime(val,time)}else{var after=this._searchAfter(time);if(after){this.cancelScheduledValues(time);if(after.type===Tone.TimelineSignal.Type.Linear){this.linearRampToValueAtTime(val,time)}else if(after.type===Tone.TimelineSignal.Type.Exponential){this.exponentialRampToValueAtTime(val,time)}}this.setValueAtTime(val,time)}return this};Tone.TimelineSignal.prototype.linearRampToValueBetween=function(value,start,finish){this.setRampPoint(start);this.linearRampToValueAtTime(value,finish);return this};Tone.TimelineSignal.prototype.exponentialRampToValueBetween=function(value,start,finish){this.setRampPoint(start);this.exponentialRampToValueAtTime(value,finish);return this};Tone.TimelineSignal.prototype._searchBefore=function(time){return this._events.get(time)};Tone.TimelineSignal.prototype._searchAfter=function(time){return this._events.getAfter(time)};Tone.TimelineSignal.prototype.getValueAtTime=function(time){time=this.toSeconds(time);var after=this._searchAfter(time);var before=this._searchBefore(time);var value=this._initial;if(before===null){value=this._initial}else if(before.type===Tone.TimelineSignal.Type.Target){var previous=this._events.getBefore(before.time);var previouVal;if(previous===null){previouVal=this._initial}else{previouVal=previous.value}value=this._exponentialApproach(before.time,previouVal,before.value,before.constant,time)}else if(before.type===Tone.TimelineSignal.Type.Curve){value=this._curveInterpolate(before.time,before.value,before.duration,time)}else if(after===null){value=before.value}else if(after.type===Tone.TimelineSignal.Type.Linear){value=this._linearInterpolate(before.time,before.value,after.time,after.value,time)}else if(after.type===Tone.TimelineSignal.Type.Exponential){value=this._exponentialInterpolate(before.time,before.value,after.time,after.value,time)}else{value=before.value}return value};Tone.TimelineSignal.prototype.connect=Tone.SignalBase.prototype.connect;Tone.TimelineSignal.prototype._exponentialApproach=function(t0,v0,v1,timeConstant,t){return v1+(v0-v1)*Math.exp(-(t-t0)/timeConstant)};Tone.TimelineSignal.prototype._linearInterpolate=function(t0,v0,t1,v1,t){return v0+(v1-v0)*((t-t0)/(t1-t0))};Tone.TimelineSignal.prototype._exponentialInterpolate=function(t0,v0,t1,v1,t){v0=Math.max(this._minOutput,v0);return v0*Math.pow(v1/v0,(t-t0)/(t1-t0))};Tone.TimelineSignal.prototype._curveInterpolate=function(start,curve,duration,time){var len=curve.length;if(time>=start+duration){return curve[len-1]}else if(time<=start){return curve[0]}else{var progress=(time-start)/duration;var lowerIndex=Math.floor((len-1)*progress);var upperIndex=Math.ceil((len-1)*progress);var lowerVal=curve[lowerIndex];var upperVal=curve[upperIndex];if(upperIndex===lowerIndex){return lowerVal}else{return this._linearInterpolate(lowerIndex,lowerVal,upperIndex,upperVal,progress*(len-1))}}};Tone.TimelineSignal.prototype.dispose=function(){Tone.Signal.prototype.dispose.call(this);Tone.Param.prototype.dispose.call(this);this._events.dispose();this._events=null};return Tone.TimelineSignal});Module(function(Tone){Tone.Pow=function(exp){this._exp=this.defaultArg(exp,1);this._expScaler=this.input=this.output=new Tone.WaveShaper(this._expFunc(this._exp),8192)};Tone.extend(Tone.Pow,Tone.SignalBase);Object.defineProperty(Tone.Pow.prototype,"value",{get:function(){return this._exp},set:function(exp){this._exp=exp;this._expScaler.setMap(this._expFunc(this._exp))}});Tone.Pow.prototype._expFunc=function(exp){return function(val){return Math.pow(Math.abs(val),exp)}};Tone.Pow.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._expScaler.dispose();this._expScaler=null;return this};return Tone.Pow});Module(function(Tone){Tone.Envelope=function(){var options=this.optionsObject(arguments,["attack","decay","sustain","release"],Tone.Envelope.defaults);this.attack=options.attack;this.decay=options.decay;this.sustain=options.sustain;this.release=options.release;this._attackCurve="linear";this._releaseCurve="exponential";this._sig=this.output=new Tone.TimelineSignal;this._sig.setValueAtTime(0,0);this.attackCurve=options.attackCurve;this.releaseCurve=options.releaseCurve};Tone.extend(Tone.Envelope);Tone.Envelope.defaults={attack:.01,decay:.1,sustain:.5,release:1,attackCurve:"linear",releaseCurve:"exponential"};Object.defineProperty(Tone.Envelope.prototype,"value",{get:function(){return this.getValueAtTime(this.now())}});Object.defineProperty(Tone.Envelope.prototype,"attackCurve",{get:function(){if(this.isString(this._attackCurve)){return this._attackCurve}else if(this.isArray(this._attackCurve)){for(var type in Tone.Envelope.Type){if(Tone.Envelope.Type[type].In===this._attackCurve){return type}}return this._attackCurve}},set:function(curve){if(Tone.Envelope.Type.hasOwnProperty(curve)){var curveDef=Tone.Envelope.Type[curve];if(this.isObject(curveDef)){this._attackCurve=curveDef.In}else{this._attackCurve=curveDef}}else if(this.isArray(curve)){this._attackCurve=curve}else{throw new Error("Tone.Envelope: invalid curve: "+curve)}}});Object.defineProperty(Tone.Envelope.prototype,"releaseCurve",{get:function(){if(this.isString(this._releaseCurve)){return this._releaseCurve}else if(this.isArray(this._releaseCurve)){for(var type in Tone.Envelope.Type){if(Tone.Envelope.Type[type].Out===this._releaseCurve){return type}}return this._releaseCurve}},set:function(curve){if(Tone.Envelope.Type.hasOwnProperty(curve)){var curveDef=Tone.Envelope.Type[curve];if(this.isObject(curveDef)){this._releaseCurve=curveDef.Out}else{this._releaseCurve=curveDef}}else if(this.isArray(curve)){this._releaseCurve=curve}else{throw new Error("Tone.Envelope: invalid curve: "+curve)}}});Tone.Envelope.prototype.triggerAttack=function(time,velocity){time=this.toSeconds(time);var originalAttack=this.toSeconds(this.attack);var attack=originalAttack;var decay=this.toSeconds(this.decay);velocity=this.defaultArg(velocity,1);var currentValue=this.getValueAtTime(time);if(currentValue>0){var attackRate=1/attack;var remainingDistance=1-currentValue;attack=remainingDistance/attackRate}if(this._attackCurve==="linear"){this._sig.linearRampToValue(velocity,attack,time)}else if(this._attackCurve==="exponential"){this._sig.exponentialRampToValue(velocity,attack,time)}else if(attack>0){this._sig.setRampPoint(time);var curve=this._attackCurve;if(attack<originalAttack){var percentComplete=1-attack/originalAttack;var sliceIndex=Math.floor(percentComplete*this._attackCurve.length);curve=this._attackCurve.slice(sliceIndex);curve[0]=currentValue}this._sig.setValueCurveAtTime(curve,time,attack,velocity)}this._sig.exponentialRampToValue(velocity*this.sustain,decay,attack+time);return this};Tone.Envelope.prototype.triggerRelease=function(time){time=this.toSeconds(time);var currentValue=this.getValueAtTime(time);if(currentValue>0){var release=this.toSeconds(this.release);if(this._releaseCurve==="linear"){this._sig.linearRampToValue(0,release,time)}else if(this._releaseCurve==="exponential"){this._sig.exponentialRampToValue(0,release,time)}else{var curve=this._releaseCurve;if(this.isArray(curve)){this._sig.setRampPoint(time);this._sig.setValueCurveAtTime(curve,time,release,currentValue)}}}return this};Tone.Envelope.prototype.getValueAtTime=function(time){return this._sig.getValueAtTime(time)};Tone.Envelope.prototype.triggerAttackRelease=function(duration,time,velocity){time=this.toSeconds(time);this.triggerAttack(time,velocity);this.triggerRelease(time+this.toSeconds(duration));return this};Tone.Envelope.prototype.cancel=function(after){this._sig.cancelScheduledValues(after);return this};Tone.Envelope.prototype.connect=Tone.Signal.prototype.connect;(function _createCurves(){var curveLen=128;var i,k;var cosineCurve=[];for(i=0;i<curveLen;i++){cosineCurve[i]=Math.sin(i/(curveLen-1)*(Math.PI/2))}var rippleCurve=[];var rippleCurveFreq=6.4;for(i=0;i<curveLen-1;i++){k=i/(curveLen-1);var sineWave=Math.sin(k*(Math.PI*2)*rippleCurveFreq-Math.PI/2)+1;rippleCurve[i]=sineWave/10+k*.83}rippleCurve[curveLen-1]=1;var stairsCurve=[];var steps=5;for(i=0;i<curveLen;i++){stairsCurve[i]=Math.ceil(i/(curveLen-1)*steps)/steps}var sineCurve=[];for(i=0;i<curveLen;i++){k=i/(curveLen-1);sineCurve[i]=.5*(1-Math.cos(Math.PI*k))}var bounceCurve=[];for(i=0;i<curveLen;i++){k=i/(curveLen-1);var freq=Math.pow(k,3)*4+.2;var val=Math.cos(freq*Math.PI*2*k);bounceCurve[i]=Math.abs(val*(1-k))}function invertCurve(curve){var out=new Array(curve.length);for(var j=0;j<curve.length;j++){out[j]=1-curve[j]}return out}function reverseCurve(curve){return curve.slice(0).reverse()}Tone.Envelope.Type={linear:"linear",exponential:"exponential",bounce:{In:invertCurve(bounceCurve),Out:bounceCurve},cosine:{In:cosineCurve,Out:reverseCurve(cosineCurve)},step:{In:stairsCurve,Out:invertCurve(stairsCurve)},ripple:{In:rippleCurve,Out:invertCurve(rippleCurve)},sine:{In:sineCurve,Out:invertCurve(sineCurve)}}})();Tone.Envelope.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._sig.dispose();this._sig=null;this._attackCurve=null;this._releaseCurve=null;return this};return Tone.Envelope});Module(function(Tone){Tone.AmplitudeEnvelope=function(){Tone.Envelope.apply(this,arguments);this.input=this.output=new Tone.Gain;this._sig.connect(this.output.gain)};Tone.extend(Tone.AmplitudeEnvelope,Tone.Envelope);Tone.AmplitudeEnvelope.prototype.dispose=function(){this.input.dispose();this.input=null;Tone.Envelope.prototype.dispose.call(this);return this};return Tone.AmplitudeEnvelope});Module(function(Tone){Tone.Analyser=function(){var options=this.optionsObject(arguments,["type","size"],Tone.Analyser.defaults);this._analyser=this.input=this.output=this.context.createAnalyser();this._type=options.type;this._returnType=options.returnType;this._buffer=null;this.size=options.size;this.type=options.type;this.returnType=options.returnType;this.minDecibels=options.minDecibels;this.maxDecibels=options.maxDecibels};Tone.extend(Tone.Analyser);Tone.Analyser.defaults={size:1024,returnType:"byte",type:"fft",smoothing:.8,maxDecibels:-30,minDecibels:-100};Tone.Analyser.Type={Waveform:"waveform",FFT:"fft"};Tone.Analyser.ReturnType={Byte:"byte",Float:"float"};Tone.Analyser.prototype.analyse=function(){if(this._type===Tone.Analyser.Type.FFT){if(this._returnType===Tone.Analyser.ReturnType.Byte){this._analyser.getByteFrequencyData(this._buffer)}else{this._analyser.getFloatFrequencyData(this._buffer)}}else if(this._type===Tone.Analyser.Type.Waveform){if(this._returnType===Tone.Analyser.ReturnType.Byte){this._analyser.getByteTimeDomainData(this._buffer)}else{if(this.isFunction(AnalyserNode.prototype.getFloatTimeDomainData)){this._analyser.getFloatTimeDomainData(this._buffer)}else{var uint8=new Uint8Array(this._buffer.length);this._analyser.getByteTimeDomainData(uint8);for(var i=0;i<uint8.length;i++){this._buffer[i]=(uint8[i]-128)*.0078125}}}}return this._buffer};Object.defineProperty(Tone.Analyser.prototype,"size",{get:function(){return this._analyser.frequencyBinCount},set:function(size){this._analyser.fftSize=size*2;this.type=this._type}});Object.defineProperty(Tone.Analyser.prototype,"returnType",{get:function(){return this._returnType},set:function(type){if(type===Tone.Analyser.ReturnType.Byte){this._buffer=new Uint8Array(this._analyser.frequencyBinCount)}else if(type===Tone.Analyser.ReturnType.Float){this._buffer=new Float32Array(this._analyser.frequencyBinCount)}else{throw new TypeError("Tone.Analayser: invalid return type: "+type)}this._returnType=type}});Object.defineProperty(Tone.Analyser.prototype,"type",{get:function(){return this._type},set:function(type){if(type!==Tone.Analyser.Type.Waveform&&type!==Tone.Analyser.Type.FFT){throw new TypeError("Tone.Analyser: invalid type: "+type)}this._type=type}});Object.defineProperty(Tone.Analyser.prototype,"smoothing",{get:function(){return this._analyser.smoothingTimeConstant},set:function(val){this._analyser.smoothingTimeConstant=val}});Object.defineProperty(Tone.Analyser.prototype,"minDecibels",{get:function(){return this._analyser.minDecibels},set:function(val){this._analyser.minDecibels=val}});Object.defineProperty(Tone.Analyser.prototype,"maxDecibels",{get:function(){return this._analyser.maxDecibels},set:function(val){this._analyser.maxDecibels=val}});Tone.Analyser.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._analyser.disconnect();this._analyser=null;this._buffer=null};return Tone.Analyser});Module(function(Tone){Tone.Compressor=function(){var options=this.optionsObject(arguments,["threshold","ratio"],Tone.Compressor.defaults);this._compressor=this.input=this.output=this.context.createDynamicsCompressor();this.threshold=new Tone.Param({param:this._compressor.threshold,units:Tone.Type.Decibels,convert:false});this.attack=new Tone.Param(this._compressor.attack,Tone.Type.Time);this.release=new Tone.Param(this._compressor.release,Tone.Type.Time);this.knee=new Tone.Param({param:this._compressor.knee,units:Tone.Type.Decibels,convert:false});this.ratio=new Tone.Param({param:this._compressor.ratio,convert:false});this._readOnly(["knee","release","attack","ratio","threshold"]);this.set(options)};Tone.extend(Tone.Compressor);Tone.Compressor.defaults={ratio:12,threshold:-24,release:.25,attack:.003,knee:30};Tone.Compressor.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._writable(["knee","release","attack","ratio","threshold"]);this._compressor.disconnect();this._compressor=null;this.attack.dispose();this.attack=null;this.release.dispose();this.release=null;this.threshold.dispose();this.threshold=null;this.ratio.dispose();this.ratio=null;this.knee.dispose();this.knee=null;return this};return Tone.Compressor});Module(function(Tone){Tone.Add=function(value){this.createInsOuts(2,0);this._sum=this.input[0]=this.input[1]=this.output=new Tone.Gain;this._param=this.input[1]=new Tone.Signal(value);this._param.connect(this._sum)};Tone.extend(Tone.Add,Tone.Signal);Tone.Add.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._sum.dispose();this._sum=null;this._param.dispose();this._param=null;return this};return Tone.Add});Module(function(Tone){Tone.Multiply=function(value){this.createInsOuts(2,0);this._mult=this.input[0]=this.output=new Tone.Gain;this._param=this.input[1]=this.output.gain;this._param.value=this.defaultArg(value,0)};Tone.extend(Tone.Multiply,Tone.Signal);Tone.Multiply.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._mult.dispose();this._mult=null;this._param=null;return this};return Tone.Multiply});Module(function(Tone){Tone.Negate=function(){this._multiply=this.input=this.output=new Tone.Multiply(-1)};Tone.extend(Tone.Negate,Tone.SignalBase);Tone.Negate.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._multiply.dispose();this._multiply=null;return this};return Tone.Negate});Module(function(Tone){Tone.Subtract=function(value){this.createInsOuts(2,0);this._sum=this.input[0]=this.output=new Tone.Gain;this._neg=new Tone.Negate;this._param=this.input[1]=new Tone.Signal(value);this._param.chain(this._neg,this._sum)};Tone.extend(Tone.Subtract,Tone.Signal);Tone.Subtract.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._neg.dispose();this._neg=null;this._sum.disconnect();this._sum=null;this._param.dispose();this._param=null;return this};return Tone.Subtract});Module(function(Tone){Tone.GreaterThanZero=function(){this._thresh=this.output=new Tone.WaveShaper(function(val){if(val<=0){return 0}else{return 1}},127);this._scale=this.input=new Tone.Multiply(1e4);this._scale.connect(this._thresh)};Tone.extend(Tone.GreaterThanZero,Tone.SignalBase);Tone.GreaterThanZero.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._scale.dispose();this._scale=null;this._thresh.dispose();this._thresh=null;return this};return Tone.GreaterThanZero});Module(function(Tone){Tone.GreaterThan=function(value){this.createInsOuts(2,0);this._param=this.input[0]=new Tone.Subtract(value);this.input[1]=this._param.input[1];this._gtz=this.output=new Tone.GreaterThanZero;this._param.connect(this._gtz)};Tone.extend(Tone.GreaterThan,Tone.Signal);Tone.GreaterThan.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._param.dispose();this._param=null;this._gtz.dispose();this._gtz=null;return this};return Tone.GreaterThan});Module(function(Tone){Tone.Abs=function(){this._abs=this.input=this.output=new Tone.WaveShaper(function(val){if(val===0){return 0}else{return Math.abs(val)}},127)};Tone.extend(Tone.Abs,Tone.SignalBase);Tone.Abs.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._abs.dispose();this._abs=null;return this};return Tone.Abs});Module(function(Tone){Tone.Modulo=function(modulus){this.createInsOuts(1,0);this._shaper=new Tone.WaveShaper(Math.pow(2,16));this._multiply=new Tone.Multiply;this._subtract=this.output=new Tone.Subtract;this._modSignal=new Tone.Signal(modulus);this.input.fan(this._shaper,this._subtract);this._modSignal.connect(this._multiply,0,0);this._shaper.connect(this._multiply,0,1);this._multiply.connect(this._subtract,0,1);this._setWaveShaper(modulus)};Tone.extend(Tone.Modulo,Tone.SignalBase);Tone.Modulo.prototype._setWaveShaper=function(mod){this._shaper.setMap(function(val){var multiple=Math.floor((val+1e-4)/mod);return multiple})};Object.defineProperty(Tone.Modulo.prototype,"value",{get:function(){return this._modSignal.value},set:function(mod){this._modSignal.value=mod;this._setWaveShaper(mod)}});Tone.Modulo.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._shaper.dispose();this._shaper=null;this._multiply.dispose();this._multiply=null;this._subtract.dispose();this._subtract=null;this._modSignal.dispose();this._modSignal=null;return this};return Tone.Modulo});Module(function(Tone){Tone.AudioToGain=function(){this._norm=this.input=this.output=new Tone.WaveShaper(function(x){return(x+1)/2})};Tone.extend(Tone.AudioToGain,Tone.SignalBase);Tone.AudioToGain.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._norm.dispose();this._norm=null;return this};return Tone.AudioToGain});Module(function(Tone){Tone.Expr=function(){var expr=this._replacements(Array.prototype.slice.call(arguments));var inputCount=this._parseInputs(expr);this._nodes=[];this.input=new Array(inputCount);for(var i=0;i<inputCount;i++){this.input[i]=this.context.createGain()}var tree=this._parseTree(expr);var result;try{result=this._eval(tree)}catch(e){this._disposeNodes();throw new Error("Tone.Expr: Could evaluate expression: "+expr)}this.output=result};Tone.extend(Tone.Expr,Tone.SignalBase);function applyBinary(Constructor,args,self){var op=new Constructor;self._eval(args[0]).connect(op,0,0);self._eval(args[1]).connect(op,0,1);return op}function applyUnary(Constructor,args,self){var op=new Constructor;self._eval(args[0]).connect(op,0,0);return op}function getNumber(arg){return arg?parseFloat(arg):undefined}function literalNumber(arg){return arg&&arg.args?parseFloat(arg.args):undefined}Tone.Expr._Expressions={value:{signal:{regexp:/^\d+\.\d+|^\d+/,method:function(arg){var sig=new Tone.Signal(getNumber(arg));return sig}},input:{regexp:/^\$\d/,method:function(arg,self){return self.input[getNumber(arg.substr(1))]}}},glue:{"(":{regexp:/^\(/},")":{regexp:/^\)/},",":{regexp:/^,/}},func:{abs:{regexp:/^abs/,method:applyUnary.bind(this,Tone.Abs)},mod:{regexp:/^mod/,method:function(args,self){var modulus=literalNumber(args[1]);var op=new Tone.Modulo(modulus);self._eval(args[0]).connect(op);return op}},pow:{regexp:/^pow/,method:function(args,self){var exp=literalNumber(args[1]);var op=new Tone.Pow(exp);self._eval(args[0]).connect(op);return op}},a2g:{regexp:/^a2g/,method:function(args,self){var op=new Tone.AudioToGain;self._eval(args[0]).connect(op);return op}}},binary:{"+":{regexp:/^\+/,precedence:1,method:applyBinary.bind(this,Tone.Add)},"-":{regexp:/^\-/,precedence:1,method:function(args,self){if(args.length===1){return applyUnary(Tone.Negate,args,self)}else{return applyBinary(Tone.Subtract,args,self)}}},"*":{regexp:/^\*/,precedence:0,method:applyBinary.bind(this,Tone.Multiply)}},unary:{"-":{regexp:/^\-/,method:applyUnary.bind(this,Tone.Negate)},"!":{regexp:/^\!/,method:applyUnary.bind(this,Tone.NOT)}}};Tone.Expr.prototype._parseInputs=function(expr){var inputArray=expr.match(/\$\d/g);var inputMax=0;if(inputArray!==null){for(var i=0;i<inputArray.length;i++){var inputNum=parseInt(inputArray[i].substr(1))+1;inputMax=Math.max(inputMax,inputNum)}}return inputMax};Tone.Expr.prototype._replacements=function(args){var expr=args.shift();for(var i=0;i<args.length;i++){expr=expr.replace(/\%/i,args[i])}return expr};Tone.Expr.prototype._tokenize=function(expr){var position=-1;var tokens=[];while(expr.length>0){expr=expr.trim();var token=getNextToken(expr);tokens.push(token);expr=expr.substr(token.value.length)}function getNextToken(expr){for(var type in Tone.Expr._Expressions){var group=Tone.Expr._Expressions[type];for(var opName in group){var op=group[opName];var reg=op.regexp;var match=expr.match(reg);if(match!==null){return{type:type,value:match[0],method:op.method}}}}throw new SyntaxError("Tone.Expr: Unexpected token "+expr)}return{next:function(){return tokens[++position]},peek:function(){return tokens[position+1]}}};Tone.Expr.prototype._parseTree=function(expr){var lexer=this._tokenize(expr);var isUndef=this.isUndef.bind(this);function matchSyntax(token,syn){return!isUndef(token)&&token.type==="glue"&&token.value===syn}function matchGroup(token,groupName,prec){var ret=false;var group=Tone.Expr._Expressions[groupName];if(!isUndef(token)){for(var opName in group){var op=group[opName];if(op.regexp.test(token.value)){if(!isUndef(prec)){if(op.precedence===prec){return true}}else{return true}}}}return ret}function parseExpression(precedence){if(isUndef(precedence)){precedence=5}var expr;if(precedence<0){
expr=parseUnary()}else{expr=parseExpression(precedence-1)}var token=lexer.peek();while(matchGroup(token,"binary",precedence)){token=lexer.next();expr={operator:token.value,method:token.method,args:[expr,parseExpression(precedence-1)]};token=lexer.peek()}return expr}function parseUnary(){var token,expr;token=lexer.peek();if(matchGroup(token,"unary")){token=lexer.next();expr=parseUnary();return{operator:token.value,method:token.method,args:[expr]}}return parsePrimary()}function parsePrimary(){var token,expr;token=lexer.peek();if(isUndef(token)){throw new SyntaxError("Tone.Expr: Unexpected termination of expression")}if(token.type==="func"){token=lexer.next();return parseFunctionCall(token)}if(token.type==="value"){token=lexer.next();return{method:token.method,args:token.value}}if(matchSyntax(token,"(")){lexer.next();expr=parseExpression();token=lexer.next();if(!matchSyntax(token,")")){throw new SyntaxError("Expected )")}return expr}throw new SyntaxError("Tone.Expr: Parse error, cannot process token "+token.value)}function parseFunctionCall(func){var token,args=[];token=lexer.next();if(!matchSyntax(token,"(")){throw new SyntaxError('Tone.Expr: Expected ( in a function call "'+func.value+'"')}token=lexer.peek();if(!matchSyntax(token,")")){args=parseArgumentList()}token=lexer.next();if(!matchSyntax(token,")")){throw new SyntaxError('Tone.Expr: Expected ) in a function call "'+func.value+'"')}return{method:func.method,args:args,name:name}}function parseArgumentList(){var token,expr,args=[];while(true){expr=parseExpression();if(isUndef(expr)){break}args.push(expr);token=lexer.peek();if(!matchSyntax(token,",")){break}lexer.next()}return args}return parseExpression()};Tone.Expr.prototype._eval=function(tree){if(!this.isUndef(tree)){var node=tree.method(tree.args,this);this._nodes.push(node);return node}};Tone.Expr.prototype._disposeNodes=function(){for(var i=0;i<this._nodes.length;i++){var node=this._nodes[i];if(this.isFunction(node.dispose)){node.dispose()}else if(this.isFunction(node.disconnect)){node.disconnect()}node=null;this._nodes[i]=null}this._nodes=null};Tone.Expr.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._disposeNodes()};return Tone.Expr});Module(function(Tone){Tone.EqualPowerGain=function(){this._eqPower=this.input=this.output=new Tone.WaveShaper(function(val){if(Math.abs(val)<.001){return 0}else{return this.equalPowerScale(val)}}.bind(this),4096)};Tone.extend(Tone.EqualPowerGain,Tone.SignalBase);Tone.EqualPowerGain.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._eqPower.dispose();this._eqPower=null;return this};return Tone.EqualPowerGain});Module(function(Tone){Tone.CrossFade=function(initialFade){this.createInsOuts(2,1);this.a=this.input[0]=new Tone.Gain;this.b=this.input[1]=new Tone.Gain;this.fade=new Tone.Signal(this.defaultArg(initialFade,.5),Tone.Type.NormalRange);this._equalPowerA=new Tone.EqualPowerGain;this._equalPowerB=new Tone.EqualPowerGain;this._invert=new Tone.Expr("1 - $0");this.a.connect(this.output);this.b.connect(this.output);this.fade.chain(this._equalPowerB,this.b.gain);this.fade.chain(this._invert,this._equalPowerA,this.a.gain);this._readOnly("fade")};Tone.extend(Tone.CrossFade);Tone.CrossFade.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._writable("fade");this._equalPowerA.dispose();this._equalPowerA=null;this._equalPowerB.dispose();this._equalPowerB=null;this.fade.dispose();this.fade=null;this._invert.dispose();this._invert=null;this.a.dispose();this.a=null;this.b.dispose();this.b=null;return this};return Tone.CrossFade});Module(function(Tone){Tone.Filter=function(){this.createInsOuts(1,1);var options=this.optionsObject(arguments,["frequency","type","rolloff"],Tone.Filter.defaults);this._filters=[];this.frequency=new Tone.Signal(options.frequency,Tone.Type.Frequency);this.detune=new Tone.Signal(0,Tone.Type.Cents);this.gain=new Tone.Signal({value:options.gain,convert:false});this.Q=new Tone.Signal(options.Q);this._type=options.type;this._rolloff=options.rolloff;this.rolloff=options.rolloff;this._readOnly(["detune","frequency","gain","Q"])};Tone.extend(Tone.Filter);Tone.Filter.defaults={type:"lowpass",frequency:350,rolloff:-12,Q:1,gain:0};Object.defineProperty(Tone.Filter.prototype,"type",{get:function(){return this._type},set:function(type){var types=["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"];if(types.indexOf(type)===-1){throw new TypeError("Tone.Filter: invalid type "+type)}this._type=type;for(var i=0;i<this._filters.length;i++){this._filters[i].type=type}}});Object.defineProperty(Tone.Filter.prototype,"rolloff",{get:function(){return this._rolloff},set:function(rolloff){rolloff=parseInt(rolloff,10);var possibilities=[-12,-24,-48,-96];var cascadingCount=possibilities.indexOf(rolloff);if(cascadingCount===-1){throw new RangeError("Tone.Filter: rolloff can only be -12, -24, -48 or -96")}cascadingCount+=1;this._rolloff=rolloff;this.input.disconnect();for(var i=0;i<this._filters.length;i++){this._filters[i].disconnect();this._filters[i]=null}this._filters=new Array(cascadingCount);for(var count=0;count<cascadingCount;count++){var filter=this.context.createBiquadFilter();filter.type=this._type;this.frequency.connect(filter.frequency);this.detune.connect(filter.detune);this.Q.connect(filter.Q);this.gain.connect(filter.gain);this._filters[count]=filter}var connectionChain=[this.input].concat(this._filters).concat([this.output]);this.connectSeries.apply(this,connectionChain)}});Tone.Filter.prototype.dispose=function(){Tone.prototype.dispose.call(this);for(var i=0;i<this._filters.length;i++){this._filters[i].disconnect();this._filters[i]=null}this._filters=null;this._writable(["detune","frequency","gain","Q"]);this.frequency.dispose();this.Q.dispose();this.frequency=null;this.Q=null;this.detune.dispose();this.detune=null;this.gain.dispose();this.gain=null;return this};return Tone.Filter});Module(function(Tone){Tone.MultibandSplit=function(){var options=this.optionsObject(arguments,["lowFrequency","highFrequency"],Tone.MultibandSplit.defaults);this.input=new Tone.Gain;this.output=new Array(3);this.low=this.output[0]=new Tone.Filter(0,"lowpass");this._lowMidFilter=new Tone.Filter(0,"highpass");this.mid=this.output[1]=new Tone.Filter(0,"lowpass");this.high=this.output[2]=new Tone.Filter(0,"highpass");this.lowFrequency=new Tone.Signal(options.lowFrequency,Tone.Type.Frequency);this.highFrequency=new Tone.Signal(options.highFrequency,Tone.Type.Frequency);this.Q=new Tone.Signal(options.Q);this.input.fan(this.low,this.high);this.input.chain(this._lowMidFilter,this.mid);this.lowFrequency.connect(this.low.frequency);this.lowFrequency.connect(this._lowMidFilter.frequency);this.highFrequency.connect(this.mid.frequency);this.highFrequency.connect(this.high.frequency);this.Q.connect(this.low.Q);this.Q.connect(this._lowMidFilter.Q);this.Q.connect(this.mid.Q);this.Q.connect(this.high.Q);this._readOnly(["high","mid","low","highFrequency","lowFrequency"])};Tone.extend(Tone.MultibandSplit);Tone.MultibandSplit.defaults={lowFrequency:400,highFrequency:2500,Q:1};Tone.MultibandSplit.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._writable(["high","mid","low","highFrequency","lowFrequency"]);this.low.dispose();this.low=null;this._lowMidFilter.dispose();this._lowMidFilter=null;this.mid.dispose();this.mid=null;this.high.dispose();this.high=null;this.lowFrequency.dispose();this.lowFrequency=null;this.highFrequency.dispose();this.highFrequency=null;this.Q.dispose();this.Q=null;return this};return Tone.MultibandSplit});Module(function(Tone){Tone.EQ3=function(){var options=this.optionsObject(arguments,["low","mid","high"],Tone.EQ3.defaults);this.output=new Tone.Gain;this._multibandSplit=this.input=new Tone.MultibandSplit({lowFrequency:options.lowFrequency,highFrequency:options.highFrequency});this._lowGain=new Tone.Gain(options.low,Tone.Type.Decibels);this._midGain=new Tone.Gain(options.mid,Tone.Type.Decibels);this._highGain=new Tone.Gain(options.high,Tone.Type.Decibels);this.low=this._lowGain.gain;this.mid=this._midGain.gain;this.high=this._highGain.gain;this.Q=this._multibandSplit.Q;this.lowFrequency=this._multibandSplit.lowFrequency;this.highFrequency=this._multibandSplit.highFrequency;this._multibandSplit.low.chain(this._lowGain,this.output);this._multibandSplit.mid.chain(this._midGain,this.output);this._multibandSplit.high.chain(this._highGain,this.output);this._readOnly(["low","mid","high","lowFrequency","highFrequency"])};Tone.extend(Tone.EQ3);Tone.EQ3.defaults={low:0,mid:0,high:0,lowFrequency:400,highFrequency:2500};Tone.EQ3.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._writable(["low","mid","high","lowFrequency","highFrequency"]);this._multibandSplit.dispose();this._multibandSplit=null;this.lowFrequency=null;this.highFrequency=null;this._lowGain.dispose();this._lowGain=null;this._midGain.dispose();this._midGain=null;this._highGain.dispose();this._highGain=null;this.low=null;this.mid=null;this.high=null;this.Q=null;return this};return Tone.EQ3});Module(function(Tone){Tone.Scale=function(outputMin,outputMax){this._outputMin=this.defaultArg(outputMin,0);this._outputMax=this.defaultArg(outputMax,1);this._scale=this.input=new Tone.Multiply(1);this._add=this.output=new Tone.Add(0);this._scale.connect(this._add);this._setRange()};Tone.extend(Tone.Scale,Tone.SignalBase);Object.defineProperty(Tone.Scale.prototype,"min",{get:function(){return this._outputMin},set:function(min){this._outputMin=min;this._setRange()}});Object.defineProperty(Tone.Scale.prototype,"max",{get:function(){return this._outputMax},set:function(max){this._outputMax=max;this._setRange()}});Tone.Scale.prototype._setRange=function(){this._add.value=this._outputMin;this._scale.value=this._outputMax-this._outputMin};Tone.Scale.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._add.dispose();this._add=null;this._scale.dispose();this._scale=null;return this};return Tone.Scale});Module(function(Tone){Tone.ScaleExp=function(outputMin,outputMax,exponent){this._scale=this.output=new Tone.Scale(outputMin,outputMax);this._exp=this.input=new Tone.Pow(this.defaultArg(exponent,2));this._exp.connect(this._scale)};Tone.extend(Tone.ScaleExp,Tone.SignalBase);Object.defineProperty(Tone.ScaleExp.prototype,"exponent",{get:function(){return this._exp.value},set:function(exp){this._exp.value=exp}});Object.defineProperty(Tone.ScaleExp.prototype,"min",{get:function(){return this._scale.min},set:function(min){this._scale.min=min}});Object.defineProperty(Tone.ScaleExp.prototype,"max",{get:function(){return this._scale.max},set:function(max){this._scale.max=max}});Tone.ScaleExp.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._scale.dispose();this._scale=null;this._exp.dispose();this._exp=null;return this};return Tone.ScaleExp});Module(function(Tone){Tone.Delay=function(){var options=this.optionsObject(arguments,["delayTime","maxDelay"],Tone.Delay.defaults);this._delayNode=this.input=this.output=this.context.createDelay(this.toSeconds(options.maxDelay));this.delayTime=new Tone.Param({param:this._delayNode.delayTime,units:Tone.Type.Time,value:options.delayTime});this._readOnly("delayTime")};Tone.extend(Tone.Delay);Tone.Delay.defaults={maxDelay:1,delayTime:0};Tone.Delay.prototype.dispose=function(){Tone.Param.prototype.dispose.call(this);this._delayNode.disconnect();this._delayNode=null;this._writable("delayTime");this.delayTime=null;return this};return Tone.Delay});Module(function(Tone){Tone.FeedbackCombFilter=function(){var options=this.optionsObject(arguments,["delayTime","resonance"],Tone.FeedbackCombFilter.defaults);this._delay=this.input=this.output=new Tone.Delay(options.delayTime);this.delayTime=this._delay.delayTime;this._feedback=new Tone.Gain(options.resonance,Tone.Type.NormalRange);this.resonance=this._feedback.gain;this._delay.chain(this._feedback,this._delay);this._readOnly(["resonance","delayTime"])};Tone.extend(Tone.FeedbackCombFilter);Tone.FeedbackCombFilter.defaults={delayTime:.1,resonance:.5};Tone.FeedbackCombFilter.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._writable(["resonance","delayTime"]);this._delay.dispose();this._delay=null;this.delayTime=null;this._feedback.dispose();this._feedback=null;this.resonance=null;return this};return Tone.FeedbackCombFilter});Module(function(Tone){Tone.Follower=function(){this.createInsOuts(1,1);var options=this.optionsObject(arguments,["attack","release"],Tone.Follower.defaults);this._abs=new Tone.Abs;this._filter=this.context.createBiquadFilter();this._filter.type="lowpass";this._filter.frequency.value=0;this._filter.Q.value=-100;this._frequencyValues=new Tone.WaveShaper;this._sub=new Tone.Subtract;this._delay=new Tone.Delay(this.blockTime);this._mult=new Tone.Multiply(1e4);this._attack=options.attack;this._release=options.release;this.input.chain(this._abs,this._filter,this.output);this._abs.connect(this._sub,0,1);this._filter.chain(this._delay,this._sub);this._sub.chain(this._mult,this._frequencyValues,this._filter.frequency);this._setAttackRelease(this._attack,this._release)};Tone.extend(Tone.Follower);Tone.Follower.defaults={attack:.05,release:.5};Tone.Follower.prototype._setAttackRelease=function(attack,release){var minTime=this.blockTime;attack=Tone.Time(attack).toFrequency();release=Tone.Time(release).toFrequency();attack=Math.max(attack,minTime);release=Math.max(release,minTime);this._frequencyValues.setMap(function(val){if(val<=0){return attack}else{return release}})};Object.defineProperty(Tone.Follower.prototype,"attack",{get:function(){return this._attack},set:function(attack){this._attack=attack;this._setAttackRelease(this._attack,this._release)}});Object.defineProperty(Tone.Follower.prototype,"release",{get:function(){return this._release},set:function(release){this._release=release;this._setAttackRelease(this._attack,this._release)}});Tone.Follower.prototype.connect=Tone.Signal.prototype.connect;Tone.Follower.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._filter.disconnect();this._filter=null;this._frequencyValues.disconnect();this._frequencyValues=null;this._delay.dispose();this._delay=null;this._sub.disconnect();this._sub=null;this._abs.dispose();this._abs=null;this._mult.dispose();this._mult=null;this._curve=null;return this};return Tone.Follower});Module(function(Tone){Tone.ScaledEnvelope=function(){var options=this.optionsObject(arguments,["attack","decay","sustain","release"],Tone.Envelope.defaults);Tone.Envelope.call(this,options);options=this.defaultArg(options,Tone.ScaledEnvelope.defaults);this._exp=this.output=new Tone.Pow(options.exponent);this._scale=this.output=new Tone.Scale(options.min,options.max);this._sig.chain(this._exp,this._scale)};Tone.extend(Tone.ScaledEnvelope,Tone.Envelope);Tone.ScaledEnvelope.defaults={min:0,max:1,exponent:1};Object.defineProperty(Tone.ScaledEnvelope.prototype,"min",{get:function(){return this._scale.min},set:function(min){this._scale.min=min}});Object.defineProperty(Tone.ScaledEnvelope.prototype,"max",{get:function(){return this._scale.max},set:function(max){this._scale.max=max}});Object.defineProperty(Tone.ScaledEnvelope.prototype,"exponent",{get:function(){return this._exp.value},set:function(exp){this._exp.value=exp}});Tone.ScaledEnvelope.prototype.dispose=function(){Tone.Envelope.prototype.dispose.call(this);this._scale.dispose();this._scale=null;this._exp.dispose();this._exp=null;return this};return Tone.ScaledEnvelope});Module(function(Tone){Tone.FrequencyEnvelope=function(){var options=this.optionsObject(arguments,["attack","decay","sustain","release"],Tone.Envelope.defaults);Tone.ScaledEnvelope.call(this,options);options=this.defaultArg(options,Tone.FrequencyEnvelope.defaults);this._octaves=options.octaves;this.baseFrequency=options.baseFrequency;this.octaves=options.octaves};Tone.extend(Tone.FrequencyEnvelope,Tone.Envelope);Tone.FrequencyEnvelope.defaults={baseFrequency:200,octaves:4,exponent:2};Object.defineProperty(Tone.FrequencyEnvelope.prototype,"baseFrequency",{get:function(){return this._scale.min},set:function(min){this._scale.min=this.toFrequency(min);this.octaves=this._octaves}});Object.defineProperty(Tone.FrequencyEnvelope.prototype,"octaves",{get:function(){return this._octaves},set:function(octaves){this._octaves=octaves;this._scale.max=this.baseFrequency*Math.pow(2,octaves)}});Object.defineProperty(Tone.FrequencyEnvelope.prototype,"exponent",{get:function(){return this._exp.value},set:function(exp){this._exp.value=exp}});Tone.FrequencyEnvelope.prototype.dispose=function(){Tone.ScaledEnvelope.prototype.dispose.call(this);return this};return Tone.FrequencyEnvelope});Module(function(Tone){Tone.Gate=function(){this.createInsOuts(1,1);var options=this.optionsObject(arguments,["threshold","attack","release"],Tone.Gate.defaults);this._follower=new Tone.Follower(options.attack,options.release);this._gt=new Tone.GreaterThan(this.dbToGain(options.threshold));this.input.connect(this.output);this.input.chain(this._gt,this._follower,this.output.gain)};Tone.extend(Tone.Gate);Tone.Gate.defaults={attack:.1,release:.1,threshold:-40};Object.defineProperty(Tone.Gate.prototype,"threshold",{get:function(){return this.gainToDb(this._gt.value)},set:function(thresh){this._gt.value=this.dbToGain(thresh)}});Object.defineProperty(Tone.Gate.prototype,"attack",{get:function(){return this._follower.attack},set:function(attackTime){this._follower.attack=attackTime}});Object.defineProperty(Tone.Gate.prototype,"release",{get:function(){return this._follower.release},set:function(releaseTime){this._follower.release=releaseTime}});Tone.Gate.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._follower.dispose();this._gt.dispose();this._follower=null;this._gt=null;return this};return Tone.Gate});Module(function(Tone){Tone.TimelineState=function(initial){Tone.Timeline.call(this);this._initial=initial};Tone.extend(Tone.TimelineState,Tone.Timeline);Tone.TimelineState.prototype.getValueAtTime=function(time){var event=this.get(time);if(event!==null){return event.state}else{return this._initial}};Tone.TimelineState.prototype.setStateAtTime=function(state,time){this.add({state:state,time:time})};return Tone.TimelineState});Module(function(Tone){Tone.Emitter=function(){this._events={}};Tone.extend(Tone.Emitter);Tone.Emitter.prototype.on=function(event,callback){var events=event.split(/\W+/);for(var i=0;i<events.length;i++){var eventName=events[i];if(!this._events.hasOwnProperty(eventName)){this._events[eventName]=[]}this._events[eventName].push(callback)}return this};Tone.Emitter.prototype.off=function(event,callback){var events=event.split(/\W+/);for(var ev=0;ev<events.length;ev++){event=events[ev];if(this._events.hasOwnProperty(event)){if(Tone.prototype.isUndef(callback)){this._events[event]=[]}else{var eventList=this._events[event];for(var i=0;i<eventList.length;i++){if(eventList[i]===callback){eventList.splice(i,1)}}}}}return this};Tone.Emitter.prototype.emit=function(event){if(this._events){var args=Array.prototype.slice.call(arguments,1);if(this._events.hasOwnProperty(event)){var eventList=this._events[event];for(var i=0,len=eventList.length;i<len;i++){eventList[i].apply(this,args)}}}return this};Tone.Emitter.mixin=function(object){var functions=["on","off","emit"];object._events={};for(var i=0;i<functions.length;i++){var func=functions[i];var emitterFunc=Tone.Emitter.prototype[func];object[func]=emitterFunc}};Tone.Emitter.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._events=null;return this};return Tone.Emitter});Module(function(Tone){Tone.Clock=function(){Tone.Emitter.call(this);var options=this.optionsObject(arguments,["callback","frequency"],Tone.Clock.defaults);this.callback=options.callback;this._nextTick=0;this._lastState=Tone.State.Stopped;this.frequency=new Tone.TimelineSignal(options.frequency,Tone.Type.Frequency);this._readOnly("frequency");this.ticks=0;this._state=new Tone.TimelineState(Tone.State.Stopped);this._boundLoop=this._loop.bind(this);Tone.Clock._worker.addEventListener("message",this._boundLoop)};Tone.extend(Tone.Clock,Tone.Emitter);Tone.Clock.defaults={callback:Tone.noOp,frequency:1,lookAhead:"auto"};Object.defineProperty(Tone.Clock.prototype,"state",{get:function(){return this._state.getValueAtTime(this.now())}});Tone.Clock.prototype.start=function(time,offset){time=this.toSeconds(time);if(this._state.getValueAtTime(time)!==Tone.State.Started){this._state.add({state:Tone.State.Started,time:time,offset:offset})}return this};Tone.Clock.prototype.stop=function(time){time=this.toSeconds(time);this._state.cancel(time);this._state.setStateAtTime(Tone.State.Stopped,time);return this};Tone.Clock.prototype.pause=function(time){time=this.toSeconds(time);if(this._state.getValueAtTime(time)===Tone.State.Started){this._state.setStateAtTime(Tone.State.Paused,time)}return this};Tone.Clock.prototype._loop=function(){var now=this.now();var lookAhead=Tone.Clock.lookAhead;var updateInterval=Tone.Clock.updateInterval;var lagCompensation=Tone.Clock.lag*2;var loopInterval=now+lookAhead+updateInterval+lagCompensation;while(loopInterval>this._nextTick&&this._state){var currentState=this._state.getValueAtTime(this._nextTick);if(currentState!==this._lastState){this._lastState=currentState;var event=this._state.get(this._nextTick);if(currentState===Tone.State.Started){this._nextTick=event.time;if(!this.isUndef(event.offset)){this.ticks=event.offset}this.emit("start",event.time,this.ticks)}else if(currentState===Tone.State.Stopped){this.ticks=0;this.emit("stop",event.time)}else if(currentState===Tone.State.Paused){this.emit("pause",event.time)}}var tickTime=this._nextTick;if(this.frequency){this._nextTick+=1/this.frequency.getValueAtTime(this._nextTick);if(currentState===Tone.State.Started){this.callback(tickTime);this.ticks++}}}};Tone.Clock.prototype.getStateAtTime=function(time){time=this.toSeconds(time);return this._state.getValueAtTime(time)};Tone.Clock.prototype.dispose=function(){Tone.Emitter.prototype.dispose.call(this);Tone.Clock._worker.removeEventListener("message",this._boundLoop);this._writable("frequency");this.frequency.dispose();this.frequency=null;this._boundLoop=null;this._nextTick=Infinity;this.callback=null;this._state.dispose();this._state=null};window.URL=window.URL||window.webkitURL;Tone.Clock._lookAhead=.1;Tone.Clock._updateInterval=Tone.Clock._lookAhead/3;var blob=new Blob(["var timeoutTime = "+Tone.Clock._updateInterval*1e3+";"+"self.onmessage = function(msg){"+"\ttimeoutTime = parseInt(msg.data);"+"};"+"function tick(){"+"\tsetTimeout(tick, timeoutTime);"+"\tself.postMessage('tick');"+"}"+"tick();"]);var blobUrl=URL.createObjectURL(blob);Tone.Clock._worker=new Worker(blobUrl);var lastUpdate=-1;var computedUpdateInterval=0;Tone.Clock._worker.addEventListener("message",function(){var now=Tone.now();if(lastUpdate!==-1){var diff=now-lastUpdate;computedUpdateInterval=Math.max(diff,computedUpdateInterval*.97)}lastUpdate=now});Object.defineProperty(Tone.Clock,"lag",{get:function(){var diff=computedUpdateInterval-Tone.Clock._updateInterval;diff=Math.max(diff,0);return diff}});Object.defineProperty(Tone.Clock,"lookAhead",{get:function(){return Tone.Clock._lookAhead},set:function(lA){Tone.Clock._lookAhead=lA}});Object.defineProperty(Tone.Clock,"updateInterval",{get:function(){return Tone.Clock._updateInterval},set:function(interval){Tone.Clock._updateInterval=Math.max(interval,.01);Tone.Clock._worker.postMessage(interval*1e3)}});var latencyHint="interactive";Object.defineProperty(Tone.Clock,"latencyHint",{get:function(){return latencyHint},set:function(hint){var lookAhead=hint;latencyHint=hint;if(Tone.prototype.isString(hint)){switch(hint){case"interactive":lookAhead=.1;Tone.context.latencyHint=hint;break;case"playback":lookAhead=.8;Tone.context.latencyHint=hint;break;case"balanced":lookAhead=.25;Tone.context.latencyHint=hint;break;case"fastest":lookAhead=.01;break}}Tone.Clock.lookAhead=lookAhead;Tone.Clock.updateInterval=lookAhead/3}});Tone._initAudioContext(function(){lastUpdate=-1;computedUpdateInterval=0});return Tone.Clock});Module(function(Tone){Tone.IntervalTimeline=function(){this._root=null;this._length=0};Tone.extend(Tone.IntervalTimeline);Tone.IntervalTimeline.prototype.add=function(event){if(this.isUndef(event.time)||this.isUndef(event.duration)){throw new Error("Tone.IntervalTimeline: events must have time and duration parameters")}var node=new IntervalNode(event.time,event.time+event.duration,event);if(this._root===null){this._root=node}else{this._root.insert(node)}this._length++;while(node!==null){node.updateHeight();node.updateMax();this._rebalance(node);node=node.parent}return this};Tone.IntervalTimeline.prototype.remove=function(event){if(this._root!==null){var results=[];this._root.search(event.time,results);for(var i=0;i<results.length;i++){var node=results[i];if(node.event===event){this._removeNode(node);this._length--;break}}}return this};Object.defineProperty(Tone.IntervalTimeline.prototype,"length",{get:function(){return this._length}});Tone.IntervalTimeline.prototype.cancel=function(after){this.forEachAfter(after,function(event){this.remove(event)}.bind(this));return this};Tone.IntervalTimeline.prototype._setRoot=function(node){this._root=node;if(this._root!==null){this._root.parent=null}};Tone.IntervalTimeline.prototype._replaceNodeInParent=function(node,replacement){if(node.parent!==null){if(node.isLeftChild()){node.parent.left=replacement}else{node.parent.right=replacement}this._rebalance(node.parent)}else{this._setRoot(replacement)}};Tone.IntervalTimeline.prototype._removeNode=function(node){if(node.left===null&&node.right===null){this._replaceNodeInParent(node,null)}else if(node.right===null){this._replaceNodeInParent(node,node.left)}else if(node.left===null){this._replaceNodeInParent(node,node.right)}else{var balance=node.getBalance();var replacement,temp;if(balance>0){if(node.left.right===null){replacement=node.left;replacement.right=node.right;temp=replacement}else{replacement=node.left.right;while(replacement.right!==null){replacement=replacement.right}replacement.parent.right=replacement.left;temp=replacement.parent;replacement.left=node.left;replacement.right=node.right}}else{if(node.right.left===null){replacement=node.right;replacement.left=node.left;temp=replacement}else{replacement=node.right.left;while(replacement.left!==null){replacement=replacement.left}replacement.parent=replacement.parent;replacement.parent.left=replacement.right;temp=replacement.parent;replacement.left=node.left;replacement.right=node.right}}if(node.parent!==null){if(node.isLeftChild()){node.parent.left=replacement}else{node.parent.right=replacement}}else{this._setRoot(replacement)}this._rebalance(temp)}node.dispose()};Tone.IntervalTimeline.prototype._rotateLeft=function(node){var parent=node.parent;var isLeftChild=node.isLeftChild();var pivotNode=node.right;node.right=pivotNode.left;pivotNode.left=node;if(parent!==null){if(isLeftChild){parent.left=pivotNode}else{parent.right=pivotNode}}else{this._setRoot(pivotNode)}};Tone.IntervalTimeline.prototype._rotateRight=function(node){var parent=node.parent;var isLeftChild=node.isLeftChild();var pivotNode=node.left;node.left=pivotNode.right;pivotNode.right=node;if(parent!==null){if(isLeftChild){parent.left=pivotNode}else{parent.right=pivotNode}}else{this._setRoot(pivotNode)}};Tone.IntervalTimeline.prototype._rebalance=function(node){var balance=node.getBalance();if(balance>1){if(node.left.getBalance()<0){this._rotateLeft(node.left)}else{this._rotateRight(node)}}else if(balance<-1){if(node.right.getBalance()>0){this._rotateRight(node.right)}else{this._rotateLeft(node)}}};Tone.IntervalTimeline.prototype.get=function(time){if(this._root!==null){var results=[];this._root.search(time,results);if(results.length>0){var max=results[0];for(var i=1;i<results.length;i++){if(results[i].low>max.low){max=results[i]}}return max.event}}return null};Tone.IntervalTimeline.prototype.forEach=function(callback){if(this._root!==null){var allNodes=[];if(this._root!==null){this._root.traverse(function(node){allNodes.push(node)})}for(var i=0;i<allNodes.length;i++){var ev=allNodes[i].event;if(ev){callback(ev)}}}return this};Tone.IntervalTimeline.prototype.forEachAtTime=function(time,callback){if(this._root!==null){var results=[];this._root.search(time,results);for(var i=results.length-1;i>=0;i--){var ev=results[i].event;if(ev){callback(ev)}}}return this};Tone.IntervalTimeline.prototype.forEachAfter=function(time,callback){if(this._root!==null){var results=[];this._root.searchAfter(time,results);for(var i=results.length-1;i>=0;i--){var ev=results[i].event;if(ev){callback(ev)}}}return this};Tone.IntervalTimeline.prototype.dispose=function(){var allNodes=[];if(this._root!==null){this._root.traverse(function(node){allNodes.push(node)})}for(var i=0;i<allNodes.length;i++){allNodes[i].dispose()}allNodes=null;this._root=null;return this};var IntervalNode=function(low,high,event){this.event=event;this.low=low;this.high=high;this.max=this.high;this._left=null;this._right=null;this.parent=null;this.height=0};IntervalNode.prototype.insert=function(node){if(node.low<=this.low){if(this.left===null){this.left=node}else{this.left.insert(node)}}else{if(this.right===null){this.right=node}else{this.right.insert(node)}}};IntervalNode.prototype.search=function(point,results){if(point>this.max){return}if(this.left!==null){this.left.search(point,results)}if(this.low<=point&&this.high>point){results.push(this)}if(this.low>point){return}if(this.right!==null){this.right.search(point,results)}};IntervalNode.prototype.searchAfter=function(point,results){if(this.low>=point){results.push(this);if(this.left!==null){this.left.searchAfter(point,results)}}if(this.right!==null){this.right.searchAfter(point,results)}};IntervalNode.prototype.traverse=function(callback){callback(this);if(this.left!==null){this.left.traverse(callback)}if(this.right!==null){this.right.traverse(callback)}};IntervalNode.prototype.updateHeight=function(){if(this.left!==null&&this.right!==null){this.height=Math.max(this.left.height,this.right.height)+1}else if(this.right!==null){this.height=this.right.height+1}else if(this.left!==null){this.height=this.left.height+1}else{this.height=0}};IntervalNode.prototype.updateMax=function(){this.max=this.high;if(this.left!==null){this.max=Math.max(this.max,this.left.max)}if(this.right!==null){this.max=Math.max(this.max,this.right.max)}};IntervalNode.prototype.getBalance=function(){var balance=0;if(this.left!==null&&this.right!==null){balance=this.left.height-this.right.height}else if(this.left!==null){balance=this.left.height+1}else if(this.right!==null){balance=-(this.right.height+1)}return balance};IntervalNode.prototype.isLeftChild=function(){return this.parent!==null&&this.parent.left===this};Object.defineProperty(IntervalNode.prototype,"left",{get:function(){return this._left},set:function(node){this._left=node;if(node!==null){node.parent=this}this.updateHeight();this.updateMax()}});Object.defineProperty(IntervalNode.prototype,"right",{get:function(){return this._right},set:function(node){this._right=node;if(node!==null){node.parent=this}this.updateHeight();this.updateMax()}});IntervalNode.prototype.dispose=function(){this.parent=null;this._left=null;this._right=null;this.event=null};return Tone.IntervalTimeline});Module(function(Tone){Tone.Transport=function(){Tone.Emitter.call(this);this.loop=false;this._loopStart=0;this._loopEnd=0;this._ppq=TransportConstructor.defaults.PPQ;this._clock=new Tone.Clock({callback:this._processTick.bind(this),frequency:0});this._bindClockEvents();this.bpm=this._clock.frequency;this.bpm._toUnits=this._toUnits.bind(this);this.bpm._fromUnits=this._fromUnits.bind(this);this.bpm.units=Tone.Type.BPM;this.bpm.value=TransportConstructor.defaults.bpm;this._readOnly("bpm");this._timeSignature=TransportConstructor.defaults.timeSignature;this._scheduledEvents={};this._eventID=0;this._timeline=new Tone.Timeline;this._repeatedEvents=new Tone.IntervalTimeline;
this._onceEvents=new Tone.Timeline;this._syncedSignals=[];this._swingTicks=TransportConstructor.defaults.PPQ/2;this._swingAmount=0};Tone.extend(Tone.Transport,Tone.Emitter);Tone.Transport.defaults={bpm:120,swing:0,swingSubdivision:"8n",timeSignature:4,loopStart:0,loopEnd:"4m",PPQ:192};Tone.Transport.prototype._processTick=function(tickTime){var ticks=this._clock.ticks;if(this._swingAmount>0&&ticks%this._ppq!==0&&ticks%(this._swingTicks*2)!==0){var progress=ticks%(this._swingTicks*2)/(this._swingTicks*2);var amount=Math.sin(progress*Math.PI)*this._swingAmount;tickTime+=Tone.Time(this._swingTicks*2/3,"i").eval()*amount}if(this.loop){if(ticks===this._loopEnd){this.emit("loopEnd",tickTime);this._clock.ticks=this._loopStart;ticks=this._loopStart;this.emit("loopStart",tickTime,this.seconds);this.emit("loop",tickTime)}}this._onceEvents.forEachBefore(ticks,function(event){event.callback(tickTime);delete this._scheduledEvents[event.id.toString()]}.bind(this));this._onceEvents.cancelBefore(ticks);this._timeline.forEachAtTime(ticks,function(event){event.callback(tickTime)});this._repeatedEvents.forEachAtTime(ticks,function(event){if((ticks-event.time)%event.interval===0){event.callback(tickTime)}})};Tone.Transport.prototype.schedule=function(callback,time){var event={time:this.toTicks(time),callback:callback};var id=this._eventID++;this._scheduledEvents[id.toString()]={event:event,timeline:this._timeline};this._timeline.add(event);return id};Tone.Transport.prototype.scheduleRepeat=function(callback,interval,startTime,duration){if(interval<=0){throw new Error("Tone.Transport: repeat events must have an interval larger than 0")}var event={time:this.toTicks(startTime),duration:this.toTicks(this.defaultArg(duration,Infinity)),interval:this.toTicks(interval),callback:callback};var id=this._eventID++;this._scheduledEvents[id.toString()]={event:event,timeline:this._repeatedEvents};this._repeatedEvents.add(event);return id};Tone.Transport.prototype.scheduleOnce=function(callback,time){var id=this._eventID++;var event={time:this.toTicks(time),callback:callback,id:id};this._scheduledEvents[id.toString()]={event:event,timeline:this._onceEvents};this._onceEvents.add(event);return id};Tone.Transport.prototype.clear=function(eventId){if(this._scheduledEvents.hasOwnProperty(eventId)){var item=this._scheduledEvents[eventId.toString()];item.timeline.remove(item.event);delete this._scheduledEvents[eventId.toString()]}return this};Tone.Transport.prototype.cancel=function(after){after=this.defaultArg(after,0);after=this.toTicks(after);this._timeline.cancel(after);this._onceEvents.cancel(after);this._repeatedEvents.cancel(after);return this};Tone.Transport.prototype._bindClockEvents=function(){this._clock.on("start",function(time,offset){offset=Tone.Time(this._clock.ticks,"i").toSeconds();this.emit("start",time,offset)}.bind(this));this._clock.on("stop",function(time){this.emit("stop",time)}.bind(this));this._clock.on("pause",function(time){this.emit("pause",time)}.bind(this))};Object.defineProperty(Tone.Transport.prototype,"state",{get:function(){return this._clock.getStateAtTime(this.now())}});Tone.Transport.prototype.start=function(time,offset){if(!this.isUndef(offset)){offset=this.toTicks(offset)}this._clock.start(time,offset);return this};Tone.Transport.prototype.stop=function(time){this._clock.stop(time);return this};Tone.Transport.prototype.pause=function(time){this._clock.pause(time);return this};Object.defineProperty(Tone.Transport.prototype,"timeSignature",{get:function(){return this._timeSignature},set:function(timeSig){if(this.isArray(timeSig)){timeSig=timeSig[0]/timeSig[1]*4}this._timeSignature=timeSig}});Object.defineProperty(Tone.Transport.prototype,"loopStart",{get:function(){return Tone.TransportTime(this._loopStart,"i").toSeconds()},set:function(startPosition){this._loopStart=this.toTicks(startPosition)}});Object.defineProperty(Tone.Transport.prototype,"loopEnd",{get:function(){return Tone.TransportTime(this._loopEnd,"i").toSeconds()},set:function(endPosition){this._loopEnd=this.toTicks(endPosition)}});Tone.Transport.prototype.setLoopPoints=function(startPosition,endPosition){this.loopStart=startPosition;this.loopEnd=endPosition;return this};Object.defineProperty(Tone.Transport.prototype,"swing",{get:function(){return this._swingAmount},set:function(amount){this._swingAmount=amount}});Object.defineProperty(Tone.Transport.prototype,"swingSubdivision",{get:function(){return Tone.Time(this._swingTicks,"i").toNotation()},set:function(subdivision){this._swingTicks=this.toTicks(subdivision)}});Object.defineProperty(Tone.Transport.prototype,"position",{get:function(){return Tone.TransportTime(this.ticks,"i").toBarsBeatsSixteenths()},set:function(progress){var ticks=this.toTicks(progress);this.ticks=ticks}});Object.defineProperty(Tone.Transport.prototype,"seconds",{get:function(){return Tone.TransportTime(this.ticks,"i").toSeconds()},set:function(progress){var ticks=this.toTicks(progress);this.ticks=ticks}});Object.defineProperty(Tone.Transport.prototype,"progress",{get:function(){if(this.loop){return(this.ticks-this._loopStart)/(this._loopEnd-this._loopStart)}else{return 0}}});Object.defineProperty(Tone.Transport.prototype,"ticks",{get:function(){return this._clock.ticks},set:function(t){var now=this.now();if(this.state===Tone.State.Started){this.emit("stop",now);this._clock.ticks=t;this.emit("start",now,this.seconds)}else{this._clock.ticks=t}}});Object.defineProperty(Tone.Transport.prototype,"PPQ",{get:function(){return this._ppq},set:function(ppq){var bpm=this.bpm.value;this._ppq=ppq;this.bpm.value=bpm}});Object.defineProperty(Tone.Transport.prototype,"latencyHint",{get:function(){return Tone.Clock.latencyHint},set:function(hint){Tone.Clock.latencyHint=hint}});Tone.Transport.prototype._fromUnits=function(bpm){return 1/(60/bpm/this.PPQ)};Tone.Transport.prototype._toUnits=function(freq){return freq/this.PPQ*60};Tone.Transport.prototype.nextSubdivision=function(subdivision){subdivision=this.toSeconds(subdivision);var now;if(this.state===Tone.State.Started){now=this._clock._nextTick}else{return 0}var transportPos=Tone.Time(this.ticks,"i").eval();var remainingTime=subdivision-transportPos%subdivision;if(remainingTime===0){remainingTime=subdivision}return now+remainingTime};Tone.Transport.prototype.syncSignal=function(signal,ratio){if(!ratio){if(signal._param.value!==0){ratio=signal._param.value/this.bpm._param.value}else{ratio=0}}var ratioSignal=new Tone.Gain(ratio);this.bpm.chain(ratioSignal,signal._param);this._syncedSignals.push({ratio:ratioSignal,signal:signal,initial:signal._param.value});signal._param.value=0;return this};Tone.Transport.prototype.unsyncSignal=function(signal){for(var i=this._syncedSignals.length-1;i>=0;i--){var syncedSignal=this._syncedSignals[i];if(syncedSignal.signal===signal){syncedSignal.ratio.dispose();syncedSignal.signal._param.value=syncedSignal.initial;this._syncedSignals.splice(i,1)}}return this};Tone.Transport.prototype.dispose=function(){Tone.Emitter.prototype.dispose.call(this);this._clock.dispose();this._clock=null;this._writable("bpm");this.bpm=null;this._timeline.dispose();this._timeline=null;this._onceEvents.dispose();this._onceEvents=null;this._repeatedEvents.dispose();this._repeatedEvents=null;return this};var TransportConstructor=Tone.Transport;Tone._initAudioContext(function(){if(typeof Tone.Transport==="function"){Tone.Transport=new Tone.Transport}else{Tone.Transport.stop();var prevSettings=Tone.Transport.get();Tone.Transport.dispose();TransportConstructor.call(Tone.Transport);Tone.Transport.set(prevSettings)}});return Tone.Transport});Module(function(Tone){Tone.Volume=function(){var options=this.optionsObject(arguments,["volume"],Tone.Volume.defaults);this.output=this.input=new Tone.Gain(options.volume,Tone.Type.Decibels);this._unmutedVolume=0;this._muted=false;this.volume=this.output.gain;this._readOnly("volume");this.mute=options.mute};Tone.extend(Tone.Volume);Tone.Volume.defaults={volume:0,mute:false};Object.defineProperty(Tone.Volume.prototype,"mute",{get:function(){return this._muted},set:function(mute){if(!this._muted&&mute){this._unmutedVolume=this.volume.value;this.volume.value=-Infinity}else if(this._muted&&!mute){this.volume.value=this._unmutedVolume}this._muted=mute}});Tone.Volume.prototype.dispose=function(){this.input.dispose();Tone.prototype.dispose.call(this);this._writable("volume");this.volume.dispose();this.volume=null;return this};return Tone.Volume});Module(function(Tone){Tone.Master=function(){this.createInsOuts(1,1);this._volume=this.output=new Tone.Volume;this.volume=this._volume.volume;this._readOnly("volume");this.input.chain(this.output,this.context.destination)};Tone.extend(Tone.Master);Tone.Master.defaults={volume:0,mute:false};Object.defineProperty(Tone.Master.prototype,"mute",{get:function(){return this._volume.mute},set:function(mute){this._volume.mute=mute}});Tone.Master.prototype.chain=function(){this.input.disconnect();this.input.chain.apply(this.input,arguments);arguments[arguments.length-1].connect(this.output)};Tone.Master.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._writable("volume");this._volume.dispose();this._volume=null;this.volume=null};Tone.prototype.toMaster=function(){this.connect(Tone.Master);return this};AudioNode.prototype.toMaster=function(){this.connect(Tone.Master);return this};var MasterConstructor=Tone.Master;Tone._initAudioContext(function(){if(!Tone.prototype.isUndef(Tone.Master)){Tone.Master=new MasterConstructor}else{MasterConstructor.prototype.dispose.call(Tone.Master);MasterConstructor.call(Tone.Master)}});return Tone.Master});Module(function(Tone){Tone.Source=function(options){options=this.defaultArg(options,Tone.Source.defaults);this._volume=this.output=new Tone.Volume(options.volume);this.volume=this._volume.volume;this._readOnly("volume");this._state=new Tone.TimelineState(Tone.State.Stopped);this._state.memory=10;this._synced=false;this._scheduled=[];this._volume.output.output.channelCount=2;this._volume.output.output.channelCountMode="explicit";this.mute=options.mute};Tone.extend(Tone.Source);Tone.Source.defaults={volume:0,mute:false};Object.defineProperty(Tone.Source.prototype,"state",{get:function(){if(this._synced){if(Tone.Transport.state===Tone.State.Started){return this._state.getValueAtTime(Tone.Transport.seconds)}else{return Tone.State.Stopped}}else{return this._state.getValueAtTime(this.now())}}});Object.defineProperty(Tone.Source.prototype,"mute",{get:function(){return this._volume.mute},set:function(mute){this._volume.mute=mute}});Tone.Source.prototype._start=Tone.noOp;Tone.Source.prototype._stop=Tone.noOp;Tone.Source.prototype.start=function(time,offset,duration){if(this.isUndef(time)&&this._synced){time=Tone.Transport.seconds}else{time=this.toSeconds(time)}if(!this.retrigger&&this._state.getValueAtTime(time)===Tone.State.Started){this.stop(time)}this._state.setStateAtTime(Tone.State.Started,time);if(this._synced){var event=this._state.get(time);event.offset=this.defaultArg(offset,0);event.duration=duration;var sched=Tone.Transport.schedule(function(t){this._start(t,offset,duration)}.bind(this),time);this._scheduled.push(sched)}else{this._start.apply(this,arguments)}return this};Tone.Source.prototype.stop=function(time){if(this.isUndef(time)&&this._synced){time=Tone.Transport.seconds}else{time=this.toSeconds(time)}this._state.cancel(time);this._state.setStateAtTime(Tone.State.Stopped,time);if(!this._synced){this._stop.apply(this,arguments)}else{var sched=Tone.Transport.schedule(this._stop.bind(this),time);this._scheduled.push(sched)}return this};Tone.Source.prototype.sync=function(){this._synced=true;Tone.Transport.on("start loopStart",function(time,offset){if(offset>0){var stateEvent=this._state.get(offset);if(stateEvent&&stateEvent.state===Tone.State.Started&&stateEvent.time!==offset){var startOffset=offset-this.toSeconds(stateEvent.time);var duration;if(stateEvent.duration){duration=this.toSeconds(stateEvent.duration)-startOffset}this._start(time,this.toSeconds(stateEvent.offset)+startOffset,duration)}}}.bind(this));Tone.Transport.on("stop pause loopEnd",function(time){if(this._state.getValueAtTime(Tone.Transport.seconds)===Tone.State.Started){this._stop(time)}}.bind(this));return this};Tone.Source.prototype.unsync=function(){this._synced=false;Tone.Transport.off("start stop pause loopEnd loopStart");for(var i=0;i<this._scheduled.length;i++){var id=this._scheduled[i];Tone.Transport.clear(id)}this._scheduled=[];this._state.cancel(0);return this};Tone.Source.prototype.dispose=function(){Tone.prototype.dispose.call(this);this.unsync();this._scheduled=null;this._writable("volume");this._volume.dispose();this._volume=null;this.volume=null;this._state.dispose();this._state=null};return Tone.Source});Module(function(Tone){Tone.Oscillator=function(){var options=this.optionsObject(arguments,["frequency","type"],Tone.Oscillator.defaults);Tone.Source.call(this,options);this._oscillator=null;this.frequency=new Tone.Signal(options.frequency,Tone.Type.Frequency);this.detune=new Tone.Signal(options.detune,Tone.Type.Cents);this._wave=null;this._partials=this.defaultArg(options.partials,[1]);this._phase=options.phase;this._type=null;this.type=options.type;this.phase=this._phase;this._readOnly(["frequency","detune"])};Tone.extend(Tone.Oscillator,Tone.Source);Tone.Oscillator.defaults={type:"sine",frequency:440,detune:0,phase:0,partials:[]};Tone.Oscillator.Type={Sine:"sine",Triangle:"triangle",Sawtooth:"sawtooth",Square:"square",Custom:"custom"};Tone.Oscillator.prototype._start=function(time){this._oscillator=this.context.createOscillator();this._oscillator.setPeriodicWave(this._wave);this._oscillator.connect(this.output);this.frequency.connect(this._oscillator.frequency);this.detune.connect(this._oscillator.detune);this._oscillator.start(this.toSeconds(time))};Tone.Oscillator.prototype._stop=function(time){if(this._oscillator){this._oscillator.stop(this.toSeconds(time));this._oscillator=null}return this};Tone.Oscillator.prototype.syncFrequency=function(){Tone.Transport.syncSignal(this.frequency);return this};Tone.Oscillator.prototype.unsyncFrequency=function(){Tone.Transport.unsyncSignal(this.frequency);return this};Object.defineProperty(Tone.Oscillator.prototype,"type",{get:function(){return this._type},set:function(type){var coefs=this._getRealImaginary(type,this._phase);var periodicWave=this.context.createPeriodicWave(coefs[0],coefs[1]);this._wave=periodicWave;if(this._oscillator!==null){this._oscillator.setPeriodicWave(this._wave)}this._type=type}});Tone.Oscillator.prototype._getRealImaginary=function(type,phase){var fftSize=4096;var periodicWaveSize=fftSize/2;var real=new Float32Array(periodicWaveSize);var imag=new Float32Array(periodicWaveSize);var partialCount=1;if(type===Tone.Oscillator.Type.Custom){partialCount=this._partials.length+1;periodicWaveSize=partialCount}else{var partial=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(type);if(partial){partialCount=parseInt(partial[2])+1;type=partial[1];partialCount=Math.max(partialCount,2);periodicWaveSize=partialCount}}for(var n=1;n<periodicWaveSize;++n){var piFactor=2/(n*Math.PI);var b;switch(type){case Tone.Oscillator.Type.Sine:b=n<=partialCount?1:0;break;case Tone.Oscillator.Type.Square:b=n&1?2*piFactor:0;break;case Tone.Oscillator.Type.Sawtooth:b=piFactor*(n&1?1:-1);break;case Tone.Oscillator.Type.Triangle:if(n&1){b=2*(piFactor*piFactor)*(n-1>>1&1?-1:1)}else{b=0}break;case Tone.Oscillator.Type.Custom:b=this._partials[n-1];break;default:throw new TypeError("Tone.Oscillator: invalid type: "+type)}if(b!==0){real[n]=-b*Math.sin(phase*n);imag[n]=b*Math.cos(phase*n)}else{real[n]=0;imag[n]=0}}return[real,imag]};Tone.Oscillator.prototype._inverseFFT=function(real,imag,phase){var sum=0;var len=real.length;for(var i=0;i<len;i++){sum+=real[i]*Math.cos(i*phase)+imag[i]*Math.sin(i*phase)}return sum};Tone.Oscillator.prototype._getInitialValue=function(){var coefs=this._getRealImaginary(this._type,0);var real=coefs[0];var imag=coefs[1];var maxValue=0;var twoPi=Math.PI*2;for(var i=0;i<8;i++){maxValue=Math.max(this._inverseFFT(real,imag,i/8*twoPi),maxValue)}return-this._inverseFFT(real,imag,this._phase)/maxValue};Object.defineProperty(Tone.Oscillator.prototype,"partials",{get:function(){if(this._type!==Tone.Oscillator.Type.Custom){return[]}else{return this._partials}},set:function(partials){this._partials=partials;this.type=Tone.Oscillator.Type.Custom}});Object.defineProperty(Tone.Oscillator.prototype,"phase",{get:function(){return this._phase*(180/Math.PI)},set:function(phase){this._phase=phase*Math.PI/180;this.type=this._type}});Tone.Oscillator.prototype.dispose=function(){Tone.Source.prototype.dispose.call(this);if(this._oscillator!==null){this._oscillator.disconnect();this._oscillator=null}this._wave=null;this._writable(["frequency","detune"]);this.frequency.dispose();this.frequency=null;this.detune.dispose();this.detune=null;this._partials=null;return this};return Tone.Oscillator});Module(function(Tone){Tone.Zero=function(){this._gain=this.input=this.output=new Tone.Gain;Tone.Zero._zeros.connect(this._gain)};Tone.extend(Tone.Zero);Tone.Zero.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._gain.dispose();this._gain=null;return this};Tone.Zero._zeros=null;Tone._initAudioContext(function(audioContext){var buffer=audioContext.createBuffer(1,128,audioContext.sampleRate);var arr=buffer.getChannelData(0);for(var i=0;i<arr.length;i++){arr[i]=0}Tone.Zero._zeros=audioContext.createBufferSource();Tone.Zero._zeros.channelCount=1;Tone.Zero._zeros.channelCountMode="explicit";Tone.Zero._zeros.buffer=buffer;Tone.Zero._zeros.loop=true;Tone.Zero._zeros.start(0);Tone.Zero._zeros.noGC()});return Tone.Zero});Module(function(Tone){Tone.LFO=function(){var options=this.optionsObject(arguments,["frequency","min","max"],Tone.LFO.defaults);this._oscillator=new Tone.Oscillator({frequency:options.frequency,type:options.type});this.frequency=this._oscillator.frequency;this.amplitude=this._oscillator.volume;this.amplitude.units=Tone.Type.NormalRange;this.amplitude.value=options.amplitude;this._stoppedSignal=new Tone.Signal(0,Tone.Type.AudioRange);this._zeros=new Tone.Zero;this._stoppedValue=0;this._a2g=new Tone.AudioToGain;this._scaler=this.output=new Tone.Scale(options.min,options.max);this._units=Tone.Type.Default;this.units=options.units;this._oscillator.chain(this._a2g,this._scaler);this._zeros.connect(this._a2g);this._stoppedSignal.connect(this._a2g);this._readOnly(["amplitude","frequency"]);this.phase=options.phase};Tone.extend(Tone.LFO,Tone.Oscillator);Tone.LFO.defaults={type:"sine",min:0,max:1,phase:0,frequency:"4n",amplitude:1,units:Tone.Type.Default};Tone.LFO.prototype.start=function(time){time=this.toSeconds(time);this._stoppedSignal.setValueAtTime(0,time);this._oscillator.start(time);return this};Tone.LFO.prototype.stop=function(time){time=this.toSeconds(time);this._stoppedSignal.setValueAtTime(this._stoppedValue,time);this._oscillator.stop(time);return this};Tone.LFO.prototype.sync=function(){this._oscillator.sync();this._oscillator.syncFrequency();return this};Tone.LFO.prototype.unsync=function(){this._oscillator.unsync();this._oscillator.unsyncFrequency();return this};Object.defineProperty(Tone.LFO.prototype,"min",{get:function(){return this._toUnits(this._scaler.min)},set:function(min){min=this._fromUnits(min);this._scaler.min=min}});Object.defineProperty(Tone.LFO.prototype,"max",{get:function(){return this._toUnits(this._scaler.max)},set:function(max){max=this._fromUnits(max);this._scaler.max=max}});Object.defineProperty(Tone.LFO.prototype,"type",{get:function(){return this._oscillator.type},set:function(type){this._oscillator.type=type;this._stoppedValue=this._oscillator._getInitialValue();this._stoppedSignal.value=this._stoppedValue}});Object.defineProperty(Tone.LFO.prototype,"phase",{get:function(){return this._oscillator.phase},set:function(phase){this._oscillator.phase=phase;this._stoppedValue=this._oscillator._getInitialValue();this._stoppedSignal.value=this._stoppedValue}});Object.defineProperty(Tone.LFO.prototype,"units",{get:function(){return this._units},set:function(val){var currentMin=this.min;var currentMax=this.max;this._units=val;this.min=currentMin;this.max=currentMax}});Object.defineProperty(Tone.LFO.prototype,"mute",{get:function(){return this._oscillator.mute},set:function(mute){this._oscillator.mute=mute}});Object.defineProperty(Tone.LFO.prototype,"state",{get:function(){return this._oscillator.state}});Tone.LFO.prototype.connect=function(node){if(node.constructor===Tone.Signal||node.constructor===Tone.Param||node.constructor===Tone.TimelineSignal){this.convert=node.convert;this.units=node.units}Tone.Signal.prototype.connect.apply(this,arguments);return this};Tone.LFO.prototype._fromUnits=Tone.Param.prototype._fromUnits;Tone.LFO.prototype._toUnits=Tone.Param.prototype._toUnits;Tone.LFO.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._writable(["amplitude","frequency"]);this._oscillator.dispose();this._oscillator=null;this._stoppedSignal.dispose();this._stoppedSignal=null;this._zeros.dispose();this._zeros=null;this._scaler.dispose();this._scaler=null;this._a2g.dispose();this._a2g=null;this.frequency=null;this.amplitude=null;return this};return Tone.LFO});Module(function(Tone){Tone.Limiter=function(){var options=this.optionsObject(arguments,["threshold"],Tone.Limiter.defaults);this._compressor=this.input=this.output=new Tone.Compressor({attack:.001,decay:.001,threshold:options.threshold});this.threshold=this._compressor.threshold;this._readOnly("threshold")};Tone.extend(Tone.Limiter);Tone.Limiter.defaults={threshold:-12};Tone.Limiter.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._compressor.dispose();this._compressor=null;this._writable("threshold");this.threshold=null;return this};return Tone.Limiter});Module(function(Tone){Tone.LowpassCombFilter=function(){this.createInsOuts(1,1);var options=this.optionsObject(arguments,["delayTime","resonance","dampening"],Tone.LowpassCombFilter.defaults);this._delay=this.input=new Tone.Delay(options.delayTime);this.delayTime=this._delay.delayTime;this._lowpass=this.output=this.context.createBiquadFilter();this._lowpass.Q.value=-3.0102999566398125;this._lowpass.type="lowpass";this.dampening=new Tone.Param({param:this._lowpass.frequency,units:Tone.Type.Frequency,value:options.dampening});this._feedback=new Tone.Gain(options.resonance,Tone.Type.NormalRange);this.resonance=this._feedback.gain;this._delay.chain(this._lowpass,this._feedback,this._delay);this._readOnly(["dampening","resonance","delayTime"])};Tone.extend(Tone.LowpassCombFilter);Tone.LowpassCombFilter.defaults={delayTime:.1,resonance:.5,dampening:3e3};Tone.LowpassCombFilter.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._writable(["dampening","resonance","delayTime"]);this.dampening.dispose();this.dampening=null;this.resonance.dispose();this.resonance=null;this._delay.dispose();this._delay=null;this.delayTime=null;this._lowpass.disconnect();this._lowpass=null;this._feedback.disconnect();this._feedback=null;return this};return Tone.LowpassCombFilter});Module(function(Tone){Tone.Merge=function(){this.createInsOuts(2,0);this.left=this.input[0]=new Tone.Gain;this.right=this.input[1]=new Tone.Gain;this._merger=this.output=this.context.createChannelMerger(2);this.left.connect(this._merger,0,0);this.right.connect(this._merger,0,1);this.left.channelCount=1;this.right.channelCount=1;this.left.channelCountMode="explicit";this.right.channelCountMode="explicit"};Tone.extend(Tone.Merge);Tone.Merge.prototype.dispose=function(){Tone.prototype.dispose.call(this);this.left.dispose();this.left=null;this.right.dispose();this.right=null;this._merger.disconnect();this._merger=null;return this};return Tone.Merge});Module(function(Tone){Tone.Meter=function(){var options=this.optionsObject(arguments,["type","smoothing"],Tone.Meter.defaults);this.type=options.type;this.input=this.output=this._analyser=new Tone.Analyser("waveform",512);this._analyser.returnType="float";this.smoothing=options.smoothing;this._lastValue=0};Tone.extend(Tone.Meter);Tone.Meter.Type={Level:"level",Signal:"signal"};Tone.Meter.defaults={smoothing:.8,type:Tone.Meter.Type.Level};Object.defineProperty(Tone.Meter.prototype,"value",{get:function(){var signal=this._analyser.analyse();if(this.type===Tone.Meter.Type.Level){var sum=0;for(var i=0;i<signal.length;i++){sum+=Math.pow(signal[i],2)}var rms=Math.sqrt(sum/signal.length);rms=Math.max(rms,this._lastValue*this.smoothing);this._lastValue=rms;var unity=.35;var val=rms/unity;return Math.sqrt(val)}else{return signal[0]}}});Tone.Meter.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._analyser.dispose();this._analyser=null;return this};return Tone.Meter});Module(function(Tone){Tone.Split=function(){this.createInsOuts(0,2);this._splitter=this.input=this.context.createChannelSplitter(2);this.left=this.output[0]=new Tone.Gain;this.right=this.output[1]=new Tone.Gain;this._splitter.connect(this.left,0,0);this._splitter.connect(this.right,1,0)};Tone.extend(Tone.Split);Tone.Split.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._splitter.disconnect();this.left.dispose();this.left=null;this.right.dispose();this.right=null;this._splitter=null;return this};return Tone.Split});Module(function(Tone){Tone.MidSideSplit=function(){this.createInsOuts(0,2);this._split=this.input=new Tone.Split;this.mid=this.output[0]=new Tone.Expr("($0 + $1) * $2");this.side=this.output[1]=new Tone.Expr("($0 - $1) * $2");this._split.connect(this.mid,0,0);this._split.connect(this.mid,1,1);this._split.connect(this.side,0,0);this._split.connect(this.side,1,1);sqrtTwo.connect(this.mid,0,2);sqrtTwo.connect(this.side,0,2)};Tone.extend(Tone.MidSideSplit);var sqrtTwo=null;Tone._initAudioContext(function(){sqrtTwo=new Tone.Signal(1/Math.sqrt(2))});Tone.MidSideSplit.prototype.dispose=function(){Tone.prototype.dispose.call(this);this.mid.dispose();this.mid=null;this.side.dispose();this.side=null;this._split.dispose();this._split=null;return this};return Tone.MidSideSplit});Module(function(Tone){Tone.MidSideMerge=function(){this.createInsOuts(2,0);this.mid=this.input[0]=new Tone.Gain;this._left=new Tone.Expr("($0 + $1) * $2");this.side=this.input[1]=new Tone.Gain;this._right=new Tone.Expr("($0 - $1) * $2");this._merge=this.output=new Tone.Merge;this.mid.connect(this._left,0,0);this.side.connect(this._left,0,1);this.mid.connect(this._right,0,0);this.side.connect(this._right,0,1);this._left.connect(this._merge,0,0);this._right.connect(this._merge,0,1);sqrtTwo.connect(this._left,0,2);sqrtTwo.connect(this._right,0,2)};Tone.extend(Tone.MidSideMerge);var sqrtTwo=null;Tone._initAudioContext(function(){sqrtTwo=new Tone.Signal(1/Math.sqrt(2))});Tone.MidSideMerge.prototype.dispose=function(){Tone.prototype.dispose.call(this);this.mid.dispose();this.mid=null;this.side.dispose();this.side=null;this._left.dispose();this._left=null;this._right.dispose();this._right=null;this._merge.dispose();this._merge=null;return this};return Tone.MidSideMerge});Module(function(Tone){Tone.MidSideCompressor=function(options){options=this.defaultArg(options,Tone.MidSideCompressor.defaults);this._midSideSplit=this.input=new Tone.MidSideSplit;this._midSideMerge=this.output=new Tone.MidSideMerge;this.mid=new Tone.Compressor(options.mid);this.side=new Tone.Compressor(options.side);this._midSideSplit.mid.chain(this.mid,this._midSideMerge.mid);this._midSideSplit.side.chain(this.side,this._midSideMerge.side);this._readOnly(["mid","side"])};Tone.extend(Tone.MidSideCompressor);Tone.MidSideCompressor.defaults={mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},side:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10}};Tone.MidSideCompressor.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._writable(["mid","side"]);this.mid.dispose();this.mid=null;this.side.dispose();this.side=null;this._midSideSplit.dispose();this._midSideSplit=null;this._midSideMerge.dispose();this._midSideMerge=null;return this};return Tone.MidSideCompressor});Module(function(Tone){Tone.Mono=function(){this.createInsOuts(1,0);this._merge=this.output=new Tone.Merge;this.input.connect(this._merge,0,0);this.input.connect(this._merge,0,1);this.input.gain.value=this.dbToGain(-10)};Tone.extend(Tone.Mono);Tone.Mono.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._merge.dispose();this._merge=null;return this};return Tone.Mono});Module(function(Tone){Tone.MultibandCompressor=function(options){options=this.defaultArg(arguments,Tone.MultibandCompressor.defaults);this._splitter=this.input=new Tone.MultibandSplit({lowFrequency:options.lowFrequency,highFrequency:options.highFrequency});this.lowFrequency=this._splitter.lowFrequency;this.highFrequency=this._splitter.highFrequency;this.output=new Tone.Gain;this.low=new Tone.Compressor(options.low);this.mid=new Tone.Compressor(options.mid);this.high=new Tone.Compressor(options.high);this._splitter.low.chain(this.low,this.output);this._splitter.mid.chain(this.mid,this.output);this._splitter.high.chain(this.high,this.output);this._readOnly(["high","mid","low","highFrequency","lowFrequency"])};Tone.extend(Tone.MultibandCompressor);Tone.MultibandCompressor.defaults={low:Tone.Compressor.defaults,mid:Tone.Compressor.defaults,high:Tone.Compressor.defaults,lowFrequency:250,highFrequency:2e3};Tone.MultibandCompressor.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._splitter.dispose();this._writable(["high","mid","low","highFrequency","lowFrequency"]);this.low.dispose();this.mid.dispose();this.high.dispose();this._splitter=null;this.low=null;this.mid=null;this.high=null;this.lowFrequency=null;this.highFrequency=null;return this};return Tone.MultibandCompressor});Module(function(Tone){Tone.Panner=function(initialPan){if(this._hasStereoPanner){this._panner=this.input=this.output=this.context.createStereoPanner();this.pan=this._panner.pan}else{this._crossFade=new Tone.CrossFade;this._merger=this.output=new Tone.Merge;this._splitter=this.input=new Tone.Split;this.pan=new Tone.Signal(0,Tone.Type.AudioRange);this._zero=new Tone.Zero;this._a2g=new Tone.AudioToGain;this._zero.connect(this._a2g);this.pan.chain(this._a2g,this._crossFade.fade);this._splitter.connect(this._crossFade,0,0);this._splitter.connect(this._crossFade,1,1);this._crossFade.a.connect(this._merger,0,0);this._crossFade.b.connect(this._merger,0,1)}this.pan.value=this.defaultArg(initialPan,0);this._readOnly("pan")};Tone.extend(Tone.Panner);Tone.Panner.prototype._hasStereoPanner=Tone.prototype.isFunction(Tone.context.createStereoPanner);Tone.Panner.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._writable("pan");if(this._hasStereoPanner){this._panner.disconnect();this._panner=null;this.pan=null}else{this._zero.dispose();this._zero=null;this._crossFade.dispose();this._crossFade=null;this._splitter.dispose();this._splitter=null;this._merger.dispose();this._merger=null;this.pan.dispose();this.pan=null;this._a2g.dispose();this._a2g=null}return this};return Tone.Panner});Module(function(Tone){Tone.Panner3D=function(){var options=this.optionsObject(arguments,["positionX","positionY","positionZ"],Tone.Panner3D.defaults);this._panner=this.input=this.output=this.context.createPanner();this._panner.panningModel=options.panningModel;this._panner.maxDistance=options.maxDistance;this._panner.distanceModel=options.distanceModel;this._panner.coneOuterGain=options.coneOuterGain;this._panner.coneOuterAngle=options.coneOuterAngle;this._panner.coneInnerAngle=options.coneInnerAngle;this._panner.refDistance=options.refDistance;this._panner.rolloffFactor=options.rolloffFactor;this._orientation=[options.orientationX,options.orientationY,options.orientationZ];this._position=[options.positionX,options.positionY,options.positionZ];this.orientationX=options.orientationX;this.orientationY=options.orientationY;this.orientationZ=options.orientationZ;this.positionX=options.positionX;this.positionY=options.positionY;
this.positionZ=options.positionZ};Tone.extend(Tone.Panner3D);Tone.Panner3D.defaults={positionX:0,positionY:0,positionZ:0,orientationX:0,orientationY:0,orientationZ:0,panningModel:"equalpower",maxDistance:1e4,distanceModel:"inverse",coneOuterGain:0,coneOuterAngle:360,coneInnerAngle:360,refDistance:1,rolloffFactor:1};Tone.Panner3D.prototype._rampTimeConstant=.01;Tone.Panner3D.prototype.setPosition=function(x,y,z){if(this._panner.positionX){var now=this.now();this._panner.positionX.setTargetAtTime(x,now,this._rampTimeConstant);this._panner.positionY.setTargetAtTime(y,now,this._rampTimeConstant);this._panner.positionZ.setTargetAtTime(z,now,this._rampTimeConstant)}else{this._panner.setPosition(x,y,z)}this._position=Array.prototype.slice.call(arguments);return this};Tone.Panner3D.prototype.setOrientation=function(x,y,z){if(this._panner.orientationX){var now=this.now();this._panner.orientationX.setTargetAtTime(x,now,this._rampTimeConstant);this._panner.orientationY.setTargetAtTime(y,now,this._rampTimeConstant);this._panner.orientationZ.setTargetAtTime(z,now,this._rampTimeConstant)}else{this._panner.setOrientation(x,y,z)}this._orientation=Array.prototype.slice.call(arguments);return this};Object.defineProperty(Tone.Panner3D.prototype,"positionX",{set:function(pos){this._position[0]=pos;this.setPosition.apply(this,this._position)},get:function(){return this._position[0]}});Object.defineProperty(Tone.Panner3D.prototype,"positionY",{set:function(pos){this._position[1]=pos;this.setPosition.apply(this,this._position)},get:function(){return this._position[1]}});Object.defineProperty(Tone.Panner3D.prototype,"positionZ",{set:function(pos){this._position[2]=pos;this.setPosition.apply(this,this._position)},get:function(){return this._position[2]}});Object.defineProperty(Tone.Panner3D.prototype,"orientationX",{set:function(pos){this._orientation[0]=pos;this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[0]}});Object.defineProperty(Tone.Panner3D.prototype,"orientationY",{set:function(pos){this._orientation[1]=pos;this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[1]}});Object.defineProperty(Tone.Panner3D.prototype,"orientationZ",{set:function(pos){this._orientation[2]=pos;this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[2]}});Tone.Panner3D._aliasProperty=function(prop){Object.defineProperty(Tone.Panner3D.prototype,prop,{set:function(val){this._panner[prop]=val},get:function(){return this._panner[prop]}})};Tone.Panner3D._aliasProperty("panningModel");Tone.Panner3D._aliasProperty("refDistance");Tone.Panner3D._aliasProperty("rolloffFactor");Tone.Panner3D._aliasProperty("distanceModel");Tone.Panner3D._aliasProperty("coneInnerAngle");Tone.Panner3D._aliasProperty("coneOuterAngle");Tone.Panner3D._aliasProperty("coneOuterGain");Tone.Panner3D._aliasProperty("maxDistance");Tone.Panner3D.prototype.dispose=function(){this._panner.disconnect();this._panner=null;this._orientation=null;this._position=null;return this};return Tone.Panner3D});Module(function(Tone){Tone.PanVol=function(){var options=this.optionsObject(arguments,["pan","volume"],Tone.PanVol.defaults);this._panner=this.input=new Tone.Panner(options.pan);this.pan=this._panner.pan;this._volume=this.output=new Tone.Volume(options.volume);this.volume=this._volume.volume;this._panner.connect(this._volume);this._readOnly(["pan","volume"])};Tone.extend(Tone.PanVol);Tone.PanVol.defaults={pan:.5,volume:0};Tone.PanVol.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._writable(["pan","volume"]);this._panner.dispose();this._panner=null;this.pan=null;this._volume.dispose();this._volume=null;this.volume=null;return this};return Tone.PanVol});Module(function(Tone){Tone.CtrlInterpolate=function(){var options=this.optionsObject(arguments,["values","index"],Tone.CtrlInterpolate.defaults);this.values=options.values;this.index=options.index};Tone.extend(Tone.CtrlInterpolate);Tone.CtrlInterpolate.defaults={index:0,values:[]};Object.defineProperty(Tone.CtrlInterpolate.prototype,"value",{get:function(){var index=this.index;index=Math.min(index,this.values.length-1);var lowerPosition=Math.floor(index);var lower=this.values[lowerPosition];var upper=this.values[Math.ceil(index)];return this._interpolate(index-lowerPosition,lower,upper)}});Tone.CtrlInterpolate.prototype._interpolate=function(index,lower,upper){if(this.isArray(lower)){var retArray=[];for(var i=0;i<lower.length;i++){retArray[i]=this._interpolate(index,lower[i],upper[i])}return retArray}else if(this.isObject(lower)){var retObj={};for(var attr in lower){retObj[attr]=this._interpolate(index,lower[attr],upper[attr])}return retObj}else{lower=this._toNumber(lower);upper=this._toNumber(upper);return(1-index)*lower+index*upper}};Tone.CtrlInterpolate.prototype._toNumber=function(val){if(this.isNumber(val)){return val}else{return this.toSeconds(val)}};Tone.CtrlInterpolate.prototype.dispose=function(){this.values=null};return Tone.CtrlInterpolate});Module(function(Tone){Tone.CtrlMarkov=function(values,initial){this.values=this.defaultArg(values,{});this.value=this.defaultArg(initial,Object.keys(this.values)[0])};Tone.extend(Tone.CtrlMarkov);Tone.CtrlMarkov.prototype.next=function(){if(this.values.hasOwnProperty(this.value)){var next=this.values[this.value];if(this.isArray(next)){var distribution=this._getProbDistribution(next);var rand=Math.random();var total=0;for(var i=0;i<distribution.length;i++){var dist=distribution[i];if(rand>total&&rand<total+dist){var chosen=next[i];if(this.isObject(chosen)){this.value=chosen.value}else{this.value=chosen}}total+=dist}}else{this.value=next}}return this.value};Tone.CtrlMarkov.prototype._getProbDistribution=function(options){var distribution=[];var total=0;var needsNormalizing=false;for(var i=0;i<options.length;i++){var option=options[i];if(this.isObject(option)){needsNormalizing=true;distribution[i]=option.probability}else{distribution[i]=1/options.length}total+=distribution[i]}if(needsNormalizing){for(var j=0;j<distribution.length;j++){distribution[j]=distribution[j]/total}}return distribution};Tone.CtrlMarkov.prototype.dispose=function(){this.values=null};return Tone.CtrlMarkov});Module(function(Tone){Tone.CtrlPattern=function(){var options=this.optionsObject(arguments,["values","type"],Tone.CtrlPattern.defaults);this.values=options.values;this.index=0;this._type=null;this._shuffled=null;this._direction=null;this.type=options.type};Tone.extend(Tone.CtrlPattern);Tone.CtrlPattern.Type={Up:"up",Down:"down",UpDown:"upDown",DownUp:"downUp",AlternateUp:"alternateUp",AlternateDown:"alternateDown",Random:"random",RandomWalk:"randomWalk",RandomOnce:"randomOnce"};Tone.CtrlPattern.defaults={type:Tone.CtrlPattern.Type.Up,values:[]};Object.defineProperty(Tone.CtrlPattern.prototype,"value",{get:function(){if(this.values.length===0){return}else if(this.values.length===1){return this.values[0]}this.index=Math.min(this.index,this.values.length-1);var val=this.values[this.index];if(this.type===Tone.CtrlPattern.Type.RandomOnce){if(this.values.length!==this._shuffled.length){this._shuffleValues()}val=this.values[this._shuffled[this.index]]}return val}});Object.defineProperty(Tone.CtrlPattern.prototype,"type",{get:function(){return this._type},set:function(type){this._type=type;this._shuffled=null;if(this._type===Tone.CtrlPattern.Type.Up||this._type===Tone.CtrlPattern.Type.UpDown||this._type===Tone.CtrlPattern.Type.RandomOnce||this._type===Tone.CtrlPattern.Type.AlternateUp){this.index=0}else if(this._type===Tone.CtrlPattern.Type.Down||this._type===Tone.CtrlPattern.Type.DownUp||this._type===Tone.CtrlPattern.Type.AlternateDown){this.index=this.values.length-1}if(this._type===Tone.CtrlPattern.Type.UpDown||this._type===Tone.CtrlPattern.Type.AlternateUp){this._direction=Tone.CtrlPattern.Type.Up}else if(this._type===Tone.CtrlPattern.Type.DownUp||this._type===Tone.CtrlPattern.Type.AlternateDown){this._direction=Tone.CtrlPattern.Type.Down}if(this._type===Tone.CtrlPattern.Type.RandomOnce){this._shuffleValues()}else if(this._type===Tone.CtrlPattern.Random){this.index=Math.floor(Math.random()*this.values.length)}}});Tone.CtrlPattern.prototype.next=function(){var type=this.type;if(type===Tone.CtrlPattern.Type.Up){this.index++;if(this.index>=this.values.length){this.index=0}}else if(type===Tone.CtrlPattern.Type.Down){this.index--;if(this.index<0){this.index=this.values.length-1}}else if(type===Tone.CtrlPattern.Type.UpDown||type===Tone.CtrlPattern.Type.DownUp){if(this._direction===Tone.CtrlPattern.Type.Up){this.index++}else{this.index--}if(this.index<0){this.index=1;this._direction=Tone.CtrlPattern.Type.Up}else if(this.index>=this.values.length){this.index=this.values.length-2;this._direction=Tone.CtrlPattern.Type.Down}}else if(type===Tone.CtrlPattern.Type.Random){this.index=Math.floor(Math.random()*this.values.length)}else if(type===Tone.CtrlPattern.Type.RandomWalk){if(Math.random()<.5){this.index--;this.index=Math.max(this.index,0)}else{this.index++;this.index=Math.min(this.index,this.values.length-1)}}else if(type===Tone.CtrlPattern.Type.RandomOnce){this.index++;if(this.index>=this.values.length){this.index=0;this._shuffleValues()}}else if(type===Tone.CtrlPattern.Type.AlternateUp){if(this._direction===Tone.CtrlPattern.Type.Up){this.index+=2;this._direction=Tone.CtrlPattern.Type.Down}else{this.index-=1;this._direction=Tone.CtrlPattern.Type.Up}if(this.index>=this.values.length){this.index=0;this._direction=Tone.CtrlPattern.Type.Up}}else if(type===Tone.CtrlPattern.Type.AlternateDown){if(this._direction===Tone.CtrlPattern.Type.Up){this.index+=1;this._direction=Tone.CtrlPattern.Type.Down}else{this.index-=2;this._direction=Tone.CtrlPattern.Type.Up}if(this.index<0){this.index=this.values.length-1;this._direction=Tone.CtrlPattern.Type.Down}}return this.value};Tone.CtrlPattern.prototype._shuffleValues=function(){var copy=[];this._shuffled=[];for(var i=0;i<this.values.length;i++){copy[i]=i}while(copy.length>0){var randVal=copy.splice(Math.floor(copy.length*Math.random()),1);this._shuffled.push(randVal[0])}};Tone.CtrlPattern.prototype.dispose=function(){this._shuffled=null;this.values=null};return Tone.CtrlPattern});Module(function(Tone){Tone.CtrlRandom=function(){var options=this.optionsObject(arguments,["min","max"],Tone.CtrlRandom.defaults);this.min=options.min;this.max=options.max;this.integer=options.integer};Tone.extend(Tone.CtrlRandom);Tone.CtrlRandom.defaults={min:0,max:1,integer:false};Object.defineProperty(Tone.CtrlRandom.prototype,"value",{get:function(){var min=this.toSeconds(this.min);var max=this.toSeconds(this.max);var rand=Math.random();var val=rand*min+(1-rand)*max;if(this.integer){val=Math.floor(val)}return val}});return Tone.CtrlRandom});Module(function(Tone){Tone.Buffer=function(){var options=this.optionsObject(arguments,["url","onload","onerror"],Tone.Buffer.defaults);this._buffer=null;this._reversed=options.reverse;this._xhr=null;if(options.url instanceof AudioBuffer||options.url instanceof Tone.Buffer){this.set(options.url);if(options.onload){options.onload(this)}}else if(this.isString(options.url)){this.load(options.url,options.onload,options.onerror)}};Tone.extend(Tone.Buffer);Tone.Buffer.defaults={url:undefined,reverse:false};Tone.Buffer.prototype.set=function(buffer){if(buffer instanceof Tone.Buffer){this._buffer=buffer.get()}else{this._buffer=buffer}return this};Tone.Buffer.prototype.get=function(){return this._buffer};Tone.Buffer.prototype.load=function(url,onload,onerror){var promise=new Promise(function(load,error){this._xhr=Tone.Buffer.load(url,function(buff){this._xhr=null;this.set(buff);load(this);if(onload){onload(this)}}.bind(this),function(err){this._xhr=null;error(err);if(onerror){onerror(err)}}.bind(this))}.bind(this));return promise};Tone.Buffer.prototype.dispose=function(){Tone.Emitter.prototype.dispose.call(this);this._buffer=null;if(this._xhr){Tone.Buffer._currentDownloads--;this._xhr.abort();this._xhr=null}return this};Object.defineProperty(Tone.Buffer.prototype,"loaded",{get:function(){return this.length>0}});Object.defineProperty(Tone.Buffer.prototype,"duration",{get:function(){if(this._buffer){return this._buffer.duration}else{return 0}}});Object.defineProperty(Tone.Buffer.prototype,"length",{get:function(){if(this._buffer){return this._buffer.length}else{return 0}}});Object.defineProperty(Tone.Buffer.prototype,"numberOfChannels",{get:function(){if(this._buffer){return this._buffer.numberOfChannels}else{return 0}}});Tone.Buffer.prototype.fromArray=function(array){var isMultidimensional=array[0].length>0;var channels=isMultidimensional?array.length:1;var len=isMultidimensional?array[0].length:array.length;var buffer=this.context.createBuffer(channels,len,this.context.sampleRate);if(!isMultidimensional&&channels===1){array=[array]}for(var c=0;c<channels;c++){if(this.isFunction(buffer.copyToChannel)){buffer.copyToChannel(array[c],c)}else{var channel=buffer.getChannelData(c);var channelArray=array[c];for(var i=0;i<channelArray.length;i++){channel[i]=channelArray[i]}}}this._buffer=buffer;return this};Tone.Buffer.prototype.toArray=function(channel){if(this.isNumber(channel)){return this._buffer.getChannelData(channel)}else{var ret=[];for(var c=0;c<this.numberOfChannels;c++){ret[c]=new Float32Array(this.length);if(this.isFunction(this._buffer.copyFromChannel)){this._buffer.copyFromChannel(ret[c],c)}else{var channelData=this._buffer.getChannelData(c);var retArray=ret[c];for(var i=0;i<channelData.length;i++){retArray[i]=channelData[i]}}}if(ret.length===1){return ret[0]}else{return ret}}};Tone.Buffer.prototype.slice=function(start,end){end=this.defaultArg(end,this.duration);var startSamples=Math.floor(this.context.sampleRate*this.toSeconds(start));var endSamples=Math.floor(this.context.sampleRate*this.toSeconds(end));var replacement=[];for(var i=0;i<this.numberOfChannels;i++){replacement[i]=this.toArray(i).slice(startSamples,endSamples)}var retBuffer=(new Tone.Buffer).fromArray(replacement);return retBuffer};Tone.Buffer.prototype._reverse=function(){if(this.loaded){for(var i=0;i<this._buffer.numberOfChannels;i++){Array.prototype.reverse.call(this._buffer.getChannelData(i))}}return this};Object.defineProperty(Tone.Buffer.prototype,"reverse",{get:function(){return this._reversed},set:function(rev){if(this._reversed!==rev){this._reversed=rev;this._reverse()}}});Tone.Emitter.mixin(Tone.Buffer);Tone.Buffer._downloadQueue=[];Tone.Buffer._currentDownloads=0;Tone.Buffer.baseUrl="";Tone.Buffer.load=function(url,onload,onerror){onload=onload||Tone.noOp;function onError(e){if(onerror){onerror(e)}else{throw new Error(e)}}function onProgress(){var totalProgress=0;for(var i=0;i<Tone.Buffer._downloadQueue.length;i++){totalProgress+=Tone.Buffer._downloadQueue[i].progress}Tone.Buffer.emit("progress",totalProgress/Tone.Buffer._downloadQueue.length)}var request=new XMLHttpRequest;request.open("GET",Tone.Buffer.baseUrl+url,true);request.responseType="arraybuffer";request.progress=0;Tone.Buffer._currentDownloads++;Tone.Buffer._downloadQueue.push(request);request.addEventListener("load",function(){if(request.status===200){Tone.context.decodeAudioData(request.response,function(buff){request.progress=1;onProgress();onload(buff);Tone.Buffer._currentDownloads--;if(Tone.Buffer._currentDownloads===0){Tone.Buffer._downloadQueue=[];Tone.Buffer.emit("load")}},function(){onError("Tone.Buffer: could not decode audio data: "+url)})}else{onError("Tone.Buffer: could not locate file: "+url)}});request.addEventListener("error",onError);request.addEventListener("progress",function(event){if(event.lengthComputable){request.progress=event.loaded/event.total*.95;onProgress()}});request.send();return request};Tone.Buffer.stopDownloads=function(){Tone.Buffer._downloadQueue.forEach(function(request){request.abort()});Tone.Buffer._currentDownloads=0;return Tone.Buffer};Tone.Buffer.supportsType=function(url){var extension=url.split(".");extension=extension[extension.length-1];var response=document.createElement("audio").canPlayType("audio/"+extension);return response!==""};return Tone.Buffer});Module(function(Tone){Tone.Buffers=function(urls,onload,baseUrl){this._buffers={};this.baseUrl=this.defaultArg(baseUrl,"");urls=this._flattenUrls(urls);this._loadingCount=0;for(var key in urls){this._loadingCount++;this.add(key,urls[key],this._bufferLoaded.bind(this,onload))}};Tone.extend(Tone.Buffers);Tone.Buffers.prototype.has=function(name){return this._buffers.hasOwnProperty(name)};Tone.Buffers.prototype.get=function(name){if(this.has(name)){return this._buffers[name]}else{throw new Error("Tone.Buffers: no buffer named "+name)}};Tone.Buffers.prototype._bufferLoaded=function(callback){this._loadingCount--;if(this._loadingCount===0&&callback){callback(this)}};Object.defineProperty(Tone.Buffers.prototype,"loaded",{get:function(){var isLoaded=true;for(var buffName in this._buffers){var buff=this.get(buffName);isLoaded=isLoaded&&buff.loaded}return isLoaded}});Tone.Buffers.prototype.add=function(name,url,callback){callback=this.defaultArg(callback,Tone.noOp);if(url instanceof Tone.Buffer){this._buffers[name]=url;callback(this)}else if(url instanceof AudioBuffer){this._buffers[name]=new Tone.Buffer(url);callback(this)}else if(this.isString(url)){this._buffers[name]=new Tone.Buffer(this.baseUrl+url,callback)}return this};Tone.Buffers.prototype._flattenUrls=function(ob){var toReturn={};for(var i in ob){if(!ob.hasOwnProperty(i))continue;if(this.isObject(ob[i])){var flatObject=this._flattenUrls(ob[i]);for(var x in flatObject){if(!flatObject.hasOwnProperty(x))continue;toReturn[i+"."+x]=flatObject[x]}}else{toReturn[i]=ob[i]}}return toReturn};Tone.Buffers.prototype.dispose=function(){for(var name in this._buffers){this._buffers[name].dispose()}this._buffers=null;return this};return Tone.Buffers});Module(function(Tone){var Buses={};Tone.prototype.send=function(channelName,amount){if(!Buses.hasOwnProperty(channelName)){Buses[channelName]=this.context.createGain()}amount=this.defaultArg(amount,0);var sendKnob=new Tone.Gain(amount,Tone.Type.Decibels);this.output.chain(sendKnob,Buses[channelName]);return sendKnob};Tone.prototype.receive=function(channelName,input){if(!Buses.hasOwnProperty(channelName)){Buses[channelName]=this.context.createGain()}if(this.isUndef(input)){input=this.input}Buses[channelName].connect(input);return this};Tone._initAudioContext(function(){Buses={}});return Tone});Module(function(Tone){Tone.Draw=function(){this._events=new Tone.Timeline;this.expiration=.25;this.anticipation=.008;this._boundDrawLoop=this._drawLoop.bind(this);this._drawLoop()};Tone.extend(Tone.Draw);Tone.Draw.prototype.schedule=function(callback,time){this._events.add({callback:callback,time:this.toSeconds(time)});return this};Tone.Draw.prototype.cancel=function(after){this._events.cancel(this.toSeconds(after));return this};Tone.Draw.prototype._drawLoop=function(){requestAnimationFrame(this._boundDrawLoop);var now=Tone.now();while(this._events.length&&this._events.peek().time-this.anticipation<=now){var event=this._events.shift();if(now-event.time<=this.expiration){event.callback()}}};Tone.Draw=new Tone.Draw;return Tone.Draw});Module(function(Tone){Tone.Listener=function(){var options=this.optionsObject(arguments,["positionX","positionY","positionZ"],ListenerConstructor.defaults);this._listener=this.context.listener;this._orientation=[options.forwardX,options.forwardY,options.forwardZ,options.upX,options.upY,options.upZ];this._position=[options.positionX,options.positionY,options.positionZ];this.forwardX=options.forwardX;this.forwardY=options.forwardY;this.forwardZ=options.forwardZ;this.upX=options.upX;this.upY=options.upY;this.upZ=options.upZ;this.positionX=options.positionX;this.positionY=options.positionY;this.positionZ=options.positionZ};Tone.extend(Tone.Listener);Tone.Listener.defaults={positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:1,upX:0,upY:1,upZ:0};Tone.Listener.prototype._rampTimeConstant=.01;Tone.Listener.prototype.setPosition=function(x,y,z){if(this._listener.positionX){var now=this.now();this._listener.positionX.setTargetAtTime(x,now,this._rampTimeConstant);this._listener.positionY.setTargetAtTime(y,now,this._rampTimeConstant);this._listener.positionZ.setTargetAtTime(z,now,this._rampTimeConstant)}else{this._listener.setPosition(x,y,z)}this._position=Array.prototype.slice.call(arguments);return this};Tone.Listener.prototype.setOrientation=function(x,y,z,upX,upY,upZ){if(this._listener.forwardX){var now=this.now();this._listener.forwardX.setTargetAtTime(x,now,this._rampTimeConstant);this._listener.forwardY.setTargetAtTime(y,now,this._rampTimeConstant);this._listener.forwardZ.setTargetAtTime(z,now,this._rampTimeConstant);this._listener.upX.setTargetAtTime(upX,now,this._rampTimeConstant);this._listener.upY.setTargetAtTime(upY,now,this._rampTimeConstant);this._listener.upZ.setTargetAtTime(upZ,now,this._rampTimeConstant)}else{this._listener.setOrientation(x,y,z,upX,upY,upZ)}this._orientation=Array.prototype.slice.call(arguments);return this};Object.defineProperty(Tone.Listener.prototype,"positionX",{set:function(pos){this._position[0]=pos;this.setPosition.apply(this,this._position)},get:function(){return this._position[0]}});Object.defineProperty(Tone.Listener.prototype,"positionY",{set:function(pos){this._position[1]=pos;this.setPosition.apply(this,this._position)},get:function(){return this._position[1]}});Object.defineProperty(Tone.Listener.prototype,"positionZ",{set:function(pos){this._position[2]=pos;this.setPosition.apply(this,this._position)},get:function(){return this._position[2]}});Object.defineProperty(Tone.Listener.prototype,"forwardX",{set:function(pos){this._orientation[0]=pos;this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[0]}});Object.defineProperty(Tone.Listener.prototype,"forwardY",{set:function(pos){this._orientation[1]=pos;this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[1]}});Object.defineProperty(Tone.Listener.prototype,"forwardZ",{set:function(pos){this._orientation[2]=pos;this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[2]}});Object.defineProperty(Tone.Listener.prototype,"upX",{set:function(pos){this._orientation[3]=pos;this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[3]}});Object.defineProperty(Tone.Listener.prototype,"upY",{set:function(pos){this._orientation[4]=pos;this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[4]}});Object.defineProperty(Tone.Listener.prototype,"upZ",{set:function(pos){this._orientation[5]=pos;this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[5]}});Tone.Listener.prototype.dispose=function(){this._listener.disconnect();this._listener=null;this._orientation=null;this._position=null;return this};var ListenerConstructor=Tone.Listener;Tone._initAudioContext(function(){if(typeof Tone.Listener==="function"){Tone.Listener=new Tone.Listener}else{ListenerConstructor.call(Tone.Listener)}});return Tone.Listener});Module(function(Tone){Tone.Effect=function(){this.createInsOuts(1,1);var options=this.optionsObject(arguments,["wet"],Tone.Effect.defaults);this._dryWet=new Tone.CrossFade(options.wet);this.wet=this._dryWet.fade;this.effectSend=new Tone.Gain;this.effectReturn=new Tone.Gain;this.input.connect(this._dryWet.a);this.input.connect(this.effectSend);this.effectReturn.connect(this._dryWet.b);this._dryWet.connect(this.output);this._readOnly(["wet"])};Tone.extend(Tone.Effect);Tone.Effect.defaults={wet:1};Tone.Effect.prototype.connectEffect=function(effect){this.effectSend.chain(effect,this.effectReturn);return this};Tone.Effect.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._dryWet.dispose();this._dryWet=null;this.effectSend.dispose();this.effectSend=null;this.effectReturn.dispose();this.effectReturn=null;this._writable(["wet"]);this.wet=null;return this};return Tone.Effect});Module(function(Tone){Tone.AutoFilter=function(){var options=this.optionsObject(arguments,["frequency","baseFrequency","octaves"],Tone.AutoFilter.defaults);Tone.Effect.call(this,options);this._lfo=new Tone.LFO({frequency:options.frequency,amplitude:options.depth});this.depth=this._lfo.amplitude;this.frequency=this._lfo.frequency;this.filter=new Tone.Filter(options.filter);this._octaves=0;this.connectEffect(this.filter);this._lfo.connect(this.filter.frequency);this.type=options.type;this._readOnly(["frequency","depth"]);this.octaves=options.octaves;this.baseFrequency=options.baseFrequency};Tone.extend(Tone.AutoFilter,Tone.Effect);Tone.AutoFilter.defaults={frequency:1,type:"sine",depth:1,baseFrequency:200,octaves:2.6,filter:{type:"lowpass",rolloff:-12,Q:1}};Tone.AutoFilter.prototype.start=function(time){this._lfo.start(time);return this};Tone.AutoFilter.prototype.stop=function(time){this._lfo.stop(time);return this};Tone.AutoFilter.prototype.sync=function(delay){this._lfo.sync(delay);return this};Tone.AutoFilter.prototype.unsync=function(){this._lfo.unsync();return this};Object.defineProperty(Tone.AutoFilter.prototype,"type",{get:function(){return this._lfo.type},set:function(type){this._lfo.type=type}});Object.defineProperty(Tone.AutoFilter.prototype,"baseFrequency",{get:function(){return this._lfo.min},set:function(freq){this._lfo.min=this.toFrequency(freq);this.octaves=this._octaves}});Object.defineProperty(Tone.AutoFilter.prototype,"octaves",{get:function(){return this._octaves},set:function(oct){this._octaves=oct;this._lfo.max=this.baseFrequency*Math.pow(2,oct)}});Tone.AutoFilter.prototype.dispose=function(){Tone.Effect.prototype.dispose.call(this);this._lfo.dispose();this._lfo=null;this.filter.dispose();this.filter=null;this._writable(["frequency","depth"]);this.frequency=null;this.depth=null;return this};return Tone.AutoFilter});Module(function(Tone){Tone.AutoPanner=function(){var options=this.optionsObject(arguments,["frequency"],Tone.AutoPanner.defaults);Tone.Effect.call(this,options);this._lfo=new Tone.LFO({frequency:options.frequency,amplitude:options.depth,min:-1,max:1});this.depth=this._lfo.amplitude;this._panner=new Tone.Panner;this.frequency=this._lfo.frequency;this.connectEffect(this._panner);this._lfo.connect(this._panner.pan);this.type=options.type;this._readOnly(["depth","frequency"])};Tone.extend(Tone.AutoPanner,Tone.Effect);Tone.AutoPanner.defaults={frequency:1,type:"sine",depth:1};Tone.AutoPanner.prototype.start=function(time){this._lfo.start(time);return this};Tone.AutoPanner.prototype.stop=function(time){this._lfo.stop(time);return this};Tone.AutoPanner.prototype.sync=function(delay){this._lfo.sync(delay);return this};Tone.AutoPanner.prototype.unsync=function(){this._lfo.unsync();return this};Object.defineProperty(Tone.AutoPanner.prototype,"type",{get:function(){return this._lfo.type},set:function(type){this._lfo.type=type}});Tone.AutoPanner.prototype.dispose=function(){Tone.Effect.prototype.dispose.call(this);this._lfo.dispose();this._lfo=null;this._panner.dispose();this._panner=null;this._writable(["depth","frequency"]);this.frequency=null;this.depth=null;return this};return Tone.AutoPanner});Module(function(Tone){Tone.AutoWah=function(){var options=this.optionsObject(arguments,["baseFrequency","octaves","sensitivity"],Tone.AutoWah.defaults);Tone.Effect.call(this,options);this.follower=new Tone.Follower(options.follower);this._sweepRange=new Tone.ScaleExp(0,1,.5);this._baseFrequency=options.baseFrequency;this._octaves=options.octaves;this._inputBoost=new Tone.Gain;this._bandpass=new Tone.Filter({rolloff:-48,frequency:0,Q:options.Q});this._peaking=new Tone.Filter(0,"peaking");this._peaking.gain.value=options.gain;this.gain=this._peaking.gain;this.Q=this._bandpass.Q;this.effectSend.chain(this._inputBoost,this.follower,this._sweepRange);this._sweepRange.connect(this._bandpass.frequency);this._sweepRange.connect(this._peaking.frequency);this.effectSend.chain(this._bandpass,this._peaking,this.effectReturn);this._setSweepRange();this.sensitivity=options.sensitivity;this._readOnly(["gain","Q"])};Tone.extend(Tone.AutoWah,Tone.Effect);Tone.AutoWah.defaults={baseFrequency:100,octaves:6,sensitivity:0,Q:2,gain:2,follower:{attack:.3,release:.5}};Object.defineProperty(Tone.AutoWah.prototype,"octaves",{get:function(){return this._octaves},set:function(octaves){this._octaves=octaves;this._setSweepRange()}});Object.defineProperty(Tone.AutoWah.prototype,"baseFrequency",{get:function(){return this._baseFrequency},set:function(baseFreq){this._baseFrequency=baseFreq;this._setSweepRange()}});Object.defineProperty(Tone.AutoWah.prototype,"sensitivity",{get:function(){return this.gainToDb(1/this._inputBoost.gain.value)},set:function(sensitivy){this._inputBoost.gain.value=1/this.dbToGain(sensitivy)}});Tone.AutoWah.prototype._setSweepRange=function(){this._sweepRange.min=this._baseFrequency;this._sweepRange.max=Math.min(this._baseFrequency*Math.pow(2,this._octaves),this.context.sampleRate/2)};Tone.AutoWah.prototype.dispose=function(){Tone.Effect.prototype.dispose.call(this);this.follower.dispose();this.follower=null;this._sweepRange.dispose();this._sweepRange=null;this._bandpass.dispose();this._bandpass=null;this._peaking.dispose();this._peaking=null;this._inputBoost.dispose();this._inputBoost=null;this._writable(["gain","Q"]);this.gain=null;this.Q=null;return this};return Tone.AutoWah});Module(function(Tone){Tone.BitCrusher=function(){var options=this.optionsObject(arguments,["bits"],Tone.BitCrusher.defaults);Tone.Effect.call(this,options);var invStepSize=1/Math.pow(2,options.bits-1);this._subtract=new Tone.Subtract;this._modulo=new Tone.Modulo(invStepSize);this._bits=options.bits;this.effectSend.fan(this._subtract,this._modulo);this._modulo.connect(this._subtract,0,1);this._subtract.connect(this.effectReturn)};Tone.extend(Tone.BitCrusher,Tone.Effect);Tone.BitCrusher.defaults={bits:4};Object.defineProperty(Tone.BitCrusher.prototype,"bits",{get:function(){return this._bits},set:function(bits){this._bits=bits;var invStepSize=1/Math.pow(2,bits-1);this._modulo.value=invStepSize}});Tone.BitCrusher.prototype.dispose=function(){Tone.Effect.prototype.dispose.call(this);this._subtract.dispose();this._subtract=null;this._modulo.dispose();this._modulo=null;return this};return Tone.BitCrusher});Module(function(Tone){Tone.Chebyshev=function(){var options=this.optionsObject(arguments,["order"],Tone.Chebyshev.defaults);Tone.Effect.call(this,options);this._shaper=new Tone.WaveShaper(4096);this._order=options.order;this.connectEffect(this._shaper);this.order=options.order;this.oversample=options.oversample};Tone.extend(Tone.Chebyshev,Tone.Effect);Tone.Chebyshev.defaults={order:1,oversample:"none"};Tone.Chebyshev.prototype._getCoefficient=function(x,degree,memo){if(memo.hasOwnProperty(degree)){return memo[degree]}else if(degree===0){memo[degree]=0}else if(degree===1){memo[degree]=x}else{memo[degree]=2*x*this._getCoefficient(x,degree-1,memo)-this._getCoefficient(x,degree-2,memo)}return memo[degree]};Object.defineProperty(Tone.Chebyshev.prototype,"order",{get:function(){return this._order},set:function(order){this._order=order;var curve=new Array(4096);var len=curve.length;for(var i=0;i<len;++i){var x=i*2/len-1;if(x===0){curve[i]=0}else{curve[i]=this._getCoefficient(x,order,{})}}this._shaper.curve=curve}});Object.defineProperty(Tone.Chebyshev.prototype,"oversample",{get:function(){return this._shaper.oversample},set:function(oversampling){this._shaper.oversample=oversampling}});Tone.Chebyshev.prototype.dispose=function(){Tone.Effect.prototype.dispose.call(this);this._shaper.dispose();this._shaper=null;return this};return Tone.Chebyshev});Module(function(Tone){Tone.StereoEffect=function(){this.createInsOuts(1,1);var options=this.optionsObject(arguments,["wet"],Tone.Effect.defaults);this._dryWet=new Tone.CrossFade(options.wet);this.wet=this._dryWet.fade;this._split=new Tone.Split;this.effectSendL=this._split.left;this.effectSendR=this._split.right;this._merge=new Tone.Merge;
this.effectReturnL=this._merge.left;this.effectReturnR=this._merge.right;this.input.connect(this._split);this.input.connect(this._dryWet,0,0);this._merge.connect(this._dryWet,0,1);this._dryWet.connect(this.output);this._readOnly(["wet"])};Tone.extend(Tone.StereoEffect,Tone.Effect);Tone.StereoEffect.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._dryWet.dispose();this._dryWet=null;this._split.dispose();this._split=null;this._merge.dispose();this._merge=null;this.effectSendL=null;this.effectSendR=null;this.effectReturnL=null;this.effectReturnR=null;this._writable(["wet"]);this.wet=null;return this};return Tone.StereoEffect});Module(function(Tone){Tone.FeedbackEffect=function(){var options=this.optionsObject(arguments,["feedback"]);options=this.defaultArg(options,Tone.FeedbackEffect.defaults);Tone.Effect.call(this,options);this._feedbackGain=new Tone.Gain(options.feedback,Tone.Type.NormalRange);this.feedback=this._feedbackGain.gain;this.effectReturn.chain(this._feedbackGain,this.effectSend);this._readOnly(["feedback"])};Tone.extend(Tone.FeedbackEffect,Tone.Effect);Tone.FeedbackEffect.defaults={feedback:.125};Tone.FeedbackEffect.prototype.dispose=function(){Tone.Effect.prototype.dispose.call(this);this._writable(["feedback"]);this._feedbackGain.dispose();this._feedbackGain=null;this.feedback=null;return this};return Tone.FeedbackEffect});Module(function(Tone){Tone.StereoXFeedbackEffect=function(){var options=this.optionsObject(arguments,["feedback"],Tone.FeedbackEffect.defaults);Tone.StereoEffect.call(this,options);this.feedback=new Tone.Signal(options.feedback,Tone.Type.NormalRange);this._feedbackLR=new Tone.Gain;this._feedbackRL=new Tone.Gain;this.effectReturnL.chain(this._feedbackLR,this.effectSendR);this.effectReturnR.chain(this._feedbackRL,this.effectSendL);this.feedback.fan(this._feedbackLR.gain,this._feedbackRL.gain);this._readOnly(["feedback"])};Tone.extend(Tone.StereoXFeedbackEffect,Tone.FeedbackEffect);Tone.StereoXFeedbackEffect.prototype.dispose=function(){Tone.StereoEffect.prototype.dispose.call(this);this._writable(["feedback"]);this.feedback.dispose();this.feedback=null;this._feedbackLR.dispose();this._feedbackLR=null;this._feedbackRL.dispose();this._feedbackRL=null;return this};return Tone.StereoXFeedbackEffect});Module(function(Tone){Tone.Chorus=function(){var options=this.optionsObject(arguments,["frequency","delayTime","depth"],Tone.Chorus.defaults);Tone.StereoXFeedbackEffect.call(this,options);this._depth=options.depth;this._delayTime=options.delayTime/1e3;this._lfoL=new Tone.LFO({frequency:options.frequency,min:0,max:1});this._lfoR=new Tone.LFO({frequency:options.frequency,min:0,max:1,phase:180});this._delayNodeL=new Tone.Delay;this._delayNodeR=new Tone.Delay;this.frequency=this._lfoL.frequency;this.effectSendL.chain(this._delayNodeL,this.effectReturnL);this.effectSendR.chain(this._delayNodeR,this.effectReturnR);this.effectSendL.connect(this.effectReturnL);this.effectSendR.connect(this.effectReturnR);this._lfoL.connect(this._delayNodeL.delayTime);this._lfoR.connect(this._delayNodeR.delayTime);this._lfoL.start();this._lfoR.start();this._lfoL.frequency.connect(this._lfoR.frequency);this.depth=this._depth;this.frequency.value=options.frequency;this.type=options.type;this._readOnly(["frequency"]);this.spread=options.spread};Tone.extend(Tone.Chorus,Tone.StereoXFeedbackEffect);Tone.Chorus.defaults={frequency:1.5,delayTime:3.5,depth:.7,feedback:.1,type:"sine",spread:180};Object.defineProperty(Tone.Chorus.prototype,"depth",{get:function(){return this._depth},set:function(depth){this._depth=depth;var deviation=this._delayTime*depth;this._lfoL.min=Math.max(this._delayTime-deviation,0);this._lfoL.max=this._delayTime+deviation;this._lfoR.min=Math.max(this._delayTime-deviation,0);this._lfoR.max=this._delayTime+deviation}});Object.defineProperty(Tone.Chorus.prototype,"delayTime",{get:function(){return this._delayTime*1e3},set:function(delayTime){this._delayTime=delayTime/1e3;this.depth=this._depth}});Object.defineProperty(Tone.Chorus.prototype,"type",{get:function(){return this._lfoL.type},set:function(type){this._lfoL.type=type;this._lfoR.type=type}});Object.defineProperty(Tone.Chorus.prototype,"spread",{get:function(){return this._lfoR.phase-this._lfoL.phase},set:function(spread){this._lfoL.phase=90-spread/2;this._lfoR.phase=spread/2+90}});Tone.Chorus.prototype.dispose=function(){Tone.StereoXFeedbackEffect.prototype.dispose.call(this);this._lfoL.dispose();this._lfoL=null;this._lfoR.dispose();this._lfoR=null;this._delayNodeL.dispose();this._delayNodeL=null;this._delayNodeR.dispose();this._delayNodeR=null;this._writable("frequency");this.frequency=null;return this};return Tone.Chorus});Module(function(Tone){Tone.Convolver=function(){var options=this.optionsObject(arguments,["url","onload"],Tone.Convolver.defaults);Tone.Effect.call(this,options);this._convolver=this.context.createConvolver();this._buffer=new Tone.Buffer;if(this.isString(options.url)){this._buffer.load(options.url,function(buffer){this.buffer=buffer;options.onload()}.bind(this))}else if(options.url){this.buffer=options.url;options.onload()}this.connectEffect(this._convolver)};Tone.extend(Tone.Convolver,Tone.Effect);Tone.Convolver.defaults={onload:Tone.noOp};Object.defineProperty(Tone.Convolver.prototype,"buffer",{get:function(){return this._buffer.get()},set:function(buffer){this._buffer.set(buffer);this._convolver.buffer=this._buffer.get()}});Tone.Convolver.prototype.load=function(url,callback){return this._buffer.load(url,function(buff){this.buffer=buff;if(callback){callback()}}.bind(this))};Tone.Convolver.prototype.dispose=function(){Tone.Effect.prototype.dispose.call(this);this._convolver.disconnect();this._convolver=null;this._buffer.dispose();this._buffer=null;return this};return Tone.Convolver});Module(function(Tone){Tone.Distortion=function(){var options=this.optionsObject(arguments,["distortion"],Tone.Distortion.defaults);Tone.Effect.call(this,options);this._shaper=new Tone.WaveShaper(4096);this._distortion=options.distortion;this.connectEffect(this._shaper);this.distortion=options.distortion;this.oversample=options.oversample};Tone.extend(Tone.Distortion,Tone.Effect);Tone.Distortion.defaults={distortion:.4,oversample:"none"};Object.defineProperty(Tone.Distortion.prototype,"distortion",{get:function(){return this._distortion},set:function(amount){this._distortion=amount;var k=amount*100;var deg=Math.PI/180;this._shaper.setMap(function(x){if(Math.abs(x)<.001){return 0}else{return(3+k)*x*20*deg/(Math.PI+k*Math.abs(x))}})}});Object.defineProperty(Tone.Distortion.prototype,"oversample",{get:function(){return this._shaper.oversample},set:function(oversampling){this._shaper.oversample=oversampling}});Tone.Distortion.prototype.dispose=function(){Tone.Effect.prototype.dispose.call(this);this._shaper.dispose();this._shaper=null;return this};return Tone.Distortion});Module(function(Tone){Tone.FeedbackDelay=function(){var options=this.optionsObject(arguments,["delayTime","feedback"],Tone.FeedbackDelay.defaults);Tone.FeedbackEffect.call(this,options);this._delayNode=new Tone.Delay(options.delayTime);this.delayTime=this._delayNode.delayTime;this.connectEffect(this._delayNode);this._readOnly(["delayTime"])};Tone.extend(Tone.FeedbackDelay,Tone.FeedbackEffect);Tone.FeedbackDelay.defaults={delayTime:.25};Tone.FeedbackDelay.prototype.dispose=function(){Tone.FeedbackEffect.prototype.dispose.call(this);this._delayNode.dispose();this._delayNode=null;this._writable(["delayTime"]);this.delayTime=null;return this};return Tone.FeedbackDelay});Module(function(Tone){var combFilterTunings=[1557/44100,1617/44100,1491/44100,1422/44100,1277/44100,1356/44100,1188/44100,1116/44100];var allpassFilterFrequencies=[225,556,441,341];Tone.Freeverb=function(){var options=this.optionsObject(arguments,["roomSize","dampening"],Tone.Freeverb.defaults);Tone.StereoEffect.call(this,options);this.roomSize=new Tone.Signal(options.roomSize,Tone.Type.NormalRange);this.dampening=new Tone.Signal(options.dampening,Tone.Type.Frequency);this._combFilters=[];this._allpassFiltersL=[];this._allpassFiltersR=[];for(var l=0;l<allpassFilterFrequencies.length;l++){var allpassL=this.context.createBiquadFilter();allpassL.type="allpass";allpassL.frequency.value=allpassFilterFrequencies[l];this._allpassFiltersL.push(allpassL)}for(var r=0;r<allpassFilterFrequencies.length;r++){var allpassR=this.context.createBiquadFilter();allpassR.type="allpass";allpassR.frequency.value=allpassFilterFrequencies[r];this._allpassFiltersR.push(allpassR)}for(var c=0;c<combFilterTunings.length;c++){var lfpf=new Tone.LowpassCombFilter(combFilterTunings[c]);if(c<combFilterTunings.length/2){this.effectSendL.chain(lfpf,this._allpassFiltersL[0])}else{this.effectSendR.chain(lfpf,this._allpassFiltersR[0])}this.roomSize.connect(lfpf.resonance);this.dampening.connect(lfpf.dampening);this._combFilters.push(lfpf)}this.connectSeries.apply(this,this._allpassFiltersL);this.connectSeries.apply(this,this._allpassFiltersR);this._allpassFiltersL[this._allpassFiltersL.length-1].connect(this.effectReturnL);this._allpassFiltersR[this._allpassFiltersR.length-1].connect(this.effectReturnR);this._readOnly(["roomSize","dampening"])};Tone.extend(Tone.Freeverb,Tone.StereoEffect);Tone.Freeverb.defaults={roomSize:.7,dampening:3e3};Tone.Freeverb.prototype.dispose=function(){Tone.StereoEffect.prototype.dispose.call(this);for(var al=0;al<this._allpassFiltersL.length;al++){this._allpassFiltersL[al].disconnect();this._allpassFiltersL[al]=null}this._allpassFiltersL=null;for(var ar=0;ar<this._allpassFiltersR.length;ar++){this._allpassFiltersR[ar].disconnect();this._allpassFiltersR[ar]=null}this._allpassFiltersR=null;for(var cf=0;cf<this._combFilters.length;cf++){this._combFilters[cf].dispose();this._combFilters[cf]=null}this._combFilters=null;this._writable(["roomSize","dampening"]);this.roomSize.dispose();this.roomSize=null;this.dampening.dispose();this.dampening=null;return this};return Tone.Freeverb});Module(function(Tone){var combFilterDelayTimes=[1687/25e3,1601/25e3,2053/25e3,2251/25e3];var combFilterResonances=[.773,.802,.753,.733];var allpassFilterFreqs=[347,113,37];Tone.JCReverb=function(){var options=this.optionsObject(arguments,["roomSize"],Tone.JCReverb.defaults);Tone.StereoEffect.call(this,options);this.roomSize=new Tone.Signal(options.roomSize,Tone.Type.NormalRange);this._scaleRoomSize=new Tone.Scale(-.733,.197);this._allpassFilters=[];this._feedbackCombFilters=[];for(var af=0;af<allpassFilterFreqs.length;af++){var allpass=this.context.createBiquadFilter();allpass.type="allpass";allpass.frequency.value=allpassFilterFreqs[af];this._allpassFilters.push(allpass)}for(var cf=0;cf<combFilterDelayTimes.length;cf++){var fbcf=new Tone.FeedbackCombFilter(combFilterDelayTimes[cf],.1);this._scaleRoomSize.connect(fbcf.resonance);fbcf.resonance.value=combFilterResonances[cf];this._allpassFilters[this._allpassFilters.length-1].connect(fbcf);if(cf<combFilterDelayTimes.length/2){fbcf.connect(this.effectReturnL)}else{fbcf.connect(this.effectReturnR)}this._feedbackCombFilters.push(fbcf)}this.roomSize.connect(this._scaleRoomSize);this.connectSeries.apply(this,this._allpassFilters);this.effectSendL.connect(this._allpassFilters[0]);this.effectSendR.connect(this._allpassFilters[0]);this._readOnly(["roomSize"])};Tone.extend(Tone.JCReverb,Tone.StereoEffect);Tone.JCReverb.defaults={roomSize:.5};Tone.JCReverb.prototype.dispose=function(){Tone.StereoEffect.prototype.dispose.call(this);for(var apf=0;apf<this._allpassFilters.length;apf++){this._allpassFilters[apf].disconnect();this._allpassFilters[apf]=null}this._allpassFilters=null;for(var fbcf=0;fbcf<this._feedbackCombFilters.length;fbcf++){this._feedbackCombFilters[fbcf].dispose();this._feedbackCombFilters[fbcf]=null}this._feedbackCombFilters=null;this._writable(["roomSize"]);this.roomSize.dispose();this.roomSize=null;this._scaleRoomSize.dispose();this._scaleRoomSize=null;return this};return Tone.JCReverb});Module(function(Tone){Tone.MidSideEffect=function(){Tone.Effect.apply(this,arguments);this._midSideSplit=new Tone.MidSideSplit;this._midSideMerge=new Tone.MidSideMerge;this.midSend=this._midSideSplit.mid;this.sideSend=this._midSideSplit.side;this.midReturn=this._midSideMerge.mid;this.sideReturn=this._midSideMerge.side;this.effectSend.connect(this._midSideSplit);this._midSideMerge.connect(this.effectReturn)};Tone.extend(Tone.MidSideEffect,Tone.Effect);Tone.MidSideEffect.prototype.dispose=function(){Tone.Effect.prototype.dispose.call(this);this._midSideSplit.dispose();this._midSideSplit=null;this._midSideMerge.dispose();this._midSideMerge=null;this.midSend=null;this.sideSend=null;this.midReturn=null;this.sideReturn=null;return this};return Tone.MidSideEffect});Module(function(Tone){Tone.Phaser=function(){var options=this.optionsObject(arguments,["frequency","octaves","baseFrequency"],Tone.Phaser.defaults);Tone.StereoEffect.call(this,options);this._lfoL=new Tone.LFO(options.frequency,0,1);this._lfoR=new Tone.LFO(options.frequency,0,1);this._lfoR.phase=180;this._baseFrequency=options.baseFrequency;this._octaves=options.octaves;this.Q=new Tone.Signal(options.Q,Tone.Type.Positive);this._filtersL=this._makeFilters(options.stages,this._lfoL,this.Q);this._filtersR=this._makeFilters(options.stages,this._lfoR,this.Q);this.frequency=this._lfoL.frequency;this.frequency.value=options.frequency;this.effectSendL.connect(this._filtersL[0]);this.effectSendR.connect(this._filtersR[0]);this._filtersL[options.stages-1].connect(this.effectReturnL);this._filtersR[options.stages-1].connect(this.effectReturnR);this._lfoL.frequency.connect(this._lfoR.frequency);this.baseFrequency=options.baseFrequency;this.octaves=options.octaves;this._lfoL.start();this._lfoR.start();this._readOnly(["frequency","Q"])};Tone.extend(Tone.Phaser,Tone.StereoEffect);Tone.Phaser.defaults={frequency:.5,octaves:3,stages:10,Q:10,baseFrequency:350};Tone.Phaser.prototype._makeFilters=function(stages,connectToFreq,Q){var filters=new Array(stages);for(var i=0;i<stages;i++){var filter=this.context.createBiquadFilter();filter.type="allpass";Q.connect(filter.Q);connectToFreq.connect(filter.frequency);filters[i]=filter}this.connectSeries.apply(this,filters);return filters};Object.defineProperty(Tone.Phaser.prototype,"octaves",{get:function(){return this._octaves},set:function(octaves){this._octaves=octaves;var max=this._baseFrequency*Math.pow(2,octaves);this._lfoL.max=max;this._lfoR.max=max}});Object.defineProperty(Tone.Phaser.prototype,"baseFrequency",{get:function(){return this._baseFrequency},set:function(freq){this._baseFrequency=freq;this._lfoL.min=freq;this._lfoR.min=freq;this.octaves=this._octaves}});Tone.Phaser.prototype.dispose=function(){Tone.StereoEffect.prototype.dispose.call(this);this._writable(["frequency","Q"]);this.Q.dispose();this.Q=null;this._lfoL.dispose();this._lfoL=null;this._lfoR.dispose();this._lfoR=null;for(var i=0;i<this._filtersL.length;i++){this._filtersL[i].disconnect();this._filtersL[i]=null}this._filtersL=null;for(var j=0;j<this._filtersR.length;j++){this._filtersR[j].disconnect();this._filtersR[j]=null}this._filtersR=null;this.frequency=null;return this};return Tone.Phaser});Module(function(Tone){Tone.PingPongDelay=function(){var options=this.optionsObject(arguments,["delayTime","feedback"],Tone.PingPongDelay.defaults);Tone.StereoXFeedbackEffect.call(this,options);this._leftDelay=new Tone.Delay(0,options.maxDelayTime);this._rightDelay=new Tone.Delay(0,options.maxDelayTime);this._rightPreDelay=new Tone.Delay(0,options.maxDelayTime);this.delayTime=new Tone.Signal(options.delayTime,Tone.Type.Time);this.effectSendL.chain(this._leftDelay,this.effectReturnL);this.effectSendR.chain(this._rightPreDelay,this._rightDelay,this.effectReturnR);this.delayTime.fan(this._leftDelay.delayTime,this._rightDelay.delayTime,this._rightPreDelay.delayTime);this._feedbackLR.disconnect();this._feedbackLR.connect(this._rightDelay);this._readOnly(["delayTime"])};Tone.extend(Tone.PingPongDelay,Tone.StereoXFeedbackEffect);Tone.PingPongDelay.defaults={delayTime:.25,maxDelayTime:1};Tone.PingPongDelay.prototype.dispose=function(){Tone.StereoXFeedbackEffect.prototype.dispose.call(this);this._leftDelay.dispose();this._leftDelay=null;this._rightDelay.dispose();this._rightDelay=null;this._rightPreDelay.dispose();this._rightPreDelay=null;this._writable(["delayTime"]);this.delayTime.dispose();this.delayTime=null;return this};return Tone.PingPongDelay});Module(function(Tone){Tone.PitchShift=function(){var options=this.optionsObject(arguments,["pitch"],Tone.PitchShift.defaults);Tone.FeedbackEffect.call(this,options);this._frequency=new Tone.Signal(0);this._delayA=new Tone.Delay(0,1);this._lfoA=new Tone.LFO({min:0,max:.1,type:"sawtooth"}).connect(this._delayA.delayTime);this._delayB=new Tone.Delay(0,1);this._lfoB=new Tone.LFO({min:0,max:.1,type:"sawtooth",phase:180}).connect(this._delayB.delayTime);this._crossFade=new Tone.CrossFade;this._crossFadeLFO=new Tone.LFO({min:0,max:1,type:"triangle",phase:90}).connect(this._crossFade.fade);this._feedbackDelay=new Tone.Delay(options.delayTime);this.delayTime=this._feedbackDelay.delayTime;this._readOnly("delayTime");this._pitch=options.pitch;this._windowSize=options.windowSize;this._delayA.connect(this._crossFade.a);this._delayB.connect(this._crossFade.b);this._frequency.fan(this._lfoA.frequency,this._lfoB.frequency,this._crossFadeLFO.frequency);this.effectSend.fan(this._delayA,this._delayB);this._crossFade.chain(this._feedbackDelay,this.effectReturn);var now=this.now();this._lfoA.start(now);this._lfoB.start(now);this._crossFadeLFO.start(now);this.windowSize=this._windowSize};Tone.extend(Tone.PitchShift,Tone.FeedbackEffect);Tone.PitchShift.defaults={pitch:0,windowSize:.1,delayTime:0,feedback:0};Object.defineProperty(Tone.PitchShift.prototype,"pitch",{get:function(){return this._pitch},set:function(interval){this._pitch=interval;var factor=0;if(interval<0){this._lfoA.min=0;this._lfoA.max=this._windowSize;this._lfoB.min=0;this._lfoB.max=this._windowSize;factor=this.intervalToFrequencyRatio(interval-1)+1}else{this._lfoA.min=this._windowSize;this._lfoA.max=0;this._lfoB.min=this._windowSize;this._lfoB.max=0;factor=this.intervalToFrequencyRatio(interval)-1}this._frequency.value=factor*(1.2/this._windowSize)}});Object.defineProperty(Tone.PitchShift.prototype,"windowSize",{get:function(){return this._windowSize},set:function(size){this._windowSize=this.toSeconds(size);this.pitch=this._pitch}});Tone.PitchShift.prototype.dispose=function(){Tone.FeedbackEffect.prototype.dispose.call(this);this._frequency.dispose();this._frequency=null;this._delayA.disconnect();this._delayA=null;this._delayB.disconnect();this._delayB=null;this._lfoA.dispose();this._lfoA=null;this._lfoB.dispose();this._lfoB=null;this._crossFade.dispose();this._crossFade=null;this._crossFadeLFO.dispose();this._crossFadeLFO=null;this._writable("delayTime");this._feedbackDelay.dispose();this._feedbackDelay=null;this.delayTime=null;return this};return Tone.PitchShift});Module(function(Tone){Tone.StereoFeedbackEffect=function(){var options=this.optionsObject(arguments,["feedback"],Tone.FeedbackEffect.defaults);Tone.StereoEffect.call(this,options);this.feedback=new Tone.Signal(options.feedback,Tone.Type.NormalRange);this._feedbackL=new Tone.Gain;this._feedbackR=new Tone.Gain;this.effectReturnL.chain(this._feedbackL,this.effectSendL);this.effectReturnR.chain(this._feedbackR,this.effectSendR);this.feedback.fan(this._feedbackL.gain,this._feedbackR.gain);this._readOnly(["feedback"])};Tone.extend(Tone.StereoFeedbackEffect,Tone.FeedbackEffect);Tone.StereoFeedbackEffect.prototype.dispose=function(){Tone.StereoEffect.prototype.dispose.call(this);this._writable(["feedback"]);this.feedback.dispose();this.feedback=null;this._feedbackL.dispose();this._feedbackL=null;this._feedbackR.dispose();this._feedbackR=null;return this};return Tone.StereoFeedbackEffect});Module(function(Tone){Tone.StereoWidener=function(){var options=this.optionsObject(arguments,["width"],Tone.StereoWidener.defaults);Tone.MidSideEffect.call(this,options);this.width=new Tone.Signal(options.width,Tone.Type.NormalRange);this._midMult=new Tone.Expr("$0 * ($1 * (1 - $2))");this._sideMult=new Tone.Expr("$0 * ($1 * $2)");this._two=new Tone.Signal(2);this._two.connect(this._midMult,0,1);this.width.connect(this._midMult,0,2);this._two.connect(this._sideMult,0,1);this.width.connect(this._sideMult,0,2);this.midSend.chain(this._midMult,this.midReturn);this.sideSend.chain(this._sideMult,this.sideReturn);this._readOnly(["width"])};Tone.extend(Tone.StereoWidener,Tone.MidSideEffect);Tone.StereoWidener.defaults={width:.5};Tone.StereoWidener.prototype.dispose=function(){Tone.MidSideEffect.prototype.dispose.call(this);this._writable(["width"]);this.width.dispose();this.width=null;this._midMult.dispose();this._midMult=null;this._sideMult.dispose();this._sideMult=null;this._two.dispose();this._two=null;return this};return Tone.StereoWidener});Module(function(Tone){Tone.Tremolo=function(){var options=this.optionsObject(arguments,["frequency","depth"],Tone.Tremolo.defaults);Tone.StereoEffect.call(this,options);this._lfoL=new Tone.LFO({phase:options.spread,min:1,max:0});this._lfoR=new Tone.LFO({phase:options.spread,min:1,max:0});this._amplitudeL=new Tone.Gain;this._amplitudeR=new Tone.Gain;this.frequency=new Tone.Signal(options.frequency,Tone.Type.Frequency);this.depth=new Tone.Signal(options.depth,Tone.Type.NormalRange);this._readOnly(["frequency","depth"]);this.effectSendL.chain(this._amplitudeL,this.effectReturnL);this.effectSendR.chain(this._amplitudeR,this.effectReturnR);this._lfoL.connect(this._amplitudeL.gain);this._lfoR.connect(this._amplitudeR.gain);this.frequency.fan(this._lfoL.frequency,this._lfoR.frequency);this.depth.fan(this._lfoR.amplitude,this._lfoL.amplitude);this.type=options.type;this.spread=options.spread};Tone.extend(Tone.Tremolo,Tone.StereoEffect);Tone.Tremolo.defaults={frequency:10,type:"sine",depth:.5,spread:180};Tone.Tremolo.prototype.start=function(time){this._lfoL.start(time);this._lfoR.start(time);return this};Tone.Tremolo.prototype.stop=function(time){this._lfoL.stop(time);this._lfoR.stop(time);return this};Tone.Tremolo.prototype.sync=function(delay){this._lfoL.sync(delay);this._lfoR.sync(delay);return this};Tone.Tremolo.prototype.unsync=function(){this._lfoL.unsync();this._lfoR.unsync();return this};Object.defineProperty(Tone.Tremolo.prototype,"type",{get:function(){return this._lfoL.type},set:function(type){this._lfoL.type=type;this._lfoR.type=type}});Object.defineProperty(Tone.Tremolo.prototype,"spread",{get:function(){return this._lfoR.phase-this._lfoL.phase},set:function(spread){this._lfoL.phase=90-spread/2;this._lfoR.phase=spread/2+90}});Tone.Tremolo.prototype.dispose=function(){Tone.StereoEffect.prototype.dispose.call(this);this._writable(["frequency","depth"]);this._lfoL.dispose();this._lfoL=null;this._lfoR.dispose();this._lfoR=null;this._amplitudeL.dispose();this._amplitudeL=null;this._amplitudeR.dispose();this._amplitudeR=null;this.frequency=null;this.depth=null;return this};return Tone.Tremolo});Module(function(Tone){Tone.Vibrato=function(){var options=this.optionsObject(arguments,["frequency","depth"],Tone.Vibrato.defaults);Tone.Effect.call(this,options);this._delayNode=new Tone.Delay(0,options.maxDelay);this._lfo=new Tone.LFO({type:options.type,min:0,max:options.maxDelay,frequency:options.frequency,phase:-90}).start().connect(this._delayNode.delayTime);this.frequency=this._lfo.frequency;this.depth=this._lfo.amplitude;this.depth.value=options.depth;this._readOnly(["frequency","depth"]);this.effectSend.chain(this._delayNode,this.effectReturn)};Tone.extend(Tone.Vibrato,Tone.Effect);Tone.Vibrato.defaults={maxDelay:.005,frequency:5,depth:.1,type:"sine"};Object.defineProperty(Tone.Vibrato.prototype,"type",{get:function(){return this._lfo.type},set:function(type){this._lfo.type=type}});Tone.Vibrato.prototype.dispose=function(){Tone.Effect.prototype.dispose.call(this);this._delayNode.dispose();this._delayNode=null;this._lfo.dispose();this._lfo=null;this._writable(["frequency","depth"]);this.frequency=null;this.depth=null};return Tone.Vibrato});Module(function(Tone){Tone.Event=function(){var options=this.optionsObject(arguments,["callback","value"],Tone.Event.defaults);this._loop=options.loop;this.callback=options.callback;this.value=options.value;this._loopStart=this.toTicks(options.loopStart);this._loopEnd=this.toTicks(options.loopEnd);this._state=new Tone.TimelineState(Tone.State.Stopped);this._playbackRate=1;this._startOffset=0;this.probability=options.probability;this.humanize=options.humanize;this.mute=options.mute;this.playbackRate=options.playbackRate};Tone.extend(Tone.Event);Tone.Event.defaults={callback:Tone.noOp,loop:false,loopEnd:"1m",loopStart:0,playbackRate:1,value:null,probability:1,mute:false,humanize:false};Tone.Event.prototype._rescheduleEvents=function(after){after=this.defaultArg(after,-1);this._state.forEachFrom(after,function(event){var duration;if(event.state===Tone.State.Started){if(!this.isUndef(event.id)){Tone.Transport.clear(event.id)}var startTick=event.time+Math.round(this.startOffset/this._playbackRate);if(this._loop){duration=Infinity;if(this.isNumber(this._loop)){duration=this._loop*this._getLoopDuration()}var nextEvent=this._state.getAfter(startTick);if(nextEvent!==null){duration=Math.min(duration,nextEvent.time-startTick)}if(duration!==Infinity){this._state.setStateAtTime(Tone.State.Stopped,startTick+duration+1);duration=Tone.Time(duration,"i")}var interval=Tone.Time(this._getLoopDuration(),"i");event.id=Tone.Transport.scheduleRepeat(this._tick.bind(this),interval,Tone.TransportTime(startTick,"i"),duration)}else{event.id=Tone.Transport.schedule(this._tick.bind(this),startTick+"i")}}}.bind(this));return this};Object.defineProperty(Tone.Event.prototype,"state",{get:function(){return this._state.getValueAtTime(Tone.Transport.ticks)}});Object.defineProperty(Tone.Event.prototype,"startOffset",{get:function(){return this._startOffset},set:function(offset){this._startOffset=offset}});Tone.Event.prototype.start=function(time){time=this.toTicks(time);if(this._state.getValueAtTime(time)===Tone.State.Stopped){this._state.add({state:Tone.State.Started,time:time,id:undefined});this._rescheduleEvents(time)}return this};Tone.Event.prototype.stop=function(time){this.cancel(time);time=this.toTicks(time);if(this._state.getValueAtTime(time)===Tone.State.Started){this._state.setStateAtTime(Tone.State.Stopped,time);var previousEvent=this._state.getBefore(time);var reschedulTime=time;if(previousEvent!==null){reschedulTime=previousEvent.time}this._rescheduleEvents(reschedulTime)}return this};Tone.Event.prototype.cancel=function(time){time=this.defaultArg(time,-Infinity);time=this.toTicks(time);this._state.forEachFrom(time,function(event){Tone.Transport.clear(event.id)});this._state.cancel(time);return this};Tone.Event.prototype._tick=function(time){if(!this.mute&&this._state.getValueAtTime(Tone.Transport.ticks)===Tone.State.Started){if(this.probability<1&&Math.random()>this.probability){return}if(this.humanize){var variation=.02;if(!this.isBoolean(this.humanize)){variation=this.toSeconds(this.humanize)}time+=(Math.random()*2-1)*variation}this.callback(time,this.value)}};Tone.Event.prototype._getLoopDuration=function(){return Math.round((this._loopEnd-this._loopStart)/this._playbackRate)};Object.defineProperty(Tone.Event.prototype,"loop",{get:function(){return this._loop},set:function(loop){this._loop=loop;this._rescheduleEvents()}});Object.defineProperty(Tone.Event.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(rate){this._playbackRate=rate;this._rescheduleEvents()}});Object.defineProperty(Tone.Event.prototype,"loopEnd",{get:function(){return Tone.TransportTime(this._loopEnd,"i").toNotation()},set:function(loopEnd){this._loopEnd=this.toTicks(loopEnd);if(this._loop){this._rescheduleEvents()}}});Object.defineProperty(Tone.Event.prototype,"loopStart",{get:function(){return Tone.TransportTime(this._loopStart,"i").toNotation()},set:function(loopStart){this._loopStart=this.toTicks(loopStart);if(this._loop){this._rescheduleEvents()}}});Object.defineProperty(Tone.Event.prototype,"progress",{get:function(){if(this._loop){var ticks=Tone.Transport.ticks;var lastEvent=this._state.get(ticks);if(lastEvent!==null&&lastEvent.state===Tone.State.Started){var loopDuration=this._getLoopDuration();var progress=(ticks-lastEvent.time)%loopDuration;return progress/loopDuration}else{return 0}}else{return 0}}});Tone.Event.prototype.dispose=function(){this.cancel();this._state.dispose();this._state=null;this.callback=null;this.value=null};return Tone.Event});Module(function(Tone){Tone.Loop=function(){var options=this.optionsObject(arguments,["callback","interval"],Tone.Loop.defaults);this._event=new Tone.Event({callback:this._tick.bind(this),loop:true,loopEnd:options.interval,playbackRate:options.playbackRate,probability:options.probability});this.callback=options.callback;this.iterations=options.iterations};Tone.extend(Tone.Loop);Tone.Loop.defaults={interval:"4n",callback:Tone.noOp,playbackRate:1,iterations:Infinity,probability:true,mute:false};Tone.Loop.prototype.start=function(time){this._event.start(time);return this};Tone.Loop.prototype.stop=function(time){this._event.stop(time);return this};Tone.Loop.prototype.cancel=function(time){this._event.cancel(time);return this};Tone.Loop.prototype._tick=function(time){this.callback(time)};Object.defineProperty(Tone.Loop.prototype,"state",{get:function(){return this._event.state}});Object.defineProperty(Tone.Loop.prototype,"progress",{get:function(){return this._event.progress}});Object.defineProperty(Tone.Loop.prototype,"interval",{get:function(){return this._event.loopEnd},set:function(interval){this._event.loopEnd=interval}});Object.defineProperty(Tone.Loop.prototype,"playbackRate",{get:function(){return this._event.playbackRate},set:function(rate){this._event.playbackRate=rate}});Object.defineProperty(Tone.Loop.prototype,"humanize",{get:function(){return this._event.humanize},set:function(variation){this._event.humanize=variation}});Object.defineProperty(Tone.Loop.prototype,"probability",{get:function(){return this._event.probability},set:function(prob){this._event.probability=prob}});Object.defineProperty(Tone.Loop.prototype,"mute",{get:function(){return this._event.mute},set:function(mute){this._event.mute=mute}});Object.defineProperty(Tone.Loop.prototype,"iterations",{get:function(){if(this._event.loop===true){return Infinity}else{return this._event.loop}return this._pattern.index},set:function(iters){if(iters===Infinity){this._event.loop=true}else{this._event.loop=iters}}});Tone.Loop.prototype.dispose=function(){this._event.dispose();this._event=null;this.callback=null};return Tone.Loop});Module(function(Tone){Tone.Part=function(){var options=this.optionsObject(arguments,["callback","events"],Tone.Part.defaults);this._loop=options.loop;this._loopStart=this.toTicks(options.loopStart);this._loopEnd=this.toTicks(options.loopEnd);this._playbackRate=options.playbackRate;this._probability=options.probability;this._humanize=options.humanize;this._startOffset=0;this._state=new Tone.TimelineState(Tone.State.Stopped);this._events=[];this.callback=options.callback;this.mute=options.mute;var events=this.defaultArg(options.events,[]);if(!this.isUndef(options.events)){for(var i=0;i<events.length;i++){if(Array.isArray(events[i])){this.add(events[i][0],events[i][1])}else{this.add(events[i])}}}};Tone.extend(Tone.Part,Tone.Event);Tone.Part.defaults={callback:Tone.noOp,loop:false,loopEnd:"1m",loopStart:0,playbackRate:1,probability:1,humanize:false,mute:false};Tone.Part.prototype.start=function(time,offset){var ticks=this.toTicks(time);if(this._state.getValueAtTime(ticks)!==Tone.State.Started){if(this._loop){offset=this.defaultArg(offset,this._loopStart)}else{offset=this.defaultArg(offset,0)}offset=this.toTicks(offset);this._state.add({state:Tone.State.Started,time:ticks,offset:offset});this._forEach(function(event){this._startNote(event,ticks,offset);
})}return this};Tone.Part.prototype._startNote=function(event,ticks,offset){ticks-=offset;if(this._loop){if(event.startOffset>=this._loopStart&&event.startOffset<this._loopEnd){if(event.startOffset<offset){ticks+=this._getLoopDuration()}event.start(Tone.TransportTime(ticks,"i"))}else if(event.startOffset<this._loopStart&&event.startOffset>=offset){event.loop=false;event.start(Tone.TransportTime(ticks,"i"))}}else{if(event.startOffset>=offset){event.start(Tone.TransportTime(ticks,"i"))}}};Object.defineProperty(Tone.Part.prototype,"startOffset",{get:function(){return this._startOffset},set:function(offset){this._startOffset=offset;this._forEach(function(event){event.startOffset+=this._startOffset})}});Tone.Part.prototype.stop=function(time){var ticks=this.toTicks(time);this._state.cancel(ticks);this._state.setStateAtTime(Tone.State.Stopped,ticks);this._forEach(function(event){event.stop(time)});return this};Tone.Part.prototype.at=function(time,value){time=Tone.TransportTime(time);var tickTime=Tone.Time(1,"i").toSeconds();for(var i=0;i<this._events.length;i++){var event=this._events[i];if(Math.abs(time.toTicks()-event.startOffset)<tickTime){if(!this.isUndef(value)){event.value=value}return event}}if(!this.isUndef(value)){this.add(time,value);return this._events[this._events.length-1]}else{return null}};Tone.Part.prototype.add=function(time,value){if(time.hasOwnProperty("time")){value=time;time=value.time}time=this.toTicks(time);var event;if(value instanceof Tone.Event){event=value;event.callback=this._tick.bind(this)}else{event=new Tone.Event({callback:this._tick.bind(this),value:value})}event.startOffset=time;event.set({loopEnd:this.loopEnd,loopStart:this.loopStart,loop:this.loop,humanize:this.humanize,playbackRate:this.playbackRate,probability:this.probability});this._events.push(event);this._restartEvent(event);return this};Tone.Part.prototype._restartEvent=function(event){this._state.forEach(function(stateEvent){if(stateEvent.state===Tone.State.Started){this._startNote(event,stateEvent.time,stateEvent.offset)}else{event.stop(Tone.TransportTime(stateEvent.time,"i"))}}.bind(this))};Tone.Part.prototype.remove=function(time,value){if(time.hasOwnProperty("time")){value=time;time=value.time}time=this.toTicks(time);for(var i=this._events.length-1;i>=0;i--){var event=this._events[i];if(event instanceof Tone.Part){event.remove(time,value)}else{if(event.startOffset===time){if(this.isUndef(value)||!this.isUndef(value)&&event.value===value){this._events.splice(i,1);event.dispose()}}}}return this};Tone.Part.prototype.removeAll=function(){this._forEach(function(event){event.dispose()});this._events=[];return this};Tone.Part.prototype.cancel=function(after){after=this.toTicks(after);this._forEach(function(event){event.cancel(after)});this._state.cancel(after);return this};Tone.Part.prototype._forEach=function(callback,ctx){ctx=this.defaultArg(ctx,this);for(var i=this._events.length-1;i>=0;i--){var e=this._events[i];if(e instanceof Tone.Part){e._forEach(callback,ctx)}else{callback.call(ctx,e)}}return this};Tone.Part.prototype._setAll=function(attr,value){this._forEach(function(event){event[attr]=value})};Tone.Part.prototype._tick=function(time,value){if(!this.mute){this.callback(time,value)}};Tone.Part.prototype._testLoopBoundries=function(event){if(event.startOffset<this._loopStart||event.startOffset>=this._loopEnd){event.cancel(0)}else{if(event.state===Tone.State.Stopped){this._restartEvent(event)}}};Object.defineProperty(Tone.Part.prototype,"probability",{get:function(){return this._probability},set:function(prob){this._probability=prob;this._setAll("probability",prob)}});Object.defineProperty(Tone.Part.prototype,"humanize",{get:function(){return this._humanize},set:function(variation){this._humanize=variation;this._setAll("humanize",variation)}});Object.defineProperty(Tone.Part.prototype,"loop",{get:function(){return this._loop},set:function(loop){this._loop=loop;this._forEach(function(event){event._loopStart=this._loopStart;event._loopEnd=this._loopEnd;event.loop=loop;this._testLoopBoundries(event)})}});Object.defineProperty(Tone.Part.prototype,"loopEnd",{get:function(){return Tone.TransportTime(this._loopEnd,"i").toNotation()},set:function(loopEnd){this._loopEnd=this.toTicks(loopEnd);if(this._loop){this._forEach(function(event){event.loopEnd=loopEnd;this._testLoopBoundries(event)})}}});Object.defineProperty(Tone.Part.prototype,"loopStart",{get:function(){return Tone.TransportTime(this._loopStart,"i").toNotation()},set:function(loopStart){this._loopStart=this.toTicks(loopStart);if(this._loop){this._forEach(function(event){event.loopStart=this.loopStart;this._testLoopBoundries(event)})}}});Object.defineProperty(Tone.Part.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(rate){this._playbackRate=rate;this._setAll("playbackRate",rate)}});Object.defineProperty(Tone.Part.prototype,"length",{get:function(){return this._events.length}});Tone.Part.prototype.dispose=function(){this.removeAll();this._state.dispose();this._state=null;this.callback=null;this._events=null;return this};return Tone.Part});Module(function(Tone){Tone.Pattern=function(){var options=this.optionsObject(arguments,["callback","values","pattern"],Tone.Pattern.defaults);Tone.Loop.call(this,options);this._pattern=new Tone.CtrlPattern({values:options.values,type:options.pattern,index:options.index})};Tone.extend(Tone.Pattern,Tone.Loop);Tone.Pattern.defaults={pattern:Tone.CtrlPattern.Type.Up,values:[]};Tone.Pattern.prototype._tick=function(time){this.callback(time,this._pattern.value);this._pattern.next()};Object.defineProperty(Tone.Pattern.prototype,"index",{get:function(){return this._pattern.index},set:function(i){this._pattern.index=i}});Object.defineProperty(Tone.Pattern.prototype,"values",{get:function(){return this._pattern.values},set:function(vals){this._pattern.values=vals}});Object.defineProperty(Tone.Pattern.prototype,"value",{get:function(){return this._pattern.value}});Object.defineProperty(Tone.Pattern.prototype,"pattern",{get:function(){return this._pattern.type},set:function(pattern){this._pattern.type=pattern}});Tone.Pattern.prototype.dispose=function(){Tone.Loop.prototype.dispose.call(this);this._pattern.dispose();this._pattern=null};return Tone.Pattern});Module(function(Tone){Tone.Sequence=function(){var options=this.optionsObject(arguments,["callback","events","subdivision"],Tone.Sequence.defaults);var events=options.events;delete options.events;Tone.Part.call(this,options);this._subdivision=this.toTicks(options.subdivision);if(this.isUndef(options.loopEnd)&&!this.isUndef(events)){this._loopEnd=events.length*this._subdivision}this._loop=true;if(!this.isUndef(events)){for(var i=0;i<events.length;i++){this.add(i,events[i])}}};Tone.extend(Tone.Sequence,Tone.Part);Tone.Sequence.defaults={subdivision:"4n"};Object.defineProperty(Tone.Sequence.prototype,"subdivision",{get:function(){return Tone.Time(this._subdivision,"i").toNotation()}});Tone.Sequence.prototype.at=function(index,value){if(this.isArray(value)){this.remove(index)}return Tone.Part.prototype.at.call(this,this._indexTime(index),value)};Tone.Sequence.prototype.add=function(index,value){if(value===null){return this}if(this.isArray(value)){var subSubdivision=Math.round(this._subdivision/value.length);value=new Tone.Sequence(this._tick.bind(this),value,Tone.Time(subSubdivision,"i"))}Tone.Part.prototype.add.call(this,this._indexTime(index),value);return this};Tone.Sequence.prototype.remove=function(index,value){Tone.Part.prototype.remove.call(this,this._indexTime(index),value);return this};Tone.Sequence.prototype._indexTime=function(index){if(index instanceof Tone.TransportTime){return index}else{return Tone.TransportTime(index*this._subdivision+this.startOffset,"i")}};Tone.Sequence.prototype.dispose=function(){Tone.Part.prototype.dispose.call(this);return this};return Tone.Sequence});Module(function(Tone){Tone.PulseOscillator=function(){var options=this.optionsObject(arguments,["frequency","width"],Tone.Oscillator.defaults);Tone.Source.call(this,options);this.width=new Tone.Signal(options.width,Tone.Type.NormalRange);this._widthGate=new Tone.Gain;this._sawtooth=new Tone.Oscillator({frequency:options.frequency,detune:options.detune,type:"sawtooth",phase:options.phase});this.frequency=this._sawtooth.frequency;this.detune=this._sawtooth.detune;this._thresh=new Tone.WaveShaper(function(val){if(val<0){return-1}else{return 1}});this._sawtooth.chain(this._thresh,this.output);this.width.chain(this._widthGate,this._thresh);this._readOnly(["width","frequency","detune"])};Tone.extend(Tone.PulseOscillator,Tone.Oscillator);Tone.PulseOscillator.defaults={frequency:440,detune:0,phase:0,width:.2};Tone.PulseOscillator.prototype._start=function(time){time=this.toSeconds(time);this._sawtooth.start(time);this._widthGate.gain.setValueAtTime(1,time)};Tone.PulseOscillator.prototype._stop=function(time){time=this.toSeconds(time);this._sawtooth.stop(time);this._widthGate.gain.setValueAtTime(0,time)};Object.defineProperty(Tone.PulseOscillator.prototype,"phase",{get:function(){return this._sawtooth.phase},set:function(phase){this._sawtooth.phase=phase}});Object.defineProperty(Tone.PulseOscillator.prototype,"type",{get:function(){return"pulse"}});Object.defineProperty(Tone.PulseOscillator.prototype,"partials",{get:function(){return[]}});Tone.PulseOscillator.prototype.dispose=function(){Tone.Source.prototype.dispose.call(this);this._sawtooth.dispose();this._sawtooth=null;this._writable(["width","frequency","detune"]);this.width.dispose();this.width=null;this._widthGate.dispose();this._widthGate=null;this._thresh.dispose();this._thresh=null;this.frequency=null;this.detune=null;return this};return Tone.PulseOscillator});Module(function(Tone){Tone.PWMOscillator=function(){var options=this.optionsObject(arguments,["frequency","modulationFrequency"],Tone.PWMOscillator.defaults);Tone.Source.call(this,options);this._pulse=new Tone.PulseOscillator(options.modulationFrequency);this._pulse._sawtooth.type="sine";this._modulator=new Tone.Oscillator({frequency:options.frequency,detune:options.detune,phase:options.phase});this._scale=new Tone.Multiply(2);this.frequency=this._modulator.frequency;this.detune=this._modulator.detune;this.modulationFrequency=this._pulse.frequency;this._modulator.chain(this._scale,this._pulse.width);this._pulse.connect(this.output);this._readOnly(["modulationFrequency","frequency","detune"])};Tone.extend(Tone.PWMOscillator,Tone.Oscillator);Tone.PWMOscillator.defaults={frequency:440,detune:0,phase:0,modulationFrequency:.4};Tone.PWMOscillator.prototype._start=function(time){time=this.toSeconds(time);this._modulator.start(time);this._pulse.start(time)};Tone.PWMOscillator.prototype._stop=function(time){time=this.toSeconds(time);this._modulator.stop(time);this._pulse.stop(time)};Object.defineProperty(Tone.PWMOscillator.prototype,"type",{get:function(){return"pwm"}});Object.defineProperty(Tone.PWMOscillator.prototype,"partials",{get:function(){return[]}});Object.defineProperty(Tone.PWMOscillator.prototype,"phase",{get:function(){return this._modulator.phase},set:function(phase){this._modulator.phase=phase}});Tone.PWMOscillator.prototype.dispose=function(){Tone.Source.prototype.dispose.call(this);this._pulse.dispose();this._pulse=null;this._scale.dispose();this._scale=null;this._modulator.dispose();this._modulator=null;this._writable(["modulationFrequency","frequency","detune"]);this.frequency=null;this.detune=null;this.modulationFrequency=null;return this};return Tone.PWMOscillator});Module(function(Tone){Tone.FMOscillator=function(){var options=this.optionsObject(arguments,["frequency","type","modulationType"],Tone.FMOscillator.defaults);Tone.Source.call(this,options);this._carrier=new Tone.Oscillator(options.frequency,options.type);this.frequency=new Tone.Signal(options.frequency,Tone.Type.Frequency);this.detune=this._carrier.detune;this.detune.value=options.detune;this.modulationIndex=new Tone.Multiply(options.modulationIndex);this.modulationIndex.units=Tone.Type.Positive;this._modulator=new Tone.Oscillator(options.frequency,options.modulationType);this.harmonicity=new Tone.Multiply(options.harmonicity);this.harmonicity.units=Tone.Type.Positive;this._modulationNode=new Tone.Gain(0);this.frequency.connect(this._carrier.frequency);this.frequency.chain(this.harmonicity,this._modulator.frequency);this.frequency.chain(this.modulationIndex,this._modulationNode);this._modulator.connect(this._modulationNode.gain);this._modulationNode.connect(this._carrier.frequency);this._carrier.connect(this.output);this.detune.connect(this._modulator.detune);this.phase=options.phase;this._readOnly(["modulationIndex","frequency","detune","harmonicity"])};Tone.extend(Tone.FMOscillator,Tone.Oscillator);Tone.FMOscillator.defaults={frequency:440,detune:0,phase:0,modulationIndex:2,modulationType:"square",harmonicity:1};Tone.FMOscillator.prototype._start=function(time){time=this.toSeconds(time);this._modulator.start(time);this._carrier.start(time)};Tone.FMOscillator.prototype._stop=function(time){time=this.toSeconds(time);this._modulator.stop(time);this._carrier.stop(time)};Object.defineProperty(Tone.FMOscillator.prototype,"type",{get:function(){return this._carrier.type},set:function(type){this._carrier.type=type}});Object.defineProperty(Tone.FMOscillator.prototype,"modulationType",{get:function(){return this._modulator.type},set:function(type){this._modulator.type=type}});Object.defineProperty(Tone.FMOscillator.prototype,"phase",{get:function(){return this._carrier.phase},set:function(phase){this._carrier.phase=phase;this._modulator.phase=phase}});Object.defineProperty(Tone.FMOscillator.prototype,"partials",{get:function(){return this._carrier.partials},set:function(partials){this._carrier.partials=partials}});Tone.FMOscillator.prototype.dispose=function(){Tone.Source.prototype.dispose.call(this);this._writable(["modulationIndex","frequency","detune","harmonicity"]);this.frequency.dispose();this.frequency=null;this.detune=null;this.harmonicity.dispose();this.harmonicity=null;this._carrier.dispose();this._carrier=null;this._modulator.dispose();this._modulator=null;this._modulationNode.dispose();this._modulationNode=null;this.modulationIndex.dispose();this.modulationIndex=null;return this};return Tone.FMOscillator});Module(function(Tone){Tone.AMOscillator=function(){var options=this.optionsObject(arguments,["frequency","type","modulationType"],Tone.AMOscillator.defaults);Tone.Source.call(this,options);this._carrier=new Tone.Oscillator(options.frequency,options.type);this.frequency=this._carrier.frequency;this.detune=this._carrier.detune;this.detune.value=options.detune;this._modulator=new Tone.Oscillator(options.frequency,options.modulationType);this._modulationScale=new Tone.AudioToGain;this.harmonicity=new Tone.Multiply(options.harmonicity);this.harmonicity.units=Tone.Type.Positive;this._modulationNode=new Tone.Gain(0);this.frequency.chain(this.harmonicity,this._modulator.frequency);this.detune.connect(this._modulator.detune);this._modulator.chain(this._modulationScale,this._modulationNode.gain);this._carrier.chain(this._modulationNode,this.output);this.phase=options.phase;this._readOnly(["frequency","detune","harmonicity"])};Tone.extend(Tone.AMOscillator,Tone.Oscillator);Tone.AMOscillator.defaults={frequency:440,detune:0,phase:0,modulationType:"square",harmonicity:1};Tone.AMOscillator.prototype._start=function(time){time=this.toSeconds(time);this._modulator.start(time);this._carrier.start(time)};Tone.AMOscillator.prototype._stop=function(time){time=this.toSeconds(time);this._modulator.stop(time);this._carrier.stop(time)};Object.defineProperty(Tone.AMOscillator.prototype,"type",{get:function(){return this._carrier.type},set:function(type){this._carrier.type=type}});Object.defineProperty(Tone.AMOscillator.prototype,"modulationType",{get:function(){return this._modulator.type},set:function(type){this._modulator.type=type}});Object.defineProperty(Tone.AMOscillator.prototype,"phase",{get:function(){return this._carrier.phase},set:function(phase){this._carrier.phase=phase;this._modulator.phase=phase}});Object.defineProperty(Tone.AMOscillator.prototype,"partials",{get:function(){return this._carrier.partials},set:function(partials){this._carrier.partials=partials}});Tone.AMOscillator.prototype.dispose=function(){Tone.Source.prototype.dispose.call(this);this._writable(["frequency","detune","harmonicity"]);this.frequency=null;this.detune=null;this.harmonicity.dispose();this.harmonicity=null;this._carrier.dispose();this._carrier=null;this._modulator.dispose();this._modulator=null;this._modulationNode.dispose();this._modulationNode=null;this._modulationScale.dispose();this._modulationScale=null;return this};return Tone.AMOscillator});Module(function(Tone){Tone.FatOscillator=function(){var options=this.optionsObject(arguments,["frequency","type","spread"],Tone.FatOscillator.defaults);Tone.Source.call(this,options);this.frequency=new Tone.Signal(options.frequency,Tone.Type.Frequency);this.detune=new Tone.Signal(options.detune,Tone.Type.Cents);this._oscillators=[];this._spread=options.spread;this._type=options.type;this._phase=options.phase;this._partials=this.defaultArg(options.partials,[]);this.count=options.count;this._readOnly(["frequency","detune"])};Tone.extend(Tone.FatOscillator,Tone.Oscillator);Tone.FatOscillator.defaults={frequency:440,detune:0,phase:0,spread:20,count:3,type:"sawtooth"};Tone.FatOscillator.prototype._start=function(time){time=this.toSeconds(time);this._forEach(function(osc){osc.start(time)})};Tone.FatOscillator.prototype._stop=function(time){time=this.toSeconds(time);this._forEach(function(osc){osc.stop(time)})};Tone.FatOscillator.prototype._forEach=function(iterator){for(var i=0;i<this._oscillators.length;i++){iterator.call(this,this._oscillators[i],i)}};Object.defineProperty(Tone.FatOscillator.prototype,"type",{get:function(){return this._type},set:function(type){this._type=type;this._forEach(function(osc){osc.type=type})}});Object.defineProperty(Tone.FatOscillator.prototype,"spread",{get:function(){return this._spread},set:function(spread){this._spread=spread;if(this._oscillators.length>1){var start=-spread/2;var step=spread/(this._oscillators.length-1);this._forEach(function(osc,i){osc.detune.value=start+step*i})}}});Object.defineProperty(Tone.FatOscillator.prototype,"count",{get:function(){return this._oscillators.length},set:function(count){count=Math.max(count,1);if(this._oscillators.length!==count){this._forEach(function(osc){osc.dispose()});this._oscillators=[];for(var i=0;i<count;i++){var osc=new Tone.Oscillator;if(this.type===Tone.Oscillator.Type.Custom){osc.partials=this._partials}else{osc.type=this._type}osc.phase=this._phase;osc.volume.value=-6-count;this.frequency.connect(osc.frequency);this.detune.connect(osc.detune);osc.connect(this.output);this._oscillators[i]=osc}this.spread=this._spread;if(this.state===Tone.State.Started){this._forEach(function(osc){osc.start()})}}}});Object.defineProperty(Tone.FatOscillator.prototype,"phase",{get:function(){return this._phase},set:function(phase){this._phase=phase;this._forEach(function(osc){osc.phase=phase})}});Object.defineProperty(Tone.FatOscillator.prototype,"partials",{get:function(){return this._partials},set:function(partials){this._partials=partials;this._type=Tone.Oscillator.Type.Custom;this._forEach(function(osc){osc.partials=partials})}});Tone.FatOscillator.prototype.dispose=function(){Tone.Source.prototype.dispose.call(this);this._writable(["frequency","detune"]);this.frequency.dispose();this.frequency=null;this.detune.dispose();this.detune=null;this._forEach(function(osc){osc.dispose()});this._oscillators=null;this._partials=null;return this};return Tone.FatOscillator});Module(function(Tone){Tone.OmniOscillator=function(){var options=this.optionsObject(arguments,["frequency","type"],Tone.OmniOscillator.defaults);Tone.Source.call(this,options);this.frequency=new Tone.Signal(options.frequency,Tone.Type.Frequency);this.detune=new Tone.Signal(options.detune,Tone.Type.Cents);this._sourceType=undefined;this._oscillator=null;this.type=options.type;this._readOnly(["frequency","detune"]);this.set(options)};Tone.extend(Tone.OmniOscillator,Tone.Oscillator);Tone.OmniOscillator.defaults={frequency:440,detune:0,type:"sine",phase:0};var OmniOscType={Pulse:"PulseOscillator",PWM:"PWMOscillator",Osc:"Oscillator",FM:"FMOscillator",AM:"AMOscillator",Fat:"FatOscillator"};Tone.OmniOscillator.prototype._start=function(time){this._oscillator.start(time)};Tone.OmniOscillator.prototype._stop=function(time){this._oscillator.stop(time)};Object.defineProperty(Tone.OmniOscillator.prototype,"type",{get:function(){var prefix="";if(this._sourceType===OmniOscType.FM){prefix="fm"}else if(this._sourceType===OmniOscType.AM){prefix="am"}else if(this._sourceType===OmniOscType.Fat){prefix="fat"}return prefix+this._oscillator.type},set:function(type){if(type.substr(0,2)==="fm"){this._createNewOscillator(OmniOscType.FM);this._oscillator.type=type.substr(2)}else if(type.substr(0,2)==="am"){this._createNewOscillator(OmniOscType.AM);this._oscillator.type=type.substr(2)}else if(type.substr(0,3)==="fat"){this._createNewOscillator(OmniOscType.Fat);this._oscillator.type=type.substr(3)}else if(type==="pwm"){this._createNewOscillator(OmniOscType.PWM)}else if(type==="pulse"){this._createNewOscillator(OmniOscType.Pulse)}else{this._createNewOscillator(OmniOscType.Osc);this._oscillator.type=type}}});Object.defineProperty(Tone.OmniOscillator.prototype,"partials",{get:function(){return this._oscillator.partials},set:function(partials){this._oscillator.partials=partials}});Tone.OmniOscillator.prototype.set=function(params,value){if(params==="type"){this.type=value}else if(this.isObject(params)&&params.hasOwnProperty("type")){this.type=params.type}Tone.prototype.set.apply(this,arguments);return this};Tone.OmniOscillator.prototype._createNewOscillator=function(oscType){if(oscType!==this._sourceType){this._sourceType=oscType;var OscillatorConstructor=Tone[oscType];var now=this.now()+this.blockTime;if(this._oscillator!==null){var oldOsc=this._oscillator;oldOsc.stop(now);setTimeout(function(){oldOsc.dispose();oldOsc=null},this.blockTime*1e3)}this._oscillator=new OscillatorConstructor;this.frequency.connect(this._oscillator.frequency);this.detune.connect(this._oscillator.detune);this._oscillator.connect(this.output);if(this.state===Tone.State.Started){this._oscillator.start(now)}}};Object.defineProperty(Tone.OmniOscillator.prototype,"phase",{get:function(){return this._oscillator.phase},set:function(phase){this._oscillator.phase=phase}});Object.defineProperty(Tone.OmniOscillator.prototype,"width",{get:function(){if(this._sourceType===OmniOscType.Pulse){return this._oscillator.width}}});Object.defineProperty(Tone.OmniOscillator.prototype,"count",{get:function(){if(this._sourceType===OmniOscType.Fat){return this._oscillator.count}},set:function(count){if(this._sourceType===OmniOscType.Fat){this._oscillator.count=count}}});Object.defineProperty(Tone.OmniOscillator.prototype,"spread",{get:function(){if(this._sourceType===OmniOscType.Fat){return this._oscillator.spread}},set:function(spread){if(this._sourceType===OmniOscType.Fat){this._oscillator.spread=spread}}});Object.defineProperty(Tone.OmniOscillator.prototype,"modulationType",{get:function(){if(this._sourceType===OmniOscType.FM||this._sourceType===OmniOscType.AM){return this._oscillator.modulationType}},set:function(mType){if(this._sourceType===OmniOscType.FM||this._sourceType===OmniOscType.AM){this._oscillator.modulationType=mType}}});Object.defineProperty(Tone.OmniOscillator.prototype,"modulationIndex",{get:function(){if(this._sourceType===OmniOscType.FM){return this._oscillator.modulationIndex}}});Object.defineProperty(Tone.OmniOscillator.prototype,"harmonicity",{get:function(){if(this._sourceType===OmniOscType.FM||this._sourceType===OmniOscType.AM){return this._oscillator.harmonicity}}});Object.defineProperty(Tone.OmniOscillator.prototype,"modulationFrequency",{get:function(){if(this._sourceType===OmniOscType.PWM){return this._oscillator.modulationFrequency}}});Tone.OmniOscillator.prototype.dispose=function(){Tone.Source.prototype.dispose.call(this);this._writable(["frequency","detune"]);this.detune.dispose();this.detune=null;this.frequency.dispose();this.frequency=null;this._oscillator.dispose();this._oscillator=null;this._sourceType=null;return this};return Tone.OmniOscillator});Module(function(Tone){Tone.Instrument=function(options){options=this.defaultArg(options,Tone.Instrument.defaults);this._volume=this.output=new Tone.Volume(options.volume);this.volume=this._volume.volume;this._readOnly("volume")};Tone.extend(Tone.Instrument);Tone.Instrument.defaults={volume:0};Tone.Instrument.prototype.triggerAttack=Tone.noOp;Tone.Instrument.prototype.triggerRelease=Tone.noOp;Tone.Instrument.prototype.triggerAttackRelease=function(note,duration,time,velocity){if(this.isUndef(time)){time=this.now()+this.blockTime}else{time=this.toSeconds(time)}duration=this.toSeconds(duration);this.triggerAttack(note,time,velocity);this.triggerRelease(time+duration);return this};Tone.Instrument.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._volume.dispose();this._volume=null;this._writable(["volume"]);this.volume=null;return this};return Tone.Instrument});Module(function(Tone){Tone.Monophonic=function(options){options=this.defaultArg(options,Tone.Monophonic.defaults);Tone.Instrument.call(this,options);this.portamento=options.portamento};Tone.extend(Tone.Monophonic,Tone.Instrument);Tone.Monophonic.defaults={portamento:0};Tone.Monophonic.prototype.triggerAttack=function(note,time,velocity){if(this.isUndef(time)){time=this.now()+this.blockTime}else{time=this.toSeconds(time)}this._triggerEnvelopeAttack(time,velocity);this.setNote(note,time);return this};Tone.Monophonic.prototype.triggerRelease=function(time){if(this.isUndef(time)){time=this.now()+this.blockTime}else{time=this.toSeconds(time)}this._triggerEnvelopeRelease(time);return this};Tone.Monophonic.prototype._triggerEnvelopeAttack=function(){};Tone.Monophonic.prototype._triggerEnvelopeRelease=function(){};Tone.Monophonic.prototype.setNote=function(note,time){time=this.toSeconds(time);if(this.portamento>0){var currentNote=this.frequency.value;this.frequency.setValueAtTime(currentNote,time);var portTime=this.toSeconds(this.portamento);this.frequency.exponentialRampToValueAtTime(note,time+portTime)}else{this.frequency.setValueAtTime(note,time)}return this};return Tone.Monophonic});Module(function(Tone){Tone.Synth=function(options){options=this.defaultArg(options,Tone.Synth.defaults);Tone.Monophonic.call(this,options);this.oscillator=new Tone.OmniOscillator(options.oscillator);this.frequency=this.oscillator.frequency;this.detune=this.oscillator.detune;this.envelope=new Tone.AmplitudeEnvelope(options.envelope);this.oscillator.chain(this.envelope,this.output);this.oscillator.start();this._readOnly(["oscillator","frequency","detune","envelope"])};Tone.extend(Tone.Synth,Tone.Monophonic);Tone.Synth.defaults={oscillator:{type:"triangle"},envelope:{attack:.005,decay:.1,sustain:.3,release:1}};Tone.Synth.prototype._triggerEnvelopeAttack=function(time,velocity){this.envelope.triggerAttack(time,velocity);return this};Tone.Synth.prototype._triggerEnvelopeRelease=function(time){this.envelope.triggerRelease(time);return this};Tone.Synth.prototype.dispose=function(){Tone.Monophonic.prototype.dispose.call(this);this._writable(["oscillator","frequency","detune","envelope"]);this.oscillator.dispose();this.oscillator=null;this.envelope.dispose();this.envelope=null;this.frequency=null;this.detune=null;return this};return Tone.Synth});Module(function(Tone){Tone.AMSynth=function(options){options=this.defaultArg(options,Tone.AMSynth.defaults);Tone.Monophonic.call(this,options);this._carrier=new Tone.Synth;this._carrier.volume.value=-10;this.oscillator=this._carrier.oscillator;this.envelope=this._carrier.envelope.set(options.envelope);this._modulator=new Tone.Synth;this._modulator.volume.value=-10;this.modulation=this._modulator.oscillator.set(options.modulation);this.modulationEnvelope=this._modulator.envelope.set(options.modulationEnvelope);this.frequency=new Tone.Signal(440,Tone.Type.Frequency);this.detune=new Tone.Signal(options.detune,Tone.Type.Cents);this.harmonicity=new Tone.Multiply(options.harmonicity);this.harmonicity.units=Tone.Type.Positive;this._modulationScale=new Tone.AudioToGain;this._modulationNode=new Tone.Gain;this.frequency.connect(this._carrier.frequency);this.frequency.chain(this.harmonicity,this._modulator.frequency);this.detune.fan(this._carrier.detune,this._modulator.detune);this._modulator.chain(this._modulationScale,this._modulationNode.gain);this._carrier.chain(this._modulationNode,this.output);this._readOnly(["frequency","harmonicity","oscillator","envelope","modulation","modulationEnvelope","detune"])};Tone.extend(Tone.AMSynth,Tone.Monophonic);Tone.AMSynth.defaults={harmonicity:3,detune:0,oscillator:{type:"sine"},envelope:{attack:.01,decay:.01,sustain:1,release:.5},modulation:{type:"square"},modulationEnvelope:{attack:.5,decay:0,sustain:1,release:.5}};Tone.AMSynth.prototype._triggerEnvelopeAttack=function(time,velocity){time=this.toSeconds(time);this.envelope.triggerAttack(time,velocity);this.modulationEnvelope.triggerAttack(time,velocity);return this};Tone.AMSynth.prototype._triggerEnvelopeRelease=function(time){this.envelope.triggerRelease(time);this.modulationEnvelope.triggerRelease(time);return this};Tone.AMSynth.prototype.dispose=function(){Tone.Monophonic.prototype.dispose.call(this);this._writable(["frequency","harmonicity","oscillator","envelope","modulation","modulationEnvelope","detune"]);this._carrier.dispose();this._carrier=null;this._modulator.dispose();this._modulator=null;this.frequency.dispose();this.frequency=null;this.detune.dispose();this.detune=null;this.harmonicity.dispose();this.harmonicity=null;this._modulationScale.dispose();this._modulationScale=null;this._modulationNode.dispose();this._modulationNode=null;this.oscillator=null;this.envelope=null;this.modulationEnvelope=null;this.modulation=null;return this};return Tone.AMSynth});Module(function(Tone){Tone.MonoSynth=function(options){options=this.defaultArg(options,Tone.MonoSynth.defaults);Tone.Monophonic.call(this,options);this.oscillator=new Tone.OmniOscillator(options.oscillator);this.frequency=this.oscillator.frequency;this.detune=this.oscillator.detune;this.filter=new Tone.Filter(options.filter);this.filterEnvelope=new Tone.FrequencyEnvelope(options.filterEnvelope);this.envelope=new Tone.AmplitudeEnvelope(options.envelope);this.oscillator.chain(this.filter,this.envelope,this.output);this.oscillator.start();this.filterEnvelope.connect(this.filter.frequency);this._readOnly(["oscillator","frequency","detune","filter","filterEnvelope","envelope"])};Tone.extend(Tone.MonoSynth,Tone.Monophonic);Tone.MonoSynth.defaults={frequency:"C4",detune:0,oscillator:{type:"square"},filter:{Q:6,type:"lowpass",rolloff:-24},envelope:{attack:.005,decay:.1,sustain:.9,release:1},filterEnvelope:{attack:.06,decay:.2,sustain:.5,release:2,baseFrequency:200,octaves:7,exponent:2}};Tone.MonoSynth.prototype._triggerEnvelopeAttack=function(time,velocity){this.envelope.triggerAttack(time,velocity);this.filterEnvelope.triggerAttack(time);return this};Tone.MonoSynth.prototype._triggerEnvelopeRelease=function(time){this.envelope.triggerRelease(time);this.filterEnvelope.triggerRelease(time);return this};Tone.MonoSynth.prototype.dispose=function(){Tone.Monophonic.prototype.dispose.call(this);this._writable(["oscillator","frequency","detune","filter","filterEnvelope","envelope"]);this.oscillator.dispose();this.oscillator=null;this.envelope.dispose();this.envelope=null;this.filterEnvelope.dispose();this.filterEnvelope=null;this.filter.dispose();this.filter=null;this.frequency=null;this.detune=null;return this};return Tone.MonoSynth});Module(function(Tone){Tone.DuoSynth=function(options){options=this.defaultArg(options,Tone.DuoSynth.defaults);
Tone.Monophonic.call(this,options);this.voice0=new Tone.MonoSynth(options.voice0);this.voice0.volume.value=-10;this.voice1=new Tone.MonoSynth(options.voice1);this.voice1.volume.value=-10;this._vibrato=new Tone.LFO(options.vibratoRate,-50,50);this._vibrato.start();this.vibratoRate=this._vibrato.frequency;this._vibratoGain=new Tone.Gain(options.vibratoAmount,Tone.Type.Positive);this.vibratoAmount=this._vibratoGain.gain;this.frequency=new Tone.Signal(440,Tone.Type.Frequency);this.harmonicity=new Tone.Multiply(options.harmonicity);this.harmonicity.units=Tone.Type.Positive;this.frequency.connect(this.voice0.frequency);this.frequency.chain(this.harmonicity,this.voice1.frequency);this._vibrato.connect(this._vibratoGain);this._vibratoGain.fan(this.voice0.detune,this.voice1.detune);this.voice0.connect(this.output);this.voice1.connect(this.output);this._readOnly(["voice0","voice1","frequency","vibratoAmount","vibratoRate"])};Tone.extend(Tone.DuoSynth,Tone.Monophonic);Tone.DuoSynth.defaults={vibratoAmount:.5,vibratoRate:5,harmonicity:1.5,voice0:{volume:-10,portamento:0,oscillator:{type:"sine"},filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}},voice1:{volume:-10,portamento:0,oscillator:{type:"sine"},filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}}};Tone.DuoSynth.prototype._triggerEnvelopeAttack=function(time,velocity){time=this.toSeconds(time);this.voice0.envelope.triggerAttack(time,velocity);this.voice1.envelope.triggerAttack(time,velocity);this.voice0.filterEnvelope.triggerAttack(time);this.voice1.filterEnvelope.triggerAttack(time);return this};Tone.DuoSynth.prototype._triggerEnvelopeRelease=function(time){this.voice0.triggerRelease(time);this.voice1.triggerRelease(time);return this};Tone.DuoSynth.prototype.dispose=function(){Tone.Monophonic.prototype.dispose.call(this);this._writable(["voice0","voice1","frequency","vibratoAmount","vibratoRate"]);this.voice0.dispose();this.voice0=null;this.voice1.dispose();this.voice1=null;this.frequency.dispose();this.frequency=null;this._vibratoGain.dispose();this._vibratoGain=null;this._vibrato=null;this.harmonicity.dispose();this.harmonicity=null;this.vibratoAmount.dispose();this.vibratoAmount=null;this.vibratoRate=null;return this};return Tone.DuoSynth});Module(function(Tone){Tone.FMSynth=function(options){options=this.defaultArg(options,Tone.FMSynth.defaults);Tone.Monophonic.call(this,options);this._carrier=new Tone.Synth(options.carrier);this._carrier.volume.value=-10;this.oscillator=this._carrier.oscillator;this.envelope=this._carrier.envelope.set(options.envelope);this._modulator=new Tone.Synth(options.modulator);this._modulator.volume.value=-10;this.modulation=this._modulator.oscillator.set(options.modulation);this.modulationEnvelope=this._modulator.envelope.set(options.modulationEnvelope);this.frequency=new Tone.Signal(440,Tone.Type.Frequency);this.detune=new Tone.Signal(options.detune,Tone.Type.Cents);this.harmonicity=new Tone.Multiply(options.harmonicity);this.harmonicity.units=Tone.Type.Positive;this.modulationIndex=new Tone.Multiply(options.modulationIndex);this.modulationIndex.units=Tone.Type.Positive;this._modulationNode=new Tone.Gain(0);this.frequency.connect(this._carrier.frequency);this.frequency.chain(this.harmonicity,this._modulator.frequency);this.frequency.chain(this.modulationIndex,this._modulationNode);this.detune.fan(this._carrier.detune,this._modulator.detune);this._modulator.connect(this._modulationNode.gain);this._modulationNode.connect(this._carrier.frequency);this._carrier.connect(this.output);this._readOnly(["frequency","harmonicity","modulationIndex","oscillator","envelope","modulation","modulationEnvelope","detune"])};Tone.extend(Tone.FMSynth,Tone.Monophonic);Tone.FMSynth.defaults={harmonicity:3,modulationIndex:10,detune:0,oscillator:{type:"sine"},envelope:{attack:.01,decay:.01,sustain:1,release:.5},modulation:{type:"square"},modulationEnvelope:{attack:.5,decay:0,sustain:1,release:.5}};Tone.FMSynth.prototype._triggerEnvelopeAttack=function(time,velocity){time=this.toSeconds(time);this.envelope.triggerAttack(time,velocity);this.modulationEnvelope.triggerAttack(time);return this};Tone.FMSynth.prototype._triggerEnvelopeRelease=function(time){time=this.toSeconds(time);this.envelope.triggerRelease(time);this.modulationEnvelope.triggerRelease(time);return this};Tone.FMSynth.prototype.dispose=function(){Tone.Monophonic.prototype.dispose.call(this);this._writable(["frequency","harmonicity","modulationIndex","oscillator","envelope","modulation","modulationEnvelope","detune"]);this._carrier.dispose();this._carrier=null;this._modulator.dispose();this._modulator=null;this.frequency.dispose();this.frequency=null;this.detune.dispose();this.detune=null;this.modulationIndex.dispose();this.modulationIndex=null;this.harmonicity.dispose();this.harmonicity=null;this._modulationNode.dispose();this._modulationNode=null;this.oscillator=null;this.envelope=null;this.modulationEnvelope=null;this.modulation=null;return this};return Tone.FMSynth});Module(function(Tone){Tone.MembraneSynth=function(options){options=this.defaultArg(options,Tone.MembraneSynth.defaults);Tone.Instrument.call(this,options);this.oscillator=new Tone.OmniOscillator(options.oscillator).start();this.envelope=new Tone.AmplitudeEnvelope(options.envelope);this.octaves=options.octaves;this.pitchDecay=options.pitchDecay;this.oscillator.chain(this.envelope,this.output);this._readOnly(["oscillator","envelope"])};Tone.extend(Tone.MembraneSynth,Tone.Instrument);Tone.MembraneSynth.defaults={pitchDecay:.05,octaves:10,oscillator:{type:"sine"},envelope:{attack:.001,decay:.4,sustain:.01,release:1.4,attackCurve:"exponential"}};Tone.MembraneSynth.prototype.triggerAttack=function(note,time,velocity){time=this.toSeconds(time);note=this.toFrequency(note);var maxNote=note*this.octaves;this.oscillator.frequency.setValueAtTime(maxNote,time);this.oscillator.frequency.exponentialRampToValueAtTime(note,time+this.toSeconds(this.pitchDecay));this.envelope.triggerAttack(time,velocity);return this};Tone.MembraneSynth.prototype.triggerRelease=function(time){this.envelope.triggerRelease(time);return this};Tone.MembraneSynth.prototype.dispose=function(){Tone.Instrument.prototype.dispose.call(this);this._writable(["oscillator","envelope"]);this.oscillator.dispose();this.oscillator=null;this.envelope.dispose();this.envelope=null;return this};return Tone.MembraneSynth});Module(function(Tone){var inharmRatios=[1,1.483,1.932,2.546,2.63,3.897];Tone.MetalSynth=function(options){options=this.defaultArg(options,Tone.MetalSynth.defaults);Tone.Instrument.call(this,options);this.frequency=new Tone.Signal(options.frequency,Tone.Type.Frequency);this._oscillators=[];this._freqMultipliers=[];this._amplitue=new Tone.Gain(0).connect(this.output);this._highpass=new Tone.Filter({type:"highpass",Q:-3.0102999566398125}).connect(this._amplitue);this._octaves=options.octaves;this._filterFreqScaler=new Tone.Scale(options.resonance,7e3);this.envelope=new Tone.Envelope({attack:options.envelope.attack,attackCurve:"linear",decay:options.envelope.decay,sustain:0,release:options.envelope.release}).chain(this._filterFreqScaler,this._highpass.frequency);this.envelope.connect(this._amplitue.gain);for(var i=0;i<inharmRatios.length;i++){var osc=new Tone.FMOscillator({type:"square",modulationType:"square",harmonicity:options.harmonicity,modulationIndex:options.modulationIndex});osc.connect(this._highpass).start(0);this._oscillators[i]=osc;var mult=new Tone.Multiply(inharmRatios[i]);this._freqMultipliers[i]=mult;this.frequency.chain(mult,osc.frequency)}this.octaves=options.octaves};Tone.extend(Tone.MetalSynth,Tone.Instrument);Tone.MetalSynth.defaults={frequency:200,envelope:{attack:.001,decay:1.4,release:.2},harmonicity:5.1,modulationIndex:32,resonance:4e3,octaves:1.5};Tone.MetalSynth.prototype.triggerAttack=function(time,vel){time=this.toSeconds(time);vel=this.defaultArg(vel,1);this.envelope.triggerAttack(time,vel);return this};Tone.MetalSynth.prototype.triggerRelease=function(time){time=this.toSeconds(time);this.envelope.triggerRelease(time);return this};Tone.MetalSynth.prototype.triggerAttackRelease=function(duration,time,velocity){time=this.toSeconds(time);duration=this.toSeconds(duration);this.triggerAttack(time,velocity);this.triggerRelease(time+duration);return this};Object.defineProperty(Tone.MetalSynth.prototype,"modulationIndex",{get:function(){return this._oscillators[0].modulationIndex.value},set:function(val){for(var i=0;i<this._oscillators.length;i++){this._oscillators[i].modulationIndex.value=val}}});Object.defineProperty(Tone.MetalSynth.prototype,"harmonicity",{get:function(){return this._oscillators[0].harmonicity.value},set:function(val){for(var i=0;i<this._oscillators.length;i++){this._oscillators[i].harmonicity.value=val}}});Object.defineProperty(Tone.MetalSynth.prototype,"resonance",{get:function(){return this._filterFreqScaler.min},set:function(val){this._filterFreqScaler.min=val;this.octaves=this._octaves}});Object.defineProperty(Tone.MetalSynth.prototype,"octaves",{get:function(){return this._octaves},set:function(octs){this._octaves=octs;this._filterFreqScaler.max=this._filterFreqScaler.min*Math.pow(2,octs)}});Tone.MetalSynth.prototype.dispose=function(){Tone.Instrument.prototype.dispose.call(this);for(var i=0;i<this._oscillators.length;i++){this._oscillators[i].dispose();this._freqMultipliers[i].dispose()}this._oscillators=null;this._freqMultipliers=null;this.frequency.dispose();this.frequency=null;this._filterFreqScaler.dispose();this._filterFreqScaler=null;this._amplitue.dispose();this._amplitue=null;this.envelope.dispose();this.envelope=null;this._highpass.dispose();this._highpass=null};return Tone.MetalSynth});Module(function(Tone){Tone.Noise=function(){var options=this.optionsObject(arguments,["type"],Tone.Noise.defaults);Tone.Source.call(this,options);this._source=null;this._buffer=null;this._playbackRate=options.playbackRate;this.type=options.type};Tone.extend(Tone.Noise,Tone.Source);Tone.Noise.defaults={type:"white",playbackRate:1};Object.defineProperty(Tone.Noise.prototype,"type",{get:function(){if(this._buffer===_whiteNoise){return"white"}else if(this._buffer===_brownNoise){return"brown"}else if(this._buffer===_pinkNoise){return"pink"}},set:function(type){if(this.type!==type){switch(type){case"white":this._buffer=_whiteNoise;break;case"pink":this._buffer=_pinkNoise;break;case"brown":this._buffer=_brownNoise;break;default:throw new TypeError("Tone.Noise: invalid type: "+type)}if(this.state===Tone.State.Started){var now=this.now()+this.blockTime;this._stop(now);this._start(now)}}}});Object.defineProperty(Tone.Noise.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(rate){this._playbackRate=rate;if(this._source){this._source.playbackRate.value=rate}}});Tone.Noise.prototype._start=function(time){this._source=this.context.createBufferSource();this._source.buffer=this._buffer;this._source.loop=true;this._source.playbackRate.value=this._playbackRate;this._source.connect(this.output);this._source.start(this.toSeconds(time),Math.random()*(this._buffer.duration-.001))};Tone.Noise.prototype._stop=function(time){if(this._source){this._source.stop(this.toSeconds(time))}};Tone.Noise.prototype.dispose=function(){Tone.Source.prototype.dispose.call(this);if(this._source!==null){this._source.disconnect();this._source=null}this._buffer=null;return this};var _pinkNoise=null,_brownNoise=null,_whiteNoise=null;Tone._initAudioContext(function(audioContext){var sampleRate=audioContext.sampleRate;var bufferLength=sampleRate*4;_pinkNoise=function(){var buffer=audioContext.createBuffer(2,bufferLength,sampleRate);for(var channelNum=0;channelNum<buffer.numberOfChannels;channelNum++){var channel=buffer.getChannelData(channelNum);var b0,b1,b2,b3,b4,b5,b6;b0=b1=b2=b3=b4=b5=b6=0;for(var i=0;i<bufferLength;i++){var white=Math.random()*2-1;b0=.99886*b0+white*.0555179;b1=.99332*b1+white*.0750759;b2=.969*b2+white*.153852;b3=.8665*b3+white*.3104856;b4=.55*b4+white*.5329522;b5=-.7616*b5-white*.016898;channel[i]=b0+b1+b2+b3+b4+b5+b6+white*.5362;channel[i]*=.11;b6=white*.115926}}return buffer}();_brownNoise=function(){var buffer=audioContext.createBuffer(2,bufferLength,sampleRate);for(var channelNum=0;channelNum<buffer.numberOfChannels;channelNum++){var channel=buffer.getChannelData(channelNum);var lastOut=0;for(var i=0;i<bufferLength;i++){var white=Math.random()*2-1;channel[i]=(lastOut+.02*white)/1.02;lastOut=channel[i];channel[i]*=3.5}}return buffer}();_whiteNoise=function(){var buffer=audioContext.createBuffer(2,bufferLength,sampleRate);for(var channelNum=0;channelNum<buffer.numberOfChannels;channelNum++){var channel=buffer.getChannelData(channelNum);for(var i=0;i<bufferLength;i++){channel[i]=Math.random()*2-1}}return buffer}()});return Tone.Noise});Module(function(Tone){Tone.NoiseSynth=function(options){options=this.defaultArg(options,Tone.NoiseSynth.defaults);Tone.Instrument.call(this,options);this.noise=new Tone.Noise;this.envelope=new Tone.AmplitudeEnvelope(options.envelope);this.noise.chain(this.envelope,this.output);this.noise.start();this._readOnly(["noise","envelope"])};Tone.extend(Tone.NoiseSynth,Tone.Instrument);Tone.NoiseSynth.defaults={noise:{type:"white"},envelope:{attack:.005,decay:.1,sustain:0}};Tone.NoiseSynth.prototype.triggerAttack=function(time,velocity){this.envelope.triggerAttack(time,velocity);return this};Tone.NoiseSynth.prototype.triggerRelease=function(time){this.envelope.triggerRelease(time);return this};Tone.NoiseSynth.prototype.triggerAttackRelease=function(duration,time,velocity){time=this.toSeconds(time);duration=this.toSeconds(duration);this.triggerAttack(time,velocity);this.triggerRelease(time+duration);return this};Tone.NoiseSynth.prototype.dispose=function(){Tone.Instrument.prototype.dispose.call(this);this._writable(["noise","envelope"]);this.noise.dispose();this.noise=null;this.envelope.dispose();this.envelope=null;return this};return Tone.NoiseSynth});Module(function(Tone){Tone.PluckSynth=function(options){options=this.defaultArg(options,Tone.PluckSynth.defaults);Tone.Instrument.call(this,options);this._noise=new Tone.Noise("pink");this.attackNoise=options.attackNoise;this._lfcf=new Tone.LowpassCombFilter({resonance:options.resonance,dampening:options.dampening});this.resonance=this._lfcf.resonance;this.dampening=this._lfcf.dampening;this._noise.connect(this._lfcf);this._lfcf.connect(this.output);this._readOnly(["resonance","dampening"])};Tone.extend(Tone.PluckSynth,Tone.Instrument);Tone.PluckSynth.defaults={attackNoise:1,dampening:4e3,resonance:.9};Tone.PluckSynth.prototype.triggerAttack=function(note,time){note=this.toFrequency(note);time=this.toSeconds(time);var delayAmount=1/note;this._lfcf.delayTime.setValueAtTime(delayAmount,time);this._noise.start(time);this._noise.stop(time+delayAmount*this.attackNoise);return this};Tone.PluckSynth.prototype.dispose=function(){Tone.Instrument.prototype.dispose.call(this);this._noise.dispose();this._lfcf.dispose();this._noise=null;this._lfcf=null;this._writable(["resonance","dampening"]);this.dampening=null;this.resonance=null;return this};return Tone.PluckSynth});Module(function(Tone){Tone.PolySynth=function(){Tone.Instrument.call(this);var options=this.optionsObject(arguments,["polyphony","voice"],Tone.PolySynth.defaults);options=this.defaultArg(options,Tone.Instrument.defaults);options.polyphony=Math.min(Tone.PolySynth.MAX_POLYPHONY,options.polyphony);this.voices=new Array(options.polyphony);this._triggers=new Array(options.polyphony);this.detune=new Tone.Signal(options.detune,Tone.Type.Cents);this._readOnly("detune");for(var i=0;i<options.polyphony;i++){var v=new options.voice(arguments[2],arguments[3]);this.voices[i]=v;v.connect(this.output);if(v.hasOwnProperty("detune")){this.detune.connect(v.detune)}this._triggers[i]={release:-1,note:null,voice:v}}this.volume.value=options.volume};Tone.extend(Tone.PolySynth,Tone.Instrument);Tone.PolySynth.defaults={polyphony:4,volume:0,detune:0,voice:Tone.Synth};Tone.PolySynth.prototype.triggerAttack=function(notes,time,velocity){if(!Array.isArray(notes)){notes=[notes]}time=this.toSeconds(time);for(var i=0;i<notes.length;i++){var val=notes[i];var oldest=this._triggers[0];var oldestIndex=0;for(var j=1;j<this._triggers.length;j++){if(this._triggers[j].release<oldest.release){oldest=this._triggers[j];oldestIndex=j}}oldest.release=Infinity;oldest.note=JSON.stringify(val);oldest.voice.triggerAttack(val,time,velocity)}return this};Tone.PolySynth.prototype.triggerAttackRelease=function(notes,duration,time,velocity){time=this.toSeconds(time);this.triggerAttack(notes,time,velocity);if(this.isArray(duration)&&this.isArray(notes)){for(var i=0;i<notes.length;i++){var d=duration[Math.min(i,duration.length-1)];this.triggerRelease(notes[i],time+this.toSeconds(d))}}else{this.triggerRelease(notes,time+this.toSeconds(duration))}return this};Tone.PolySynth.prototype.triggerRelease=function(notes,time){if(!Array.isArray(notes)){notes=[notes]}time=this.toSeconds(time);for(var i=0;i<notes.length;i++){var stringified=JSON.stringify(notes[i]);for(var v=0;v<this._triggers.length;v++){var desc=this._triggers[v];if(desc.note===stringified&&desc.release>time){desc.voice.triggerRelease(time);desc.release=time}}}return this};Tone.PolySynth.prototype.set=function(params,value,rampTime){for(var i=0;i<this.voices.length;i++){this.voices[i].set(params,value,rampTime)}return this};Tone.PolySynth.prototype.get=function(params){return this.voices[0].get(params)};Tone.PolySynth.prototype.releaseAll=function(time){time=this.toSeconds(time);for(var i=0;i<this._triggers.length;i++){var desc=this._triggers[i];if(desc.release>time){desc.release=time;desc.voice.triggerRelease(time)}}return this};Tone.PolySynth.prototype.dispose=function(){Tone.Instrument.prototype.dispose.call(this);for(var i=0;i<this.voices.length;i++){this.voices[i].dispose();this.voices[i]=null}this._writable("detune");this.detune.dispose();this.detune=null;this.voices=null;this._triggers=null;return this};Tone.PolySynth.MAX_POLYPHONY=20;return Tone.PolySynth});Module(function(Tone){Tone.Player=function(url){var options;if(url instanceof Tone.Buffer){url=url.get();options=Tone.Player.defaults}else{options=this.optionsObject(arguments,["url","onload"],Tone.Player.defaults)}Tone.Source.call(this,options);this._source=null;this.autostart=options.autostart;this._buffer=new Tone.Buffer({url:options.url,onload:this._onload.bind(this,options.onload),reverse:options.reverse});if(url instanceof AudioBuffer){this._buffer.set(url)}this._loop=options.loop;this._loopStart=options.loopStart;this._loopEnd=options.loopEnd;this._playbackRate=options.playbackRate;this.retrigger=options.retrigger};Tone.extend(Tone.Player,Tone.Source);Tone.Player.defaults={onload:Tone.noOp,playbackRate:1,loop:false,autostart:false,loopStart:0,loopEnd:0,retrigger:false,reverse:false};Tone.Player.prototype.load=function(url,callback){return this._buffer.load(url,this._onload.bind(this,callback))};Tone.Player.prototype._onload=function(callback){callback=this.defaultArg(callback,Tone.noOp);callback(this);if(this.autostart){this.start()}};Tone.Player.prototype._start=function(startTime,offset,duration){if(this._buffer.loaded){if(this._loop){offset=this.defaultArg(offset,this._loopStart)}else{offset=this.defaultArg(offset,0)}offset=this.toSeconds(offset);duration=this.defaultArg(duration,Math.max(this._buffer.duration-offset,0));duration=this.toSeconds(duration);startTime=this.toSeconds(startTime);this._source=this.context.createBufferSource();this._source.buffer=this._buffer.get();if(this._loop){this._source.loop=this._loop;this._source.loopStart=this.toSeconds(this._loopStart);this._source.loopEnd=this.toSeconds(this._loopEnd)}else{this._state.setStateAtTime(Tone.State.Stopped,startTime+duration)}this._source.playbackRate.value=this._playbackRate;this._source.connect(this.output);if(this._loop){var loopEnd=this._source.loopEnd||this._buffer.duration;var loopStart=this._source.loopStart;var loopDuration=loopEnd-loopStart;if(offset>loopEnd){while(offset>loopEnd){offset-=loopDuration}}this._source.start(startTime,offset)}else{this._source.start(startTime,offset,duration)}}else{throw Error("Tone.Player: tried to start Player before the buffer was loaded")}return this};Tone.Player.prototype._stop=function(time){if(this._source){this._source.stop(this.toSeconds(time));this._source=null}return this};Tone.Player.prototype.seek=function(offset,time){time=this.toSeconds(time);if(this._state.getValueAtTime(time)===Tone.State.Started){offset=this.toSeconds(offset);this._stop(time);this._start(time,offset)}return this};Tone.Player.prototype.setLoopPoints=function(loopStart,loopEnd){this.loopStart=loopStart;this.loopEnd=loopEnd;return this};Object.defineProperty(Tone.Player.prototype,"loopStart",{get:function(){return this._loopStart},set:function(loopStart){this._loopStart=loopStart;if(this._source){this._source.loopStart=this.toSeconds(loopStart)}}});Object.defineProperty(Tone.Player.prototype,"loopEnd",{get:function(){return this._loopEnd},set:function(loopEnd){this._loopEnd=loopEnd;if(this._source){this._source.loopEnd=this.toSeconds(loopEnd)}}});Object.defineProperty(Tone.Player.prototype,"buffer",{get:function(){return this._buffer},set:function(buffer){this._buffer.set(buffer)}});Object.defineProperty(Tone.Player.prototype,"loop",{get:function(){return this._loop},set:function(loop){this._loop=loop;if(this._source){this._source.loop=loop}}});Object.defineProperty(Tone.Player.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(rate){this._playbackRate=rate;if(this._source){this._source.playbackRate.value=rate}}});Object.defineProperty(Tone.Player.prototype,"reverse",{get:function(){return this._buffer.reverse},set:function(rev){this._buffer.reverse=rev}});Tone.Player.prototype.dispose=function(){Tone.Source.prototype.dispose.call(this);if(this._source!==null){this._source.disconnect();this._source=null}this._buffer.dispose();this._buffer=null;return this};return Tone.Player});Module(function(Tone){Tone.Sampler=function(){var options=this.optionsObject(arguments,["url","onload"],Tone.Sampler.defaults);Tone.Instrument.call(this,options);this.player=new Tone.Player(options.url,options.onload);this.player.retrigger=true;this.envelope=new Tone.AmplitudeEnvelope(options.envelope);this.player.chain(this.envelope,this.output);this._readOnly(["player","envelope"]);this.loop=options.loop;this.reverse=options.reverse};Tone.extend(Tone.Sampler,Tone.Instrument);Tone.Sampler.defaults={onload:Tone.noOp,loop:false,reverse:false,envelope:{attack:.001,decay:0,sustain:1,release:.1}};Tone.Sampler.prototype.triggerAttack=function(pitch,time,velocity){time=this.toSeconds(time);pitch=this.defaultArg(pitch,0);this.player.playbackRate=this.intervalToFrequencyRatio(pitch);this.player.start(time);this.envelope.triggerAttack(time,velocity);return this};Tone.Sampler.prototype.triggerRelease=function(time){time=this.toSeconds(time);this.envelope.triggerRelease(time);this.player.stop(this.toSeconds(this.envelope.release)+time);return this};Object.defineProperty(Tone.Sampler.prototype,"loop",{get:function(){return this.player.loop},set:function(loop){this.player.loop=loop}});Object.defineProperty(Tone.Sampler.prototype,"reverse",{get:function(){return this.player.reverse},set:function(rev){this.player.reverse=rev}});Object.defineProperty(Tone.Sampler.prototype,"buffer",{get:function(){return this.player.buffer},set:function(buff){this.player.buffer=buff}});Tone.Sampler.prototype.dispose=function(){Tone.Instrument.prototype.dispose.call(this);this._writable(["player","envelope"]);this.player.dispose();this.player=null;this.envelope.dispose();this.envelope=null;return this};return Tone.Sampler});Module(function(Tone){Tone.GainToAudio=function(){this._norm=this.input=this.output=new Tone.WaveShaper(function(x){return Math.abs(x)*2-1})};Tone.extend(Tone.GainToAudio,Tone.SignalBase);Tone.GainToAudio.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._norm.dispose();this._norm=null;return this};return Tone.GainToAudio});Module(function(Tone){Tone.Normalize=function(inputMin,inputMax){this._inputMin=this.defaultArg(inputMin,0);this._inputMax=this.defaultArg(inputMax,1);this._sub=this.input=new Tone.Add(0);this._div=this.output=new Tone.Multiply(1);this._sub.connect(this._div);this._setRange()};Tone.extend(Tone.Normalize,Tone.SignalBase);Object.defineProperty(Tone.Normalize.prototype,"min",{get:function(){return this._inputMin},set:function(min){this._inputMin=min;this._setRange()}});Object.defineProperty(Tone.Normalize.prototype,"max",{get:function(){return this._inputMax},set:function(max){this._inputMax=max;this._setRange()}});Tone.Normalize.prototype._setRange=function(){this._sub.value=-this._inputMin;this._div.value=1/(this._inputMax-this._inputMin)};Tone.Normalize.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._sub.dispose();this._sub=null;this._div.dispose();this._div=null;return this};return Tone.Normalize});Module(function(Tone){Tone.BufferSource=function(){var options=this.optionsObject(arguments,["buffer","onended"],Tone.BufferSource.defaults);this.onended=options.onended;this._startTime=-1;this._stopTime=-1;this._gainNode=this.output=new Tone.Gain;this._source=this.context.createBufferSource();this._source.connect(this._gainNode);this.playbackRate=new Tone.Param(this._source.playbackRate,Tone.Type.Positive);this.fadeIn=options.fadeIn;this.fadeOut=options.fadeOut;this._gain=1;this._onendedTimeout=-1;if(!this.isUndef(options.buffer)){this.buffer=options.buffer}this.loop=options.loop};Tone.extend(Tone.BufferSource);Tone.BufferSource.defaults={onended:Tone.noOp,fadeIn:0,fadeOut:0};Object.defineProperty(Tone.BufferSource.prototype,"state",{get:function(){var now=this.now();if(this._startTime!==-1&&now>=this._startTime&&now<this._stopTime){return Tone.State.Started}else{return Tone.State.Stopped}}});Tone.BufferSource.prototype.start=function(time,offset,duration,gain,fadeInTime){if(this._startTime!==-1){throw new Error("Tone.BufferSource: can only be started once.")}if(this.buffer){time=this.toSeconds(time);if(this.loop){offset=this.defaultArg(offset,this.loopStart)}else{offset=this.defaultArg(offset,0)}offset=this.toSeconds(offset);time=this.toSeconds(time);this._source.start(time,offset);gain=this.defaultArg(gain,1);this._gain=gain;if(this.isUndef(fadeInTime)){fadeInTime=this.toSeconds(this.fadeIn)}else{fadeInTime=this.toSeconds(fadeInTime)}if(fadeInTime>0){this._gainNode.gain.setValueAtTime(0,time);this._gainNode.gain.linearRampToValueAtTime(this._gain,time+fadeInTime)}else{this._gainNode.gain.setValueAtTime(gain,time)}this._startTime=time+fadeInTime;if(!this.isUndef(duration)){duration=this.defaultArg(duration,this.buffer.duration-offset);duration=this.toSeconds(duration);this.stop(time+duration+fadeInTime,fadeInTime)}}return this};Tone.BufferSource.prototype.stop=function(time,fadeOutTime){if(this.buffer){time=this.toSeconds(time);if(this.isUndef(fadeOutTime)){fadeOutTime=this.toSeconds(this.fadeOut)}else{fadeOutTime=this.toSeconds(fadeOutTime)}this._stopTime=time+fadeOutTime;this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime);if(fadeOutTime>0){this._gainNode.gain.setValueAtTime(this._gain,time);this._gainNode.gain.linearRampToValueAtTime(0,time+fadeOutTime);time+=fadeOutTime}else{this._gainNode.gain.setValueAtTime(0,time)}if(!this.isNumber(this._source.playbackState)||this._source.playbackState===2){this._source.stop(time)}clearTimeout(this._onendedTimeout);this._onendedTimeout=setTimeout(this._onended.bind(this),(this._stopTime-this.now())*1e3)}return this};Tone.BufferSource.prototype._onended=function(){this.onended(this);this.dispose()};Object.defineProperty(Tone.BufferSource.prototype,"loopStart",{get:function(){return this._source.loopStart},set:function(loopStart){this._source.loopStart=this.toSeconds(loopStart)}});Object.defineProperty(Tone.BufferSource.prototype,"loopEnd",{get:function(){return this._source.loopEnd},set:function(loopEnd){this._source.loopEnd=this.toSeconds(loopEnd)}});Object.defineProperty(Tone.BufferSource.prototype,"buffer",{get:function(){if(this._source){return this._source.buffer}else{return null}},set:function(buffer){if(buffer instanceof Tone.Buffer){this._source.buffer=buffer.get()}else{this._source.buffer=buffer}}});Object.defineProperty(Tone.BufferSource.prototype,"loop",{get:function(){return this._source.loop},set:function(loop){this._source.loop=loop}});Tone.BufferSource.prototype.dispose=function(){this.onended=null;if(this._source){this._source.disconnect();this._source=null}if(this._gainNode){this._gainNode.dispose();this._gainNode=null}this._startTime=-1;this.playbackRate=null;this.output=null;clearTimeout(this._onendedTimeout);return this};return Tone.BufferSource});Module(function(Tone){Tone.MultiPlayer=function(){var options=this.optionsObject(arguments,["urls","onload"],Tone.MultiPlayer.defaults);if(options.urls instanceof Tone.Buffers){this.buffers=options.urls}else{this.buffers=new Tone.Buffers(options.urls,options.onload)}this._activeSources={};this.fadeIn=options.fadeIn;this.fadeOut=options.fadeOut;this._volume=this.output=new Tone.Volume(options.volume);this.volume=this._volume.volume;this._readOnly("volume");this._volume.output.output.channelCount=2;this._volume.output.output.channelCountMode="explicit";this.mute=options.mute};Tone.extend(Tone.MultiPlayer,Tone.Source);Tone.MultiPlayer.defaults={onload:Tone.noOp,fadeIn:0,fadeOut:0};Tone.MultiPlayer.prototype._makeSource=function(bufferName){var buffer;if(this.isString(bufferName)||this.isNumber(bufferName)){buffer=this.buffers.get(bufferName).get()}else if(bufferName instanceof Tone.Buffer){buffer=bufferName.get()}else if(bufferName instanceof AudioBuffer){buffer=bufferName}var source=new Tone.BufferSource(buffer).connect(this.output);if(!this._activeSources.hasOwnProperty(bufferName)){this._activeSources[bufferName]=[]}this._activeSources[bufferName].push(source);return source};Tone.MultiPlayer.prototype.start=function(bufferName,time,offset,duration,pitch,gain){time=this.toSeconds(time);var source=this._makeSource(bufferName);source.start(time,offset,duration,this.defaultArg(gain,1),this.fadeIn);if(duration){source.stop(time+this.toSeconds(duration),this.fadeOut)}pitch=this.defaultArg(pitch,0);source.playbackRate.value=this.intervalToFrequencyRatio(pitch);return this};Tone.MultiPlayer.prototype.startLoop=function(bufferName,time,offset,loopStart,loopEnd,pitch,gain){time=this.toSeconds(time);var source=this._makeSource(bufferName);source.loop=true;source.loopStart=this.toSeconds(this.defaultArg(loopStart,0));source.loopEnd=this.toSeconds(this.defaultArg(loopEnd,0));source.start(time,offset,undefined,this.defaultArg(gain,1),this.fadeIn);pitch=this.defaultArg(pitch,0);source.playbackRate.value=this.intervalToFrequencyRatio(pitch);return this};Tone.MultiPlayer.prototype.stop=function(bufferName,time){if(this._activeSources[bufferName]&&this._activeSources[bufferName].length){time=this.toSeconds(time);this._activeSources[bufferName].shift().stop(time,this.fadeOut)}else{throw new Error("Tone.MultiPlayer: cannot stop a buffer that hasn't been started or is already stopped")}return this};Tone.MultiPlayer.prototype.stopAll=function(time){time=this.toSeconds(time);for(var bufferName in this._activeSources){var sources=this._activeSources[bufferName];for(var i=0;i<sources.length;i++){sources[i].stop(time)}}return this};Tone.MultiPlayer.prototype.add=function(name,url,callback){this.buffers.add(name,url,callback);return this};Object.defineProperty(Tone.MultiPlayer.prototype,"state",{get:function(){return this._activeSources.length>0?Tone.State.Started:Tone.State.Stopped}});Object.defineProperty(Tone.MultiPlayer.prototype,"mute",{get:function(){return this._volume.mute},set:function(mute){this._volume.mute=mute}});Tone.MultiPlayer.prototype.dispose=function(){
Tone.prototype.dispose.call(this);this._volume.dispose();this._volume=null;this._writable("volume");this.volume=null;for(var bufferName in this._activeSources){this._activeSources[bufferName].forEach(function(source){source.dispose()})}this.buffers.dispose();this.buffers=null;this._activeSources=null;return this};return Tone.MultiPlayer});Module(function(Tone){Tone.GrainPlayer=function(){var options=this.optionsObject(arguments,["url","onload"],Tone.GrainPlayer.defaults);Tone.Source.call(this);this.buffer=new Tone.Buffer(options.url,options.onload);this._player=this.output=new Tone.MultiPlayer;this._clock=new Tone.Clock(this._tick.bind(this),1);this._loopStart=0;this._loopEnd=0;this._playbackRate=options.playbackRate;this._grainSize=options.grainSize;this._overlap=options.overlap;this.detune=options.detune;this.drift=options.drift;this.overlap=options.overlap;this.loop=options.loop;this.playbackRate=options.playbackRate;this.grainSize=options.grainSize;this.loopStart=options.loopStart;this.loopEnd=options.loopEnd;this.reverse=options.reverse};Tone.extend(Tone.GrainPlayer,Tone.Source);Tone.GrainPlayer.defaults={onload:Tone.noOp,overlap:.1,grainSize:.2,drift:0,playbackRate:1,detune:0,loop:false,loopStart:0,loopEnd:0,reverse:false};Tone.GrainPlayer.prototype._start=function(time,offset){offset=this.defaultArg(offset,0);offset=this.toSeconds(offset);time=this.toSeconds(time);this._offset=offset;this._clock.start(time)};Tone.GrainPlayer.prototype._stop=function(time){this._clock.stop(time);this._player.stop(this.buffer,time);this._offset=0};Tone.GrainPlayer.prototype._tick=function(time){var bufferDuration=this.buffer.duration;if(this.loop&&this._loopEnd>0){bufferDuration=this._loopEnd}var drift=(Math.random()*2-1)*this.drift;var offset=this._offset-this._overlap+drift;var detune=this.detune/100;var originalFadeIn=this._player.fadeIn;if(this.loop&&this._offset>bufferDuration){var endSegmentDuration=this._offset-bufferDuration;this._player.start(this.buffer,time,offset,endSegmentDuration+this._overlap,detune);offset=this._offset%bufferDuration;this._offset=this._loopStart;this._player.fadeIn=0;this._player.start(this.buffer,time+endSegmentDuration,this._offset,offset+this._overlap,detune)}else if(this._offset>bufferDuration){this.stop(time)}else{if(offset<0){this._player.fadeIn=Math.max(this._player.fadeIn+offset,0);offset=0}this._player.start(this.buffer,time,offset,this.grainSize+this._overlap,detune)}this._player.fadeIn=originalFadeIn;var duration=this._clock._nextTick-time;this._offset+=duration*this._playbackRate};Tone.GrainPlayer.prototype.scrub=function(offset,time){this._offset=this.toSeconds(offset);this._tick(this.toSeconds(time));return this};Object.defineProperty(Tone.GrainPlayer.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(rate){this._playbackRate=rate;this.grainSize=this._grainSize}});Object.defineProperty(Tone.GrainPlayer.prototype,"loopStart",{get:function(){return this._loopStart},set:function(time){this._loopStart=this.toSeconds(time)}});Object.defineProperty(Tone.GrainPlayer.prototype,"loopEnd",{get:function(){return this._loopEnd},set:function(time){this._loopEnd=this.toSeconds(time)}});Object.defineProperty(Tone.GrainPlayer.prototype,"reverse",{get:function(){return this.buffer.reverse},set:function(rev){this.buffer.reverse=rev}});Object.defineProperty(Tone.GrainPlayer.prototype,"grainSize",{get:function(){return this._grainSize},set:function(size){this._grainSize=this.toSeconds(size);this._clock.frequency.value=this._playbackRate/this._grainSize}});Object.defineProperty(Tone.GrainPlayer.prototype,"overlap",{get:function(){return this._overlap},set:function(time){time=this.toSeconds(time);this._overlap=time;if(this._overlap<0){this._player.fadeIn=.01;this._player.fadeOut=.01}else{this._player.fadeIn=time;this._player.fadeOut=time}}});Tone.GrainPlayer.prototype.dispose=function(){Tone.Source.prototype.dispose.call(this);this.buffer.dispose();this.buffer=null;this._player.dispose();this._player=null;this._clock.dispose();this._clock=null;return this};return Tone.GrainPlayer});Module(function(Tone){Tone.UserMedia=function(){var options=this.optionsObject(arguments,["volume"],Tone.UserMedia.defaults);this._mediaStream=null;this._stream=null;this._device=null;this._volume=this.output=new Tone.Volume(options.volume);this.volume=this._volume.volume;this._readOnly("volume");this.mute=options.mute};Tone.extend(Tone.UserMedia);Tone.UserMedia.defaults={volume:0,mute:false};Tone.UserMedia.prototype.open=function(labelOrId){labelOrId=this.defaultArg(labelOrId,"default");return this.enumerateDevices().then(function(devices){var device;if(this.isNumber(labelOrId)){device=devices[labelOrId]}else{device=devices.find(function(device){return device.label===labelOrId||device.deviceId===labelOrId});if(!device){device=devices[0]}}if(!device){throw new Error("Tone.UserMedia: no matching audio inputs.")}this._device=device;var constraints={audio:{deviceId:device.deviceId,echoCancellation:false,sampleRate:this.context.sampleRate}};return navigator.mediaDevices.getUserMedia(constraints).then(function(stream){if(!this._stream){this._stream=stream;this._mediaStream=this.context.createMediaStreamSource(stream);this._mediaStream.connect(this.output)}return this}.bind(this))}.bind(this))};Tone.UserMedia.prototype.close=function(){if(this._stream){this._stream.getAudioTracks().forEach(function(track){track.stop()});this._stream=null;this._mediaStream.disconnect();this._mediaStream=null}this._device=null;return this};Tone.UserMedia.prototype.enumerateDevices=function(){return navigator.mediaDevices.enumerateDevices().then(function(devices){return devices.filter(function(device){return device.kind==="audioinput"})})};Object.defineProperty(Tone.UserMedia.prototype,"state",{get:function(){return this._stream&&this._stream.active?Tone.State.Started:Tone.State.Stopped}});Object.defineProperty(Tone.UserMedia.prototype,"deviceId",{get:function(){if(this._device){return this._device.deviceId}}});Object.defineProperty(Tone.UserMedia.prototype,"groupId",{get:function(){if(this._device){return this._device.groupId}}});Object.defineProperty(Tone.UserMedia.prototype,"label",{get:function(){if(this._device){return this._device.label}}});Object.defineProperty(Tone.UserMedia.prototype,"mute",{get:function(){return this._volume.mute},set:function(mute){this._volume.mute=mute}});Tone.UserMedia.prototype.dispose=function(){Tone.prototype.dispose.call(this);this.close();this._writable("volume");this._volume.dispose();this._volume=null;this.volume=null;return this};Object.defineProperty(Tone.UserMedia,"supported",{get:function(){return!Tone.prototype.isUndef(navigator.mediaDevices)&&Tone.prototype.isFunction(navigator.mediaDevices.getUserMedia)}});return Tone.UserMedia});return Tone})},{}],2:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.convertTuneToNotes=exports.cleanTuneData=undefined;var _maps=require("./maps");var cleanTuneData=exports.cleanTuneData=function cleanTuneData(data){return data.trim().replace(/( *|\t*)(NOTE\(\w+, \d\))(, *)\n?/g,"$2\n").replace(/\nEND_MARKER/g,"").split("\n")};var convertTuneToNotes=exports.convertTuneToNotes=function convertTuneToNotes(tune){var segments=/NOTE\(T_(\w+), (\d)\)/g.exec(tune);return{note:_maps.toneMap[segments[1]],duration:Number(_maps.durationMap[segments[2]])/50}}},{"./maps":6}],3:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var playTune=exports.playTune=document.getElementById("play-tune");var clear=exports.clear=document.getElementById("clear");var loadTune=exports.loadTune=document.getElementById("load-tune");var tuneList=exports.tuneList=document.getElementById("tune-list");var tuneData=exports.tuneData=document.getElementById("tune-data");var convertedData=exports.convertedData=document.getElementById("converted-data")},{}],4:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var createOption=exports.createOption=function createOption(value,text){var option=document.createElement("option");option.value=value;option.text=text;return option}},{}],5:[function(require,module,exports){"use strict";var _tone=require("tone");var _tone2=_interopRequireDefault(_tone);var _domHelper=require("./dom-helper");var _domElements=require("./dom-elements");var _convertTune=require("./convert-tune");var _playQueue=require("./play-queue");var _tunes=require("./tunes");var tunes=_interopRequireWildcard(_tunes);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var synth=(new _tone2.default.MonoSynth).toMaster();var playTuneClick=function playTuneClick(){_domElements.playTune.setAttribute("disabled","disabled");var notes=(0,_convertTune.cleanTuneData)(_domElements.tuneData.value).map(_convertTune.convertTuneToNotes);var _queueNotesForPlay=(0,_playQueue.queueNotesForPlay)(synth,notes),totalDuration=_queueNotesForPlay.totalDuration,log=_queueNotesForPlay.log;_domElements.convertedData.value=log;(0,_playQueue.playQueuedNotes)(totalDuration).then(function(){return _domElements.playTune.removeAttribute("disabled")})};var clearClick=function clearClick(){_domElements.tuneData.value="";_domElements.convertedData.value=""};var loadTuneClick=function loadTuneClick(){_domElements.tuneData.value=tunes[_domElements.tuneList.options[_domElements.tuneList.selectedIndex].value]};_domElements.playTune.addEventListener("click",playTuneClick,false);_domElements.clear.addEventListener("click",clearClick,false);_domElements.loadTune.addEventListener("click",loadTuneClick,false);Object.keys(tunes).forEach(function(tune){var option=(0,_domHelper.createOption)(tune,tune);_domElements.tuneList.add(option)})},{"./convert-tune":2,"./dom-elements":3,"./dom-helper":4,"./play-queue":7,"./tunes":8,tone:1}],6:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var toneMap=exports.toneMap={C:130.81,CS:138.59,D:146.83,EB:155.56,E:164.81,F:174.61,FS:185,G:196,AB:207.65,A:220,BB:233.08,B:246.94,CX:261.63,CSX:277.18,DX:293.66,EBX:311.13,EX:329.63,FX:349.23,FSX:369.99,GX:392,ABX:415.3,AX:440,BBX:466.16,BX:493.88,REST:0};var durationMap=exports.durationMap={0:2,1:4,2:6,3:8,4:12,5:16,6:18,7:24}},{}],7:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.queueNotesForPlay=exports.playQueuedNotes=undefined;var _tone=require("tone");var _tone2=_interopRequireDefault(_tone);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var playNote=function playNote(instrument,note,duration,delay){_tone2.default.Transport.schedule(function(time){return instrument.triggerAttackRelease(note,duration,time+delay)},0)};var playQueuedNotes=exports.playQueuedNotes=function playQueuedNotes(totalDuration){return new Promise(function(r){_tone2.default.Transport.start("+0.1");setTimeout(function(){_tone2.default.Transport.stop();r()},totalDuration*1e3)})};var queueNotesForPlay=exports.queueNotesForPlay=function queueNotesForPlay(instrument,notes){var totalDuration=0;var log="";notes.forEach(function(note){playNote(instrument,note.note,note.duration,totalDuration);totalDuration+=note.duration;log+="playNote("+note.note+", "+note.duration+", "+totalDuration+")\n"});log+="total duration: "+totalDuration;return{totalDuration:totalDuration,log:log}}},{tone:1}],8:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var mario=exports.mario="\n    NOTE(T_EX, 2),  NOTE(T_EX, 4),  NOTE(T_EX, 4),  NOTE(T_CX, 2),  NOTE(T_EX, 4),  NOTE(T_GX, 7),\n    NOTE(T_G, 7),   NOTE(T_CX, 6),  NOTE(T_G, 6),   NOTE(T_E, 6),   NOTE(T_A, 4),   NOTE(T_B, 4),\n    NOTE(T_BB, 2),  NOTE(T_A, 4),   NOTE(T_G, 3),   NOTE(T_EX, 3),  NOTE(T_GX, 3),  NOTE(T_AX, 4),\n    NOTE(T_FX, 2),  NOTE(T_GX, 4),  NOTE(T_EX, 4),  NOTE(T_CX, 2),  NOTE(T_DX, 2),  NOTE(T_B, 2),\n    NOTE(T_CX, 4),  END_MARKER\n";var felix=exports.felix="\n    NOTE(T_EBX, 3), NOTE(T_REST, 2), NOTE(T_AB, 3), NOTE(T_FX, 2), NOTE(T_EBX, 3),\n    NOTE(T_REST, 7), NOTE(T_EBX, 2), NOTE(T_CSX, 2), NOTE(T_EBX, 2), NOTE(T_CSX, 2),\n    NOTE(T_BB, 2), NOTE(T_G, 2), NOTE(T_EB, 2), NOTE(T_CX, 3), NOTE(T_REST, 7),\n    NOTE(T_CX, 2), NOTE(T_BB, 3), NOTE(T_EB, 8), NOTE(T_EB, 8), NOTE(T_EB, 8),\n    NOTE(T_CX, 3), NOTE(T_AB, 2), NOTE(T_AB, 2), NOTE(T_AB, 2), NOTE(T_AB, 2),\n    NOTE(T_BB, 3), NOTE(T_BB, 2), NOTE(T_BB, 2), NOTE(T_CX, 2), NOTE(T_DX, 2),\n    NOTE(T_FX, 3), NOTE(T_EBX, 2), NOTE(T_EBX, 3), END_MARKER\n";var heman=exports.heman="\n    NOTE(T_AB, 3), NOTE(T_AB, 3), NOTE(T_AB, 3), NOTE(T_AB, 5), NOTE(T_F, 5),\n    NOTE(T_AB, 3), NOTE(T_BB, 3), NOTE(T_AB, 3), NOTE(T_FS, 3), NOTE(T_AB, 5),\n    NOTE(T_CS, 5), NOTE(T_AB, 3), NOTE(T_BB, 3), NOTE(T_AB, 3), NOTE(T_FS, 3),\n    NOTE(T_AB, 5), NOTE(T_F, 5), NOTE(T_CS, 3), NOTE(T_EB, 7), END_MARKER\n";var kirby=exports.kirby="\n    NOTE(T_AB, 2), NOTE(T_BB, 2), NOTE(T_CX, 2), NOTE(T_DX, 2), NOTE(T_CX, 2),\n    NOTE(T_DX, 2), NOTE(T_EBX, 4), NOTE(T_BB, 2), NOTE(T_G, 4), NOTE(T_BB, 2),\n    NOTE(T_AB, 4), NOTE(T_G, 2), NOTE(T_F, 4), NOTE(T_G, 2), NOTE(T_EB, 4),\n    NOTE(T_F, 0), NOTE(T_G, 0), NOTE(T_AB, 0), NOTE(T_BB, 0), NOTE(T_CX, 0),\n    NOTE(T_DX, 0), NOTE(T_EBX, 4), END_MARKER\n";var morning=exports.morning="\n    NOTE(T_G, 3), NOTE(T_E, 3), NOTE(T_D, 3), NOTE(T_C, 3), NOTE(T_D, 3),\n    NOTE(T_E, 3), NOTE(T_G, 3), NOTE(T_E, 3), NOTE(T_D, 3), NOTE(T_C, 3),\n    NOTE(T_D, 1), NOTE(T_E, 1), NOTE(T_D, 1), NOTE(T_E, 1), NOTE(T_G, 3),\n    NOTE(T_E, 3), NOTE(T_G, 3), NOTE(T_A, 3), NOTE(T_E, 3), NOTE(T_A, 3),\n    NOTE(T_G, 3), NOTE(T_E, 3), NOTE(T_D, 3), NOTE(T_C, 5), END_MARKER\n";var pony=exports.pony="\n    NOTE(T_FSX, 3), NOTE(T_AX, 3), NOTE(T_FSX, 3), NOTE(T_EX, 5), NOTE(T_AX, 5),\n    NOTE(T_DX, 3), NOTE(T_EX, 3), NOTE(T_EX, 3), NOTE(T_CSX, 5), NOTE(T_A, 5),\n    NOTE(T_B, 5), NOTE(T_DX, 3), NOTE(T_DX, 3), NOTE(T_GX, 5), NOTE(T_BX, 5),\n    NOTE(T_AX, 3), NOTE(T_BX, 5), NOTE(T_AX, 7), END_MARKER\n";var simpsons=exports.simpsons="\n    NOTE(T_CX, 7), NOTE(T_EX, 5), NOTE(T_FSX, 5), NOTE(T_AX, 3), NOTE(T_GX, 7),\n    NOTE(T_EX, 5), NOTE(T_CX, 5), NOTE(T_A, 3), NOTE(T_FS, 3), NOTE(T_FS, 3),\n    NOTE(T_FS, 3), NOTE(T_G, 7), NOTE(T_G, 5), NOTE(T_REST, 3), NOTE(T_FS, 3),\n    NOTE(T_FS, 3), NOTE(T_FS, 3), NOTE(T_G, 3), NOTE(T_BB, 7), NOTE(T_REST, 0),\n    NOTE(T_B, 3), END_MARKER\n";var smurfs=exports.smurfs="\n    NOTE(T_CX, 7), NOTE(T_FX, 5), NOTE(T_CX, 3), NOTE(T_DX, 5), NOTE(T_BB, 5),\n    NOTE(T_G, 7), NOTE(T_CX, 7), NOTE(T_A, 3), NOTE(T_F, 5), NOTE(T_A, 5),\n    NOTE(T_G, 7), NOTE(T_REST, 5), NOTE(T_G, 1), NOTE(T_A, 1), NOTE(T_BB, 1),\n    NOTE(T_B, 1), NOTE(T_CX, 7), NOTE(T_FX, 5), NOTE(T_CX, 3), NOTE(T_DX, 5),\n    NOTE(T_BB, 5), NOTE(T_G, 7), NOTE(T_C, 7), NOTE(T_A, 3), NOTE(T_BB, 5),\n    NOTE(T_E, 5), NOTE(T_F, 7), END_MARKER\n";var littleReindeer=exports.littleReindeer="\n    NOTE(T_G, 4), NOTE(T_A, 1), NOTE(T_G, 3), NOTE(T_E, 5), NOTE(T_G, 4),\n    NOTE(T_A, 1), NOTE(T_G, 3), NOTE(T_E, 5), NOTE(T_CSX, 4), NOTE(T_CSX, 1),\n    NOTE(T_A, 5), NOTE(T_B, 4), NOTE(T_B, 1), NOTE(T_G, 5), NOTE(T_A, 4),\n    NOTE(T_G, 1), NOTE(T_A, 3), NOTE(T_CSX, 3), NOTE(T_B, 3), NOTE(T_A, 3),\n    NOTE(T_G, 4), NOTE(T_A, 1), NOTE(T_G, 3), NOTE(T_E, 5), END_MARKER\n";var ducktales=exports.ducktales="\n    NOTE(T_FS, 3), NOTE(T_BB, 3), NOTE(T_CSX, 3), NOTE(T_EBX, 3), NOTE(T_EX, 3),\n    NOTE(T_EX, 1), NOTE(T_EBX, 1), NOTE(T_REST, 1), NOTE(T_CSX, 1), NOTE(T_B, 3),\n    NOTE(T_B, 5), NOTE(T_BB, 4), NOTE(T_REST, 5), NOTE(T_B, 5), NOTE(T_BB, 4),\n    NOTE(T_REST, 5), NOTE(T_FS, 3), NOTE(T_BB, 3), NOTE(T_CSX, 3), NOTE(T_EBX, 3),\n    NOTE(T_EX, 3), NOTE(T_EX, 1), NOTE(T_EBX, 1), NOTE(T_REST, 1), NOTE(T_CSX, 1),\n    NOTE(T_B, 3), NOTE(T_EX, 5), NOTE(T_EBX, 4), NOTE(T_REST, 5), NOTE(T_EX, 5),\n    NOTE(T_EBX, 4), NOTE(T_REST, 5), END_MARKER\n";var complete=exports.complete="\n    NOTE(T_CSX, 3), NOTE(T_REST, 4), NOTE(T_CSX, 3), NOTE(T_DX, 4), NOTE(T_B, 6),\n    NOTE(T_CSX, 3), NOTE(T_CSX, 3), NOTE(T_CSX, 3), NOTE(T_A, 3), NOTE(T_G, 4),\n    NOTE(T_B, 6), NOTE(T_REST, 3), NOTE(T_CSX, 3), NOTE(T_REST, 4), NOTE(T_CSX, 3),\n    NOTE(T_DX, 4), NOTE(T_B, 6), NOTE(T_CSX, 3), NOTE(T_CSX, 3), NOTE(T_CSX, 3),\n    NOTE(T_A, 3), NOTE(T_G, 4), NOTE(T_B, 5), NOTE(T_REST, 6), NOTE(T_A, 0),\n    NOTE(T_B, 0), NOTE(T_CSX, 0), NOTE(T_DX, 0), NOTE(T_EX, 0), NOTE(T_FSX, 0),\n    NOTE(T_B, 0), NOTE(T_CSX, 0), NOTE(T_EBX, 0), NOTE(T_EX, 0), NOTE(T_FSX, 0),\n    NOTE(T_ABX, 0), NOTE(T_EB, 0), NOTE(T_E, 0), NOTE(T_FS, 0), NOTE(T_AB, 0),\n    NOTE(T_A, 0), NOTE(T_B, 0), NOTE(T_F, 0), NOTE(T_FS, 0), NOTE(T_G, 0),\n    NOTE(T_BB, 0), NOTE(T_CX, 0), NOTE(T_CSX, 0), END_MARKER\n"},{}]},{},[5]);
